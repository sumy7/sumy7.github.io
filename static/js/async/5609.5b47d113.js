/*! For license information please see 5609.5b47d113.js.LICENSE.txt */
(self.webpackChunk_sumyblog_rspress_blog=self.webpackChunk_sumyblog_rspress_blog||[]).push([["5609"],{751:function(e,n,r){"use strict";r.r(n);var s=r("35250"),t=r("51325");function a(e){let n=Object.assign({h1:"h1",a:"a",h2:"h2",p:"p",code:"code",strong:"strong",pre:"pre",h3:"h3",ul:"ul",li:"li"},(0,t.useMDXComponents)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h1,{id:"\u5982\u4F55\u5728java\u4E2D\u6B63\u786E\u7684\u7EC8\u6B62\u4E00\u4E2A\u7EBF\u7A0B",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u5982\u4F55\u5728java\u4E2D\u6B63\u786E\u7684\u7EC8\u6B62\u4E00\u4E2A\u7EBF\u7A0B",children:"#"}),"\u5982\u4F55\u5728Java\u4E2D\u6B63\u786E\u7684\u7EC8\u6B62\u4E00\u4E2A\u7EBF\u7A0B"]}),"\n",(0,s.jsxs)(n.h2,{id:"\u542B\u6709\u6B7B\u5FAA\u73AF\u7684\u7EBF\u7A0B\u662F\u65E0\u6CD5\u77E5\u9053\u81EA\u5DF1\u8BE5\u4EC0\u4E48\u65F6\u5019\u7ED3\u675F\u7684",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u542B\u6709\u6B7B\u5FAA\u73AF\u7684\u7EBF\u7A0B\u662F\u65E0\u6CD5\u77E5\u9053\u81EA\u5DF1\u8BE5\u4EC0\u4E48\u65F6\u5019\u7ED3\u675F\u7684",children:"#"}),"\u542B\u6709\u6B7B\u5FAA\u73AF\u7684\u7EBF\u7A0B\u662F\u65E0\u6CD5\u77E5\u9053\u81EA\u5DF1\u8BE5\u4EC0\u4E48\u65F6\u5019\u7ED3\u675F\u7684"]}),"\n",(0,s.jsxs)(n.p,{children:["\u4E00\u4E2A\u5DE5\u4F5C\u7EBF\u7A0B\u9700\u8981\u4E0D\u65AD\u63A5\u53D7\u5916\u90E8\u7684\u6D88\u606F\uFF0C\u8FD9\u6837\u7684\u7EBF\u7A0B\u5185\u90E8\u901A\u5E38\u6709\u4E00\u4E2A\u6B7B\u5FAA\u73AF ",(0,s.jsx)(n.code,{children:"while(true){}"})," \u3002\u56E0\u4E3A\u6B7B\u5FAA\u73AF\u7684\u5B58\u5728\uFF0C\u8BE5\u7EBF\u7A0B\u81EA\u5DF1\u65E0\u6CD5\u77E5\u9053\u4F55\u65F6\u624D\u80FD\u505C\u6B62\u5FAA\u73AF\uFF0C\u53EA\u80FD\u901A\u8FC7\u5916\u90E8\u7EBF\u7A0B\u901A\u77E5\u8BE5\u7EBF\u7A0B\u7684\u7ED3\u675F\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u8981\u7ED3\u675F\u4E00\u4E2A\u7EBF\u7A0B\uFF0CThread\u91CC\u6709\u4E00\u4E2A ",(0,s.jsx)(n.code,{children:"stop()"})," \u65B9\u6CD5\u53EF\u4EE5\u7C97\u66B4\u7684\u6740\u6B7B\u4E00\u4E2A\u7EBF\u7A0B\u3002\u8FD9\u6837\u505A\u4F1A\u51FA\u73B0\u4E00\u4E9B\u95EE\u9898\uFF0C\u88AB\u7ED3\u675F\u7684\u7EBF\u7A0B\u4F1A\u88AB\u7ACB\u5373\u505C\u6B62\uFF0C\u6CA1\u6709\u65F6\u95F4\u5904\u7406\u4E00\u4E9B\u5584\u540E\u5DE5\u4F5C\u3002\u5728\u591A\u7EBF\u7A0B\u73AF\u5883\u4E0B\uFF0C\u5C31\u53EF\u80FD\u4F1A\u51FA\u73B0\u6570\u636E\u4E0D\u4E00\u81F4\u7684\u95EE\u9898\uFF0C\u8FD9\u662F\u975E\u5E38\u5371\u9669\u7684\u3002\u56E0\u6B64\uFF0C",(0,s.jsx)(n.code,{children:"stop()"})," \u65B9\u6CD5\u88AB\u7F6E\u4E3A_\u5F03\u7528_\u65B9\u6CD5\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u90A3\u4E48\u5982\u4F55\u624D\u80FD\u66F4\u597D\u7684\u7ED3\u675F\u4E00\u4E2A\u7EBF\u7A0B\uFF1F"}),"\n",(0,s.jsxs)(n.h2,{id:"\u8FD9\u91CC\u6709\u4E24\u79CD\u65B9\u6CD5\u53EF\u4EE5\u8BA9\u5916\u90E8\u7EBF\u7A0B\u7ED3\u675F\u4E00\u4E2A\u7EBF\u7A0B",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u8FD9\u91CC\u6709\u4E24\u79CD\u65B9\u6CD5\u53EF\u4EE5\u8BA9\u5916\u90E8\u7EBF\u7A0B\u7ED3\u675F\u4E00\u4E2A\u7EBF\u7A0B",children:"#"}),"\u8FD9\u91CC\u6709\u4E24\u79CD\u65B9\u6CD5\u53EF\u4EE5\u8BA9\u5916\u90E8\u7EBF\u7A0B\u7ED3\u675F\u4E00\u4E2A\u7EBF\u7A0B"]}),"\n",(0,s.jsxs)(n.p,{children:["\u6211\u4EEC\u9700\u8981\u7ED9\u7EBF\u7A0B\u5904\u7406\u5584\u540E\u5DE5\u4F5C\u7684\u673A\u4F1A\uFF0C\u4E00\u822C\u6765\u8BF4\u5C31\u662F\u7ED9\u7EBF\u7A0B\u4E00\u4E2A\u4FE1\u53F7\uFF0C\u5E0C\u671B\u7EBF\u7A0B\u80FD\u5C3D\u5FEB\u5B8C\u5584\u5DE5\u4F5C\uFF0C\u7136\u540E",(0,s.jsx)(n.strong,{children:"\u8DF3\u51FA"}),"\u6B7B\u5FAA\u73AF\u3002"]}),"\n",(0,s.jsxs)(n.h2,{id:"\u8BBE\u7F6E\u6807\u8BB0\u53D8\u91CF",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u8BBE\u7F6E\u6807\u8BB0\u53D8\u91CF",children:"#"}),"\u8BBE\u7F6E\u6807\u8BB0\u53D8\u91CF"]}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u7EBF\u7A0B\u5DE5\u4F5C\u4E4B\u4F59\uFF0C\u68C0\u67E5\u6807\u8BB0\u53D8\u91CF\uFF0C\u5982\u679C\u6807\u8BB0\u53D8\u91CF\u88AB\u6539\u53D8\uFF0C\u5219\u81EA\u884C\u4E2D\u65AD\u9000\u51FA\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",meta:"",children:"public class Thread1 extends Thread {\n    private volatile boolean isStop = false;\n\n    public void stopMe() {\n        isStop = true;\n    }\n\n    @Override\n    public void run() {\n        while(!isStop){\n            // \u5904\u7406\u903B\u8F91\n        }\n    }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8FD9\u91CC\u589E\u52A0\u4E00\u4E2A",(0,s.jsx)(n.code,{children:"volatile"}),"\u6807\u6CE8\u7684\u53D8\u91CFisStop\u6765\u8BB0\u5F55\u662F\u5426\u9700\u8981\u7ED3\u675F\u7EBF\u7A0B\uFF0C",(0,s.jsx)(n.code,{children:"run()"}),"\u4E2D\u7684\u6B7B\u5FAA\u73AF\u4E5F\u7531isStop\u53D8\u91CF\u64CD\u63A7\u3002\u901A\u8FC7\u8C03\u7528stopMe()\u65B9\u6CD5\u6539\u53D8\u53D8\u91CF\u7684\u503C\uFF0C\u4F7F\u6B7B\u5FAA\u73AF\u53EF\u4EE5\u81EA\u884C\u9000\u51FA\u3002"]}),"\n",(0,s.jsxs)(n.h3,{id:"\u6355\u83B7\u7EBF\u7A0B\u4E2D\u65AD",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u6355\u83B7\u7EBF\u7A0B\u4E2D\u65AD",children:"#"}),"\u6355\u83B7\u7EBF\u7A0B\u4E2D\u65AD"]}),"\n",(0,s.jsx)(n.p,{children:"\u5173\u4E8E\u7EBF\u7A0B\u4E2D\u65AD\u6709Thread\u4E2D\u6709\u51E0\u4E2A\u65B9\u6CD5\uFF1A"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",meta:"",children:"public void Thread.interrupt() // \u4E2D\u65AD\u4E00\u4E2A\u7EBF\u7A0B\npublic boolean Thread.isInterrupted() // \u5224\u65AD\u7EBF\u7A0B\u662F\u5426\u4E2D\u65AD\npublic static boolean Thread.interrupted() // \u5224\u65AD\u662F\u5426\u4E2D\u65AD\uFF0C\u5E76\u6E05\u9664\u4E2D\u65AD\u4F4D\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u901A\u8FC7",(0,s.jsx)(n.code,{children:"Thread.interrupt()"}),"\u65B9\u6CD5\u53EF\u4EE5\u8BBE\u7F6E\u4E00\u4E2A\u7EBF\u7A0B\u7684\u4E2D\u65AD\u4F4D\uFF0C\u7EBF\u7A0B\u901A\u8FC7\u68C0\u67E5\u4E2D\u65AD\u4F4D\u6765\u81EA\u884C\u8FDB\u884C\u4E2D\u65AD\u64CD\u4F5C\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",meta:"",children:"public class Thread2 extends Thread {\n\n    @Override\n    public void run() {\n        while(!Thread.currentThread().isInterrupted()) {\n            // \u5904\u7406\u903B\u8F91\n            try {\n                Thread.sleep(1000);\n            } catch (InterruptedException e) {\n                Thread.currentThread().interrupt(); // \u8BBE\u7F6E\u4E2D\u65AD\u72B6\u6001\n            }\n        }\n    }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u9700\u8981\u6CE8\u610F\u7684\u662F\u4E00\u4E9B\u963B\u585E\u65B9\u6CD5\u50CF",(0,s.jsx)(n.code,{children:"sleep()"}),"\u7B49\u4F1A\u6E05\u9664\u4E2D\u65AD\u6807\u5FD7\uFF0C\u6240\u4EE5\u5728catch\u7684\u65F6\u5019\u9700\u8981\u91CD\u65B0\u8BBE\u7F6E\u4E00\u4E0B\u4E2D\u65AD\u6807\u5FD7\u3002"]}),"\n",(0,s.jsxs)(n.h2,{id:"\u592A\u5FD9\u7684\u7EBF\u7A0B\u65E0\u6CD5\u53CA\u65F6\u542C\u5230\u64A4\u9000\u7684\u53F7\u89D2",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u592A\u5FD9\u7684\u7EBF\u7A0B\u65E0\u6CD5\u53CA\u65F6\u542C\u5230\u64A4\u9000\u7684\u53F7\u89D2",children:"#"}),"\u592A\u5FD9\u7684\u7EBF\u7A0B\u65E0\u6CD5\u53CA\u65F6\u542C\u5230\u64A4\u9000\u7684\u53F7\u89D2"]}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u679C\u7EBF\u7A0B\u963B\u585E\u5728\u4E00\u4E2A\u4E8B\u4EF6\u4E0A\uFF0C\u90A3\u4E48\u7ED9\u7EBF\u7A0B\u53D1\u9001\u5173\u95ED\u6D88\u606F\uFF0C\u7EBF\u7A0B\u4E5F\u65E0\u6CD5\u53CA\u65F6\u7684\u6536\u5230\uFF0C\u53EA\u80FD\u7B49\u5230\u4E8B\u4EF6\u51FA\u73B0\uFF0C\u7EBF\u7A0B\u9000\u51FA\u963B\u585E\u72B6\u6001\u7684\u65F6\u5019\u624D\u80FD\u63A5\u7740\u8FDB\u884C\u4E0B\u4E00\u6B65\u64CD\u4F5C\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5BF9\u4E8E\u8FD9\u79CD\u60C5\u51B5\uFF0C\u8D77\u521D\u4E5F\u6CA1\u6709\u597D\u7684\u65B9\u6CD5\uFF0C\u4E8E\u662F\u5C31\u5047\u60F3\u4E86\u4E00\u4E0B\uFF1A\u53EF\u4EE5\u5728\u901A\u77E5\u7EBF\u7A0B\u5173\u95ED\u7684\u65F6\u5019\uFF0C\u53D1\u9001\u4E00\u4E2A_\u5047_\u7684\u4E8B\u4EF6\uFF0C\u8BA9\u7EBF\u7A0B\u5F3A\u884C\u9000\u51FA\u963B\u585E\u72B6\u6001\u3002\u4F46\u662F\u8FD9\u79CD\u4F7F\u7528\u5047\u4E8B\u4EF6\u7684\u65B9\u5F0F\u5F88\u5BB9\u6613\u9020\u6210\u7CFB\u7EDF\u201C\u6DF7\u4E71\u201D\uFF0C\u4E0D\u662F\u4E00\u4E2A\u5F88\u597D\u7684\u65B9\u6CD5\u3002"}),"\n",(0,s.jsxs)(n.p,{children:["\u5982\u679C\u4E00\u4E2A\u7EBF\u7A0B\u963B\u585E\u5728Socket\u901A\u4FE1\u4E0A\uFF0C\u53EF\u4EE5\u5728\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u4E0A\u8C03\u7528\u8FD9\u4E2ASocket\u7684",(0,s.jsx)(n.code,{children:"close()"}),"\u65B9\u6CD5\uFF0C\u8FD9\u6837\u4F1A\u4F7F\u5176\u629B\u51FA",(0,s.jsx)(n.code,{children:"SocketException"}),"\u800C\u9000\u51FA\u3002\u5B98\u65B9\u6587\u6863\u6CA1\u6709\u63D0\u5230\u8FD9\u79CD\u65B9\u6CD5\uFF0C\u53EF\u4EE5\u7528\u6765\u505A\u4E2A\u53C2\u8003\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u4E00\u4E2A\u6BD4\u8F83\u597D\u7684\u601D\u8DEF\u5C31\u662F\uFF0C\u6539\u963B\u585E\u4E3A\u975E\u963B\u585E\uFF0C\u8FD9\u6837\u7EBF\u7A0B\u5C31\u6709\u8DB3\u591F\u7684\u673A\u4F1A\u6355\u83B7\u5230\u5173\u95ED\u6D88\u606F\u3002\u6BD4\u5982\u7528NIO\u5305\u4E2D\u7684Channel\u6765\u7BA1\u7406Socket\u3002"}),"\n",(0,s.jsxs)(n.p,{children:["\u4EE5ZMQ\u4E3A\u4F8B\uFF0C\u901A\u8FC7",(0,s.jsx)(n.code,{children:"ZMQ.Poller"}),"\u8F6E\u8BE2\u907F\u514D\u963B\u585E\u7684\u53D1\u751F\u3002\u4EE5\u4E0B\u4EE3\u7801\u662F\u5B98\u65B9\u7684\u793A\u4F8B\uFF1A"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",meta:"",children:'import org.zeromq.ZMQ;\n\npublic class MSPoller {\n\n    public static void main (String[] args) {\n        ZMQ.Context context = ZMQ.context(1);\n\n        // Connect to task ventilator\n        ZMQ.Socket receiver = context.socket(ZMQ.PULL);\n        receiver.connect("tcp://localhost:5557");\n\n        //  Connect to weather server\n        ZMQ.Socket subscriber = context.socket(ZMQ.SUB);\n        subscriber.connect("tcp://localhost:5556");\n        subscriber.subscribe("10001 ".getBytes());\n\n        //  Initialize poll set\n        ZMQ.Poller items = new ZMQ.Poller (2);\n        items.register(receiver, ZMQ.Poller.POLLIN);\n        items.register(subscriber, ZMQ.Poller.POLLIN);\n\n        //  Process messages from both sockets\n        while (!Thread.currentThread ().isInterrupted ()) {\n            byte[] message;\n            items.poll();\n            if (items.pollin(0)) {\n                message = receiver.recv(0);\n                System.out.println("Process task");\n            }\n            if (items.pollin(1)) {\n                message = subscriber.recv(0);\n                System.out.println("Process weather update");\n            }\n        }\n        receiver.close ();\n        context.term ();\n    }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u603B\u7684\u6765\u8BF4\uFF0C\u5C3D\u91CF\u901A\u77E5\u7EBF\u7A0B\u81EA\u5DF1\u53BB\u7ED3\u675F\u81EA\u5DF1\u7684\u4EFB\u52A1\uFF0C\u7531\u6B64\u53EF\u4EE5\u5C3D\u91CF\u907F\u514D\u4E00\u4E9B\u610F\u5916\u60C5\u51B5\u7684\u53D1\u751F\u3002"}),"\n",(0,s.jsxs)(n.h2,{id:"\u53C2\u8003\u5185\u5BB9",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u53C2\u8003\u5185\u5BB9",children:"#"}),"\u53C2\u8003\u5185\u5BB9"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"http://stackoverflow.com/questions/10961714/how-to-properly-stop-the-thread-in-java",target:"_blank",rel:"noopener noreferrer",children:"multithreading - How to properly stop the Thread in Java? - Stack Overflow"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"http://zguide.zeromq.org/java:mspoller",target:"_blank",rel:"noopener noreferrer",children:"Multiple socket poller in Java"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"http://stackoverflow.com/questions/2983835/how-can-i-interrupt-a-serversocket-accept-method",target:"_blank",rel:"noopener noreferrer",children:"How can I interrupt a ServerSocket accept() method?"})}),"\n"]})]})}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,t.useMDXComponents)(),e.components);return n?(0,s.jsx)(n,Object.assign({},e,{children:(0,s.jsx)(a,e)})):a(e)}n.default=c,c.__RSPRESS_PAGE_META={},c.__RSPRESS_PAGE_META["..%2Fsource%2F_posts%2F2017-04-28-how-to-properly-stop-a-thread-in-java.md"]={toc:[{id:"\u542B\u6709\u6B7B\u5FAA\u73AF\u7684\u7EBF\u7A0B\u662F\u65E0\u6CD5\u77E5\u9053\u81EA\u5DF1\u8BE5\u4EC0\u4E48\u65F6\u5019\u7ED3\u675F\u7684",text:"\u542B\u6709\u6B7B\u5FAA\u73AF\u7684\u7EBF\u7A0B\u662F\u65E0\u6CD5\u77E5\u9053\u81EA\u5DF1\u8BE5\u4EC0\u4E48\u65F6\u5019\u7ED3\u675F\u7684",depth:2},{id:"\u8FD9\u91CC\u6709\u4E24\u79CD\u65B9\u6CD5\u53EF\u4EE5\u8BA9\u5916\u90E8\u7EBF\u7A0B\u7ED3\u675F\u4E00\u4E2A\u7EBF\u7A0B",text:"\u8FD9\u91CC\u6709\u4E24\u79CD\u65B9\u6CD5\u53EF\u4EE5\u8BA9\u5916\u90E8\u7EBF\u7A0B\u7ED3\u675F\u4E00\u4E2A\u7EBF\u7A0B",depth:2},{id:"\u8BBE\u7F6E\u6807\u8BB0\u53D8\u91CF",text:"\u8BBE\u7F6E\u6807\u8BB0\u53D8\u91CF",depth:2},{id:"\u6355\u83B7\u7EBF\u7A0B\u4E2D\u65AD",text:"\u6355\u83B7\u7EBF\u7A0B\u4E2D\u65AD",depth:3},{id:"\u592A\u5FD9\u7684\u7EBF\u7A0B\u65E0\u6CD5\u53CA\u65F6\u542C\u5230\u64A4\u9000\u7684\u53F7\u89D2",text:"\u592A\u5FD9\u7684\u7EBF\u7A0B\u65E0\u6CD5\u53CA\u65F6\u542C\u5230\u64A4\u9000\u7684\u53F7\u89D2",depth:2},{id:"\u53C2\u8003\u5185\u5BB9",text:"\u53C2\u8003\u5185\u5BB9",depth:2}],title:"\u5982\u4F55\u5728Java\u4E2D\u6B63\u786E\u7684\u7EC8\u6B62\u4E00\u4E2A\u7EBF\u7A0B",frontmatter:{layout:"post",title:"\u5982\u4F55\u5728Java\u4E2D\u6B63\u786E\u7684\u7EC8\u6B62\u4E00\u4E2A\u7EBF\u7A0B",date:"2017-04-28 20:55:14",categories:["\u7F16\u7A0B\u8BED\u8A00"],tags:["java","thread","\u7EBF\u7A0B"]}}}}]);