/*! For license information please see 3012.27e6dfa0.js.LICENSE.txt */
(self.webpackChunk_sumyblog_rspress_blog=self.webpackChunk_sumyblog_rspress_blog||[]).push([["3012"],{12407:function(n,i,a){"use strict";a.r(i);var t=a("35250"),r=a("51325");function e(n){let i=Object.assign({h1:"h1",a:"a",blockquote:"blockquote",p:"p",pre:"pre",code:"code",strong:"strong",h2:"h2",ul:"ul",li:"li"},(0,r.useMDXComponents)(),n.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.h1,{id:"\u4E8C\u5206\u77E9\u9635\u5FEB\u901F\u5E42\u53CA\u5176\u5E94\u7528",children:[(0,t.jsx)(i.a,{className:"header-anchor","aria-hidden":"true",href:"#\u4E8C\u5206\u77E9\u9635\u5FEB\u901F\u5E42\u53CA\u5176\u5E94\u7528",children:"#"}),"\u4E8C\u5206\u77E9\u9635\u5FEB\u901F\u5E42\u53CA\u5176\u5E94\u7528"]}),"\n",(0,t.jsxs)(i.blockquote,{children:["\n",(0,t.jsx)(i.p,{children:"\u6709\u4E9B\u4E1C\u897F\u5F88\u6162\uFF0C\u7136\u540E\u5C31\u53D8\u5F97\u5F88\u5FEB\u4E86\u3002\u4E8C\u5206\u77E9\u9635\u5FEB\u901F\u5E42\u662F\u89E3\u51B3\u77E9\u9635\u5E42\u4E58\u7684\u4E00\u79CD\u65B9\u6CD5\uFF0C\u4E3B\u8981\u601D\u60F3\u662F\u91C7\u7528\u5206\u6CBB\u65B9\u6CD5\u3002"}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"\u5148\u6765\u4E00\u4E2A\u7B80\u5355\u7684\u6570\u7684\u5E42\u8FD0\u7B97\u3002"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-cpp",meta:"",children:"long long quickpow(long long m , long long n , long long k) {\n    long long ans = 1;\n    while(n) {\n        if(n&1) //\u5982\u679Cn\u662F\u5947\u6570\n            ans = (ans * m) % k;\n        n = n >> 1;//\u4F4D\u8FD0\u7B97\u201C\u53F3\u79FB1\u7C7B\u4F3C\u96641\u201D\n        m = (m * m) % k;\n    }\n    return ans;\n}\n"})}),"\n",(0,t.jsx)(i.p,{children:"\u5BF9\u4E8E\u77E9\u9635\u7684\u5E42\u8FD0\u7B97\uFF0C\u5148\u7ED9\u51FA\u4E00\u4E2A\u6A21\u677F\u3002"}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsxs)(i.strong,{children:["\u66F4\u65B0\u5185\u5BB9\uFF1A\u5728\u77E9\u9635\u52A0\u6CD5\u548C\u77E9\u9635\u4E58\u6CD5\u4E2D\uFF0C\u539F\u5148\u7684\u53D6\u4F59\u65B9\u5F0F",(0,t.jsx)(i.code,{children:"if(a.m[i][j]>=MOD)a.m[i][j]%=MOD;"}),"\u5B58\u5728\u8D1F\u6570BUG\u3002\u8FD8\u662F\u4F7F\u7528\u6734\u7D20\u7684\u53D6\u4F59\u65B9\u5F0F\u5427\u3002"]})}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-cpp",meta:"",children:'struct matrix\n{\n    #define M 105\n    #define MOD 100000\n    ll m[M][M],r,c;\n    void init(ll r1,ll c1)\n    {\n        r=r1,c=c1;\n        for(int i=0;i<r1;i++)for(int j=0;j<c1;j++)m[i][j]=0;\n    }\n    void prt()\n    {\n        for(int i=0;i<r;i++)\n        {\n            for(int j=0;j<c;j++)printf("%I64d ",m[i][j]);\n            puts("");\n        }\n        puts("");\n    }\n};\n//\u77E9\u9635\u52A0\u6CD5\nmatrix Plus(matrix a,matrix b)\n{\n    for(int i=0;i<a.r;i++)\n        for(int j=0;j<a.c;j++)\n        {\n            a.m[i][j]+=+b.m[i][j];\n            /*//IF MOD\n            //if(a.m[i][j]>=MOD)a.m[i][j]%=MOD;\n            a.m[i][j]=(a.m[i][j]%MOD+MOD)%MOD;*/\n        }\n    return a;\n}\n//\u77E9\u9635\u4E58\u6CD5 \u6761\u4EF6:a.c=b.r \u7ED3\u679C:c.r=a.r c.c=b.c\nmatrix mult(matrix a,matrix b)\n{\n    matrix ans;ans.init(a.r,b.c);\n    for(int i=0;i<a.r;i++)\n        for(int k=0;k<a.c;k++)if(a.m[i][k])\n            for(int j=0;j<b.c;j++)\n            {\n                ans.m[i][j]+=a.m[i][k]*b.m[k][j];\n                /*//IF MOD\n                //if(ans.m[i][j]>=MOD)ans.m[i][j]%=MOD;\n                ans.m[i][j]=(ans.m[i][j]%MOD+MOD)%MOD;*/\n            }\n    return ans;\n}\n//\u5FEB\u901F\u5E42\nmatrix pow(matrix a,ll n)\n{\n    matrix b,t=a;b.init(a.r,a.c);\n    //\u6784\u9020\u5355\u4F4D\u77E9\u9635\n    for(int i=0;i<b.c;i++)b.m[i][i]=1;\n    while(n>=1)\n    {\n        if(n&1)b=mult(b,t);\n        n>>=1;\n        t=mult(t,t);\n    }\n    return b;\n}\n'})}),"\n",(0,t.jsx)(i.p,{children:"\uFF08\u7ECF\u6D4B\u8BD5\uFF0C\u8FD0\u7B97\u7B26\u91CD\u8F7D\u7684\u6548\u7387\u6BD4\u4E0A\u8FB9\u7684\u6548\u7387\u4F4E\uFF09"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-cpp",meta:"",children:'#define MOD 10001\nstruct Mat {\n    int n,m;\n    int mat[5][5];\n    Mat() {\n        memset(mat,0,sizeof(mat));\n        n = m = 5;  //\u77E9\u9635\u7684\u5927\u5C0F\n    };\n};\nMat operator *(Mat a,Mat b) {\n    Mat c;\n    c = Mat();\n    c.n = a.n,c.m = b.m;\n    for(int i=1;i<=a.n;i++) {\n        for(int k=1;k<=a.m;k++) {\n            if(a.mat[i][k]!=0){  //\u8FD9\u91CC\u4F18\u5316\u4E00\u4E0B\uFF0C\u5BF9\u4E8E\u7A00\u758F\u77E9\u9635\u53EF\u4EE5\u8282\u7701\u4E00\u534A\u5DE6\u53F3\u7684\u65F6\u95F4\n                for(int j=1;j<=b.m;j++) {\n                    c.mat[i][j] += (a.mat[i][k]*b.mat[k][j])%MOD;\n                    c.mat[i][j] %= MOD;\n                }\n            }\n        }\n    }\n    return c;\n}\nMat operator +(Mat a,Mat b) {\n    Mat c;\n    c = Mat();\n    c.n = a.n,c.m = a.m;\n    for(int i=1;i<=a.n;i++) {\n        for(int j=1;j<=a.m;j++) {\n            c.mat[i][j] = a.mat[i][j]+b.mat[i][j];\n            c.mat[i][j] %= MOD;\n        }\n    }\n    return c;\n}\nMat operator ^(Mat a,long long k) {\n    Mat c;\n    int i,j;\n    c = Mat();\n    c.n = a.n,c.m = a.n;\n    for(i=1;i<=a.n;i++)c.mat[i][i] = 1;\n    while(k) {\n        if(k&1) {\n            c = c*a;\n        }\n        a = a*a;\n        k>>=1;\n    }\n    return c;\n}\nvoid out(Mat a) {\n    int i,j;\n    for(i=1;i<=a.n;i++) {\n        for(j=1;j<=a.m;j++) {\n            cout<<a.mat[i][j]<<" ";\n        }\n        cout<<endl;\n    }\n}\n'})}),"\n",(0,t.jsxs)(i.h2,{id:"\u53C2\u8003\u5185\u5BB9",children:[(0,t.jsx)(i.a,{className:"header-anchor","aria-hidden":"true",href:"#\u53C2\u8003\u5185\u5BB9",children:"#"}),"\u53C2\u8003\u5185\u5BB9"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.a,{href:"http://www.matrix67.com/blog/archives/276",target:"_blank",rel:"noopener noreferrer",children:"Matrix67: My Blog \xbb Blog Archive \xbb \u5341\u4E2A\u5229\u7528\u77E9\u9635\u4E58\u6CD5\u89E3\u51B3\u7684\u7ECF\u5178\u9898\u76EE"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.a,{href:"http://www.cppblog.com/baby-fly/archive/2009/08/18/93686.html",target:"_blank",rel:"noopener noreferrer",children:"\u77E9\u9635\u9898\u76EE zz - \u4E3A\u751F\u5B58\u800C\u5954\u8DD1"})}),"\n"]})]})}function c(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:i}=Object.assign({},(0,r.useMDXComponents)(),n.components);return i?(0,t.jsx)(i,Object.assign({},n,{children:(0,t.jsx)(e,n)})):e(n)}i.default=c,c.__RSPRESS_PAGE_META={},c.__RSPRESS_PAGE_META["..%2Fsource%2F_posts%2F2013-05-10-dichotomous-matrix-fast-power-and-its-application.md"]={toc:[{id:"\u53C2\u8003\u5185\u5BB9",text:"\u53C2\u8003\u5185\u5BB9",depth:2}],title:"\u4E8C\u5206\u77E9\u9635\u5FEB\u901F\u5E42\u53CA\u5176\u5E94\u7528",frontmatter:{layout:"post",title:"\u4E8C\u5206\u77E9\u9635\u5FEB\u901F\u5E42\u53CA\u5176\u5E94\u7528",date:"2013-05-10 00:00:00",categories:["\u7B97\u6CD5"],tags:["\u6570\u8BBA","\u77E9\u9635"]}}}}]);