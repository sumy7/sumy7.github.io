/*! For license information please see 744.4056ef8e.js.LICENSE.txt */
(self.webpackChunk_sumyblog_rspress_blog=self.webpackChunk_sumyblog_rspress_blog||[]).push([["744"],{5424:function(e,r,t){"use strict";t.r(r);var n=t("35250"),s=t("51325");function a(e){let r=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",ul:"ul",li:"li",code:"code",pre:"pre"},(0,s.useMDXComponents)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.h1,{id:"\u4F7F\u7528http_parser\u89E3\u6790url",children:[(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#\u4F7F\u7528http_parser\u89E3\u6790url",children:"#"}),"\u4F7F\u7528http_parser\u89E3\u6790URL"]}),"\n",(0,n.jsx)(r.p,{children:"\u89E3\u6790URL\u662F\u4E2A\u70E6\u5FC3\u4E8B\uFF0C\u5C24\u5176\u662F\u8FD8\u8981\u4F7F\u7528C\u8BED\u8A00\u6765\u89E3\u6790\u3002\u5199Java\u5199\u4E60\u60EF\u4E86\uFF0C\u597D\u591AC\u7684\u4E1C\u897F\u90FD\u4E0D\u592A\u4F1A\u7528\u4E86\u3002\u6700\u8FD1\u7684\u4E00\u6B21\u4F5C\u4E1A\u4E2D\u9700\u8981\u7528\u5230URL\u7684\u89E3\u6790\uFF0C\u67E5\u627E\u4E86\u4E00\u756A\u5C31\u627E\u5230\u4E86\u8FD9\u4E2A\u5F00\u6E90\u5E93\u3002"}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.a,{href:"https://github.com/nodejs/http-parser",target:"_blank",rel:"noopener noreferrer",children:"http-parser"}),"\u7531",(0,n.jsx)(r.a,{href:"https://github.com/nodejs",target:"_blank",rel:"noopener noreferrer",children:"nodejs"}),"\u9879\u76EE\u7EC4\u5F00\u6E90\uFF0C\u5177\u4F53\u7B80\u4ECB\u53EF\u4EE5\u53BB\u53C2\u8003\u4E3B\u9875README\u3002"]}),"\n",(0,n.jsxs)(r.h2,{id:"http-parser\u4F18\u70B9",children:[(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#http-parser\u4F18\u70B9",children:"#"}),"http-parser\u4F18\u70B9"]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"\u65E0\u4F9D\u8D56\u6027"}),"\n",(0,n.jsx)(r.li,{children:"\u53EF\u4EE5\u5904\u7406\u6301\u4E45\u6D88\u606F(keep-alive)"}),"\n",(0,n.jsx)(r.li,{children:"\u652F\u6301\u89E3\u7801chunk\u7F16\u7801\u7684\u6D88\u606F"}),"\n",(0,n.jsx)(r.li,{children:"\u652F\u6301Upgrade\u534F\u8BAE\u5347\u7EA7(\u5982\u65E0\u4F8B\u5916\u5C31\u662FWebSocket)"}),"\n",(0,n.jsx)(r.li,{children:"\u53EF\u4EE5\u9632\u5FA1\u7F13\u51B2\u533A\u6EA2\u51FA\u653B\u51FB"}),"\n"]}),"\n",(0,n.jsxs)(r.h2,{id:"\u89E3\u6790\u51FD\u6570\u539F\u578B",children:[(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#\u89E3\u6790\u51FD\u6570\u539F\u578B",children:"#"}),"\u89E3\u6790\u51FD\u6570\u539F\u578B"]}),"\n",(0,n.jsxs)(r.p,{children:["\u5E93\u7684\u4E3B\u8981\u529F\u80FD\u662F\u89E3\u6790HTTP\u5934\u7684\uFF0C\u800C\u89E3\u6790URL\u4F7F\u7528\u7684\u5219\u662F\u5E93\u4E2D\u7684\u4E00\u4E2A\u51FD\u6570\u65B9\u6CD5",(0,n.jsx)(r.code,{children:"http_parser_parse_url()"}),"\uFF1A"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-c",meta:"",children:"int http_parser_parse_url(const char *buf, size_t buflen,  \n                          int is_connect,  \n                          struct http_parser_url *u);  \n"})}),"\n",(0,n.jsx)(r.p,{children:"\u9700\u8981\u8BF4\u660E\u7684\u662Fis_connect\u53C2\u6570\uFF0C\u5F53\u4F201\u65F6\uFF0Chttp_parser_parse_url\u65B9\u6CD5\u5C06\u8FDB\u884C\u4E25\u683C\u68C0\u9A8C\uFF0C\u5982\u679CURL\u4E2D\u6CA1\u6709port\u3001schema\u5C06\u5BFC\u81F4http_parser_parse_url\u65B9\u6CD5\u5931\u8D25\uFF0C\u8FD4\u56DE\u975E0\u503C\u3002\u4E00\u822C\u7ED9is_connect\u65B9\u6CD5\u4F200\u5373\u53EF\u3002"}),"\n",(0,n.jsxs)(r.p,{children:["\u8C03\u7528\u51FD\u6570\u4E4B\u540E\u4F1A\u5C06\u89E3\u6790\u7684port\u3001host\u3001path\u3001schema\u4E4B\u7C7B\u7684\u7ED3\u679C\u5B58\u653E\u5230",(0,n.jsx)(r.code,{children:"http_parser_url"}),"\u7684\u7ED3\u6784\u4F53\u4E2D\uFF1A"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-c",meta:"",children:"struct http_parser_url {  \n  uint16_t field_set;           /* Bitmask of (1 << UF_*) values */  \n  uint16_t port;                /* Converted UF_PORT string */  \n  \n  struct {  \n    uint16_t off;               /* Offset into buffer in which field starts */  \n    uint16_t len;               /* Length of run in buffer */  \n  } field_data[UF_MAX];  \n};  \n"})}),"\n",(0,n.jsx)(r.p,{children:"\u7ED3\u6784\u4F53\u672A\u8FDB\u884C\u4EFB\u4F55\u7684\u5185\u5B58\u62F7\u8D1D\uFF0C\u53EA\u8BB0\u5F55\u4E86\u4F4D\u7F6E\u3001\u957F\u5EA6\u4FE1\u606F\u7B49\uFF0C\u6548\u7387\u4E0A\u8FD8\u662F\u5F88\u4E0D\u9519\u7684\u3002\u76EE\u524D\u652F\u6301SCHEMA\u3001PORT\u3001HOST\u3001PATH\u3001QUERY\u3001USERINFO\u3001FRAGMENT\u4E03\u79CD\u4FE1\u606F\u7684\u63D0\u53D6\u3002"}),"\n",(0,n.jsxs)(r.h2,{id:"\u793A\u4F8B\u4EE3\u7801",children:[(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#\u793A\u4F8B\u4EE3\u7801",children:"#"}),"\u793A\u4F8B\u4EE3\u7801"]}),"\n",(0,n.jsx)(r.p,{children:"\u88AB\u89E3\u6790\u7684URL\u81F3\u5C11\u9700\u8981\u5305\u542BUF_SCHEMA\u548CUF_HOST\uFF0C\u5426\u5219\u5728\u89E3\u6790\u7684\u65F6\u5019\u4F1A\u53D1\u751F\u9519\u8BEF\u3002"}),"\n",(0,n.jsx)(r.p,{children:"\u4F7F\u7528\u7684\u662F\u535A\u5BA2\u4E2D\u7684\u793A\u4F8B\u4EE3\u7801\uFF1A"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-c",meta:"",children:"static int parse_url(struct http_client * httpc, const char *url)  \n{  \n    struct http_parser_url u;  \n    if(0 == http_parser_parse_url(url, strlen(url), 0, &u))  \n    {  \n        if(u.field_set & (1 << UF_PORT))  \n        {  \n            httpc->port = u.port;  \n        }  \n        else  \n        {  \n            httpc->port = 80;  \n        }  \n\n        if(httpc->host) free(httpc->host);  \n        if(u.field_set & (1 << UF_HOST) )  \n        {  \n            httpc->host = (char*)malloc(u.field_data[UF_HOST].len + 1);  \n            strncpy(httpc->host, url + u.field_data[UF_HOST].off, u.field_data[UF_HOST].len);  \n            httpc->host[u.field_data[UF_HOST].len] = 0;  \n        }  \n  \n        if(httpc->path) free(httpc->path);  \n        if(u.field_set & (1 << UF_PATH))  \n        {  \n            httpc->path = (char*)malloc(u.field_data[UF_PATH].len + 1);  \n            strncpy(httpc->path, url+u.field_data[UF_PATH].off, u.field_data[UF_PATH].len);  \n            httpc->path[u.field_data[UF_PATH].len] = 0;  \n        }  \n\n        return 0;  \n    }  \n  \n    return -1;  \n}  \n"})}),"\n",(0,n.jsx)(r.p,{children:"\u8FD9\u91CC\u4ECE\u5934\u6587\u4EF6\u4E2D\u6458\u51FA\u4E86URL\u53C2\u6570\u7684\u5B9A\u4E49\uFF0C\u53EF\u4EE5\u5728\u4EE3\u7801\u4E2D\u83B7\u53D6\u5230\u76F8\u5E94\u7684\u90E8\u5206\uFF1A"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-c",meta:"",children:"enum http_parser_url_fields\n  { UF_SCHEMA           = 0  //\u6A21\u5F0F\uFF0C\u534F\u8BAE\n  , UF_HOST             = 1  //\u4E3B\u673A\u540D\n  , UF_PORT             = 2  //\u7AEF\u53E3\n  , UF_PATH             = 3  //\u8DEF\u5F84\n  , UF_QUERY            = 4  //\u53C2\u6570   - ?\u5F00\u59CB\u7684\u90E8\u5206\n  , UF_FRAGMENT         = 5  //\u951A\u6807\u5FD7 - #\u5F00\u59CB\u7684\u90E8\u5206\n  , UF_USERINFO         = 6  //\u7528\u6237\u540D - @\u4E4B\u524D\u7684\u90E8\u5206\n  , UF_MAX              = 7\n  };\n"})}),"\n",(0,n.jsxs)(r.h2,{id:"\u53C2\u8003\u5185\u5BB9",children:[(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#\u53C2\u8003\u5185\u5BB9",children:"#"}),"\u53C2\u8003\u5185\u5BB9"]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.a,{href:"http://blog.csdn.net/foruok/article/details/8954726",target:"_blank",rel:"noopener noreferrer",children:"\u4F7F\u7528http_parser\u89E3\u6790URL"})}),"\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.a,{href:"http://blog.rootk.com/post/tutorial-for-http-parser.html",target:"_blank",rel:"noopener noreferrer",children:"http-parser\u4F7F\u7528\u7B80\u4ECB"})}),"\n"]})]})}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:r}=Object.assign({},(0,s.useMDXComponents)(),e.components);return r?(0,n.jsx)(r,Object.assign({},e,{children:(0,n.jsx)(a,e)})):a(e)}r.default=h,h.__RSPRESS_PAGE_META={},h.__RSPRESS_PAGE_META["..%2Fsource%2F_posts%2F2015-11-24-use-http-parser-to-parse-url.md"]={toc:[{id:"http-parser\u4F18\u70B9",text:"http-parser\u4F18\u70B9",depth:2},{id:"\u89E3\u6790\u51FD\u6570\u539F\u578B",text:"\u89E3\u6790\u51FD\u6570\u539F\u578B",depth:2},{id:"\u793A\u4F8B\u4EE3\u7801",text:"\u793A\u4F8B\u4EE3\u7801",depth:2},{id:"\u53C2\u8003\u5185\u5BB9",text:"\u53C2\u8003\u5185\u5BB9",depth:2}],title:"\u4F7F\u7528http_parser\u89E3\u6790URL",frontmatter:{layout:"post",title:"\u4F7F\u7528http_parser\u89E3\u6790URL",date:"2015-11-24 23:18:46",categories:["\u7F16\u7A0B\u8BED\u8A00"],tags:["url","\u5E93","c/c++"]}}}}]);