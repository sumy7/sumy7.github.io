/*! For license information please see 7940.3a8d0b1d.js.LICENSE.txt */
(self.webpackChunk_sumyblog_rspress_blog=self.webpackChunk_sumyblog_rspress_blog||[]).push([["7940"],{40342:function(e,n,r){"use strict";r.r(n);var t=r("35250"),p=r("51325");function o(e){let n=Object.assign({h1:"h1",a:"a",h2:"h2",p:"p",pre:"pre",code:"code",ul:"ul",li:"li"},(0,p.useMDXComponents)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.h1,{id:"\u4F7F\u7528phpproc_open\u6267\u884C\u547D\u4EE4\u5E76\u83B7\u53D6\u8F93\u51FA",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u4F7F\u7528phpproc_open\u6267\u884C\u547D\u4EE4\u5E76\u83B7\u53D6\u8F93\u51FA",children:"#"}),"\u4F7F\u7528PHP:proc_open()\u6267\u884C\u547D\u4EE4\u5E76\u83B7\u53D6\u8F93\u51FA"]}),"\n",(0,t.jsxs)(n.h2,{id:"\u51FD\u6570\u539F\u578B",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u51FD\u6570\u539F\u578B",children:"#"}),"\u51FD\u6570\u539F\u578B"]}),"\n",(0,t.jsx)(n.p,{children:"(PHP 4 >= 4.3.0, PHP 5, PHP 7)\nproc_open \u2014 \u6267\u884C\u4E00\u4E2A\u547D\u4EE4\uFF0C\u5E76\u4E14\u6253\u5F00\u7528\u6765\u8F93\u5165/\u8F93\u51FA\u7684\u6587\u4EF6\u6307\u9488\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",meta:"",children:"resource proc_open ( string $cmd , array $descriptorspec , array &$pipes \n                    [, string $cwd [, array $env [, array $other_options ]]] )\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u5177\u4F53\u4ECB\u7ECD\u53EF\u4EE5\u53C2\u8003",(0,t.jsx)(n.a,{href:"http://php.net/manual/zh/function.proc-open.php",target:"_blank",rel:"noopener noreferrer",children:"php.net\u4E0A\u7684\u6587\u6863"}),"\u3002"]}),"\n",(0,t.jsxs)(n.h2,{id:"\u5E94\u7528",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u5E94\u7528",children:"#"}),"\u5E94\u7528"]}),"\n",(0,t.jsx)(n.p,{children:"\u53C2\u8003php.net\u4E0A\u9762\u7684\u4F8B\u7A0B\uFF0C\u4FEE\u6539\u4E86\u4E00\u4E0B\u5199\u6210\u4E00\u4E2A\u5C0F\u7684php\u7A0B\u5E8F\uFF0C\u7528\u6765\u6D4B\u8BD5php\u6267\u884C\u547D\u4EE4\u7684\u60C5\u51B5\uFF0C\u4E5F\u53EF\u4EE5\u7528\u6765\u6D4B\u8BD5\u670D\u52A1\u5668\u4E0Aphp\u7684\u73AF\u5883\u53D8\u91CF\u95EE\u9898\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",meta:"",children:'<?php\n/**\n * Test executing command from php.\n * reference: http://php.net/manual/zh/function.proc-open.php\n * User: Sumy\n * Date: 2015/11/28 0028\n * Time: 19:57\n */\n\n$descriptorspec = array(\n    0 => array("pipe", "r"),  // stdin is a pipe that the child will read from\n    1 => array("pipe", "w"),  // stdout is a pipe that the child will write to\n//  2 => array("file", "/tmp/error-output.txt", "a") // stderr is a file to write to\n    2 => array("pipe", "w")  // stderr is a pipe that the child will write to\n);\n\n$command = isset($_GET["command"]) ? $_GET["command"] : "java -version";\n$stdin = isset($_GET["stdin"]) ? $_GET["stdin"] : "";\n$cwd = \'/tmp\';\n// $env = array(\'some_option\' => \'aeiou\');\n\n$process = proc_open($command, $descriptorspec, $pipes, $cwd, null);\n\necho "\n<form method=\'get\' action=\'commandtest.php\'>\n<h1>command</h1>\n<input type=\'text\' name=\'command\' value=\'$command\'>\n<h1>stdin</h1>\n<input type=\'text\' name=\'stdin\' value=\'$stdin\'>\n<input type=\'submit\' value=\'run it!\'>\n</form>\n";\n\nif (is_resource($process)) {\n    // $pipes now looks like this:\n    // 0 => writeable handle connected to child stdin\n    // 1 => readable handle connected to child stdout\n    // Any error output will be appended to /tmp/error-output.txt\n\n    fwrite($pipes[0], $stdin);\n    fclose($pipes[0]);\n\n    echo "<h1>stdout</h1>";\n    echo "<pre>";\n    echo stream_get_contents($pipes[1]);\n    fclose($pipes[1]);\n    echo "</pre>";\n\n    echo "<h1>stderr</h1>";\n    echo "<pre>";\n    echo stream_get_contents($pipes[2]);\n    fclose($pipes[2]);\n    echo "</pre>";\n\n    // It is important that you close any pipes before calling\n    // proc_close in order to avoid a deadlock\n    $return_value = proc_close($process);\n\n    echo "<h1>command return</h1>";\n    echo "<pre>";\n    echo "$return_value";\n    echo "</pre>";\n}\n'})}),"\n",(0,t.jsxs)(n.h2,{id:"\u53C2\u8003\u5185\u5BB9",children:[(0,t.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u53C2\u8003\u5185\u5BB9",children:"#"}),"\u53C2\u8003\u5185\u5BB9"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"http://php.net/manual/zh/function.proc-open.php",target:"_blank",rel:"noopener noreferrer",children:"PHP: proc_open - Manual"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"http://stackoverflow.com/questions/3261994/executing-jar-file-from-php-through-cmd-prompt-and-capturing-output",target:"_blank",rel:"noopener noreferrer",children:"Executing .jar file from PHP through cmd prompt and capturing output"})}),"\n"]})]})}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,p.useMDXComponents)(),e.components);return n?(0,t.jsx)(n,Object.assign({},e,{children:(0,t.jsx)(o,e)})):o(e)}n.default=s,s.__RSPRESS_PAGE_META={},s.__RSPRESS_PAGE_META["..%2Fsource%2F_posts%2F2015-11-28-executing-command-from-php-and-capturing-output.md"]={toc:[{id:"\u51FD\u6570\u539F\u578B",text:"\u51FD\u6570\u539F\u578B",depth:2},{id:"\u5E94\u7528",text:"\u5E94\u7528",depth:2},{id:"\u53C2\u8003\u5185\u5BB9",text:"\u53C2\u8003\u5185\u5BB9",depth:2}],title:"\u4F7F\u7528PHP:proc_open()\u6267\u884C\u547D\u4EE4\u5E76\u83B7\u53D6\u8F93\u51FA",frontmatter:{layout:"post",title:"\u4F7F\u7528PHP:proc_open()\u6267\u884C\u547D\u4EE4\u5E76\u83B7\u53D6\u8F93\u51FA",date:"2015-11-28 19:48:15",categories:["\u7F16\u7A0B\u8BED\u8A00"],tags:["php","shell"]}}}}]);